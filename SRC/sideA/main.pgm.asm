WorldMap: ;($6800)
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF, $08, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
    .byte $FF, $FF, $FF, $2C, $2B, $27, $15, $15, $16, $14, $13, $04, $FF, $06, $08, $0A, $1A, $29, $29, $28, $2E, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF
    .byte $FF, $0E, $FF, $01, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $03, $1F, $23, $25, $24, $26, $20, $1E, $1F, $21, $21, $07, $22, $1D, $1B, $21, $20, $04, $FF
    .byte $FF, $10, $FF, $0E, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $06, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $02, $FF
    .byte $FF, $10, $FF, $0B, $FF, $FF, $08, $0A, $1A, $29, $28, $04, $FF, $06, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $0A, $1A, $29, $29, $28, $04, $FF
    .byte $FF, $10, $FF, $0B, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $06, $FF, $FF, $FF, $FF, $08, $FF, $FF, $FF, $08, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF
    .byte $FF, $10, $FF, $0F, $11, $13, $14, $14, $13, $12, $0D, $03, $00, $05, $0C, $0E, $0E, $0D, $10, $0C, $0F, $0D, $10, $0C, $0E, $1B, $0F, $0E, $0F, $0D, $04, $FF
    .byte $FF, $10, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $0C, $06, $FF, $06, $FF, $FF, $FF, $FF, $11, $FF, $FF, $FF, $06, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF
    .byte $FF, $10, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $0C, $06, $FF, $06, $FF, $FF, $FF, $FF, $11, $0A, $1A, $28, $04, $FF, $06, $FF, $FF, $FF, $FF, $FF, $06, $FF
    .byte $FF, $10, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $0C, $06, $FF, $06, $FF, $FF, $FF, $FF, $08, $FF, $FF, $FF, $08, $FF, $08, $1B, $06, $19, $19, $2A, $0B, $FF
    .byte $FF, $0F, $04, $03, $02, $05, $06, $07, $08, $09, $0A, $06, $FF, $03, $12, $14, $15, $14, $07, $16, $15, $13, $0B, $FF, $0C, $07, $19, $19, $19, $2A, $0E, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $08, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $01, $FF, $0A, $1B, $04, $0F, $06, $2A, $0E, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $06, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $02, $FF, $06, $FF, $FF, $FF, $FF, $FF, $09, $FF
    .byte $FF, $08, $17, $09, $14, $13, $18, $12, $14, $19, $13, $04, $FF, $08, $1D, $1F, $06, $1F, $19, $1E, $1E, $1C, $03, $28, $29, $29, $29, $2B, $29, $2A, $0E, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $FF, $FF, $FF, $08, $FF, $08, $1D, $1F, $1E, $19, $07, $19, $19, $2C, $06, $06, $2B, $2B, $1A, $1A, $1A, $2A, $0B, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $0B, $FF, $FF, $0B, $FF, $06, $07, $04, $0F, $10, $0B, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $09, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $06, $FF, $07, $17, $18, $0C, $FF, $08, $21, $25, $25, $22, $03, $21, $25, $20, $00, $27, $2C, $2C, $06, $04, $0F, $10, $0E, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $03, $1C, $07, $17, $18, $0C, $FF, $0A, $21, $23, $25, $22, $03, $21, $24, $24, $24, $23, $23, $06, $24, $25, $22, $11, $2D, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $08, $01, $07, $17, $18, $0C, $FF, $09, $FF, $FF, $FF, $06, $06, $FF, $FF, $FF, $FF, $FF, $FF, $07, $26, $25, $22, $0B, $2D, $FF
    .byte $FF, $0B, $FF, $FF, $FF, $FF, $FF, $02, $0B, $FF, $FF, $08, $FF, $0A, $12, $14, $13, $03, $12, $15, $13, $0D, $12, $14, $06, $14, $18, $15, $19, $07, $09, $FF
    .byte $FF, $09, $17, $1C, $10, $19, $18, $03, $13, $10, $18, $0C, $FF, $06, $FF, $FF, $FF, $09, $04, $0F, $10, $0B, $FF, $FF, $08, $12, $16, $16, $16, $13, $0E, $FF
    .byte $FF, $0A, $17, $1C, $1C, $1C, $18, $03, $13, $19, $12, $0B, $FF, $00, $FF, $FF, $0B, $08, $12, $19, $19, $07, $FF, $FF, $08, $05, $FF, $FF, $FF, $FF, $06, $FF
    .byte $FF, $05, $FF, $FF, $0B, $FF, $FF, $08, $FF, $FF, $FF, $FF, $0B, $FF, $FF, $FF, $FF, $06, $FF, $FF, $FF, $FF, $FF, $05, $06, $01, $FF, $FF, $FF, $FF, $0B, $FF
    .byte $FF, $05, $FF, $FF, $07, $17, $18, $04, $13, $14, $14, $16, $0C, $FF, $05, $FF, $FF, $05, $0F, $18, $17, $18, $19, $29, $05, $02, $FF, $FF, $FF, $FF, $05, $FF
    .byte $FF, $05, $FF, $FF, $08, $FF, $FF, $05, $FF, $0B, $10, $18, $0D, $FF, $0A, $20, $22, $0D, $25, $26, $26, $26, $1D, $0E, $0E, $03, $23, $24, $24, $15, $07, $FF
    .byte $FF, $05, $FF, $FF, $23, $17, $18, $06, $22, $0C, $FF, $0B, $0E, $FF, $0B, $FF, $FF, $04, $FF, $FF, $FF, $FF, $05, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF
    .byte $FF, $23, $22, $1A, $13, $10, $14, $1C, $16, $06, $21, $0C, $0E, $FF, $0A, $1C, $1D, $03, $20, $21, $21, $22, $06, $23, $0F, $28, $27, $27, $27, $19, $07, $FF
    .byte $FF, $0B, $FF, $1E, $1F, $20, $20, $20, $0F, $15, $21, $24, $0E, $FF, $04, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $04, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $08, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $1D, $1B, $17, $18, $0C, $FF, $04, $11, $10, $12, $13, $14, $14, $15, $03, $1C, $1E, $1E, $1F, $1F, $1F, $1D, $07, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $0B, $FF, $0C, $16, $18, $17, $18, $17, $0F, $17, $17, $1A, $1A, $17, $1B, $1B, $17, $19, $09, $FF
    .byte $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF

CommonJump_00: ;($6C00)
    jmp LA2FD
CommonJump_01: ;($6C03)
    jmp LA325
CommonJump_02: ;($6C06)
    jmp LA303
CommonJump_6C09: ;($6C09)
    jmp LA73F
CommonJump_6C0C: ;($6C0C)
    jmp L840B
CommonJump_6C0F: ;($6C0F)
    jmp LA57A
CommonJump_6C12: ;($6C12)
    jmp LA72B
CommonJump_6C15: ;($6C15)
    jmp LA747
CommonJump_6C18: ;($6C18)
    jmp LAAA6
CommonJump_6C1B: ;($6C1B)
    jmp LAA75
CommonJump_6C1E: ;($6C1E)
    jmp LAAB7
CommonJump_6C21: ;($6C21)
    jmp LA75D
CommonJump_ChooseRoutine: ;($6C24)
    jmp MAIN_ChooseRoutine
CommonJump_6C27: ;($6C27)
    jmp LAC7C
CommonJump_6C2A: ;($6C2A)
    jmp L8EC4
CommonJump_6C2D: ;($6C2D)
    jmp LAEF4
CommonJump_6C30: ;($6C30)
    jmp LAFC8
CommonJump_6C33: ;($6C33)
    jmp LA90B
CommonJump_6C36: ;($6C36)
    jmp LAFEF
CommonJump_6C39: ;($6C39)
    jmp LB045
CommonJump_6C3C: ;($6C3C)
    jmp L8107
CommonJump_6C3F: ;($6C3F)
    jmp L9E4F
CommonJump_SubtractHealth: ;($6C42)
    jmp SubtractHealth
CommonJump_Base10Subtract: ;($6C45)
    jmp MAIN_Base10Subtract

CrawlerMovementRoutinesTable: ;($6C48)
    .word EnemyMoveOnePixelRight-1
    .word EnemyMoveOnePixelLeft-1
    .word EnemyMoveOnePixelDown-1
    .word EnemyMoveOnePixelDown-1
    .word EnemyMoveOnePixelLeft-1
    .word EnemyMoveOnePixelRight-1
    .word EnemyMoveOnePixelUp-1
    .word EnemyMoveOnePixelUp-1



MoreInit: ;($6C58)
    ldy #$01
    sty $1C
    ldx #$FF
    stx $6F
    inx
    stx CurSamusStat.byteC
    stx $50
    stx $52
    txa
    L6C69:
        cpx #$6A
        bcs L6C6F
            sta $75,x
        L6C6F:
        cpx #$FF
        bcs L6C76
            sta ObjAction,x
        L6C76:
        inx
        bne L6C69
    jsr METHEX_ScreenOff
    jsr MAIN_ClearNameTables
    jsr MAIN_EraseAllSprites
    jsr DestroyEnemies
    stx $66
    stx $67
    inx
    stx $2A
    inx
    stx $43
    lda $B5CF
    sta $4A
    lda $B5D0
    sta $49
    lda $B5D2
    sta $70
    lda #$FF
    sta $54
    jsr CopyAreaPointers
    jsr L8A8B
    L6CA8:
        jsr L8D80
        ldy $54
        iny
        bne L6CA8
    ldy $34
    sty $01
    ldy $33
    sty $00
    lda $FF
    and #$FB
    sta $FF
    sta PPUCTRL
    ldy PPUSTATUS
    ldy #$20
    sty PPUADDR
    ldy #$00
    sty PPUADDR
    ldx #$04
    L6CD0:
            lda ($00),y
            sta PPUDATA
            iny
            bne L6CD0
        inc $01
        dex
        bne L6CD0
    stx $8C
    inx
    stx $1C
    stx $2A
    inc $1E
    jmp METHEX_ScreenOn



CopyAreaPointers: ;($6CE9)
    ldx #$0D
    L6CEB:
        lda $B592,x
        sta $35,x
        dex
        bpl L6CEB
    rts



DestroyEnemies: ;($6CF4)
    lda #$00
    tax
    L6CF7:
        cpx #$4D
        bcs L6CFD
            sta $92,x
        L6CFD:
        sta $B460,x
        pha
        pla
        inx
        bne L6CF7
    stx $8D
    jmp $B5A3



SamusInit: ;($6D0A)
    lda #$08
    sta $1E
    lda #$2C
    sta $26
    jsr L6FB1
    ldy #$14
    sty ObjAction
    ldx #$00
    stx $6A
    dex
    stx $0728
    stx $0730
    stx $0732
    stx $0738
    stx EndTimer
    stx EndTimer+1
    stx $86
    stx $89
    ldy #$27
    lda $6E
    and #$0F
    beq L6D41
        lsr $43
        ldy #$2F
    L6D41:
    sty $73
    sty $8E
    sty $8F
    lda $B5D1
    sta ObjY
    lda #$80
    sta ObjX
    lda $FF
    and #$01
    sta ObjHi
    lda #$00
    sta Health
    lda #$03
    sta Health+1
RTS_6D63:
    rts



GameEngine: ;($6D64)
    ldx FrameCount
    bne L6D84
    jsr L6DBE
    lda CurSamusStat.SamusAge
    cmp #$C2
    bne L6D84
        lda CurSamusStat.SamusAge+1
        sbc #$01
        bne L6D84
            sta CurSamusStat.SamusAge
            sta CurSamusStat.SamusAge+1
            ldx #$02
            jsr L6DBE
    L6D84:
    jsr ScrollDoor
    jsr ScrollDoor
    jsr UpdateWorld
    lda $0108
    ora $0109
    beq L6DA4
        lda #$00
        sta $0108
        sta $0109
        lda #$18
        ldx #$03
        jsr SetTimer
    L6DA4:
    lda ObjAction
    cmp #$08
    bne RTS_6D63
    jsr L6F4E
    lda $98
    cmp #$0A
    beq L6DBB
        lda #$0C
        ldx #$04
        jmp SetTimer
    L6DBB:
    inc $1E
    rts

L6DBE:
    inc CurSamusStat.SamusAge,x
    bne RTS_6DC6
        inc CurSamusStat.SamusAge+1,x
    RTS_6DC6:
    rts



PrepareGameOver: ;($6DC7)
    jsr L6E00
    ldy #$0F
    L6DCC:
        lda L6DF0,y
        sta $0201,x
        dey
        lda L6DF0,y
        sta $0203,x
        lda #$01
        sta $0202,x
        lda #$73
        sta $0200,x
        jsr L84FE
        dey
        bpl L6DCC
    lda #$0C
    ldx #$06
    jmp SetTimer

L6DF0:
    .byte $58
    .stringmap charmap_gameover, "G"
    .byte $60
    .stringmap charmap_gameover, "A"
    .byte $68
    .stringmap charmap_gameover, "M"
    .byte $70
    .stringmap charmap_gameover, "E"
    .byte $88
    .stringmap charmap_gameover, "O"
    .byte $90
    .stringmap charmap_gameover, "V"
    .byte $98
    .stringmap charmap_gameover, "E"
    .byte $A0
    .stringmap charmap_gameover, "R"



L6E00:
    jsr ClearScreenData
    lda $FF
    and #$FC
    sta $FF
    ldx #$01
    stx PalDataPending
    dex
    stx $FD
    stx $FC
    jmp METHEX_ScreenOn



PauseMode: ;($6E15)
    lda Joy2Status
    and #BUTTON_A | BUTTON_UP.b
    eor #BUTTON_A | BUTTON_UP.b
    bne RTS_6E2D
    lda $98
    cmp #$03
    bcs RTS_6E2D
    ldy EndTimer+1
    iny
    bne RTS_6E2D
    sta GamePaused
    inc MainRoutine
RTS_6E2D:
    rts



PrepareContinueScreen: ;($6E2E)
    ldy $6F
    bpl L6E64
        inc $6F
        iny
        sty $55
        sty $45
        sty $65
        sty ObjHi
        jsr L6E00
        jsr L6F4E
        lda #$5A
        sta ObjAnimFrame
        ldx #$02
        L6E4B:
            lda L6E93,x
            sta ObjY
            lda L6E96,x
            sta ObjX
            inc ObjAnimFrame
            txa
            pha
            jsr L81C6
            pla
            tax
            dex
            bpl L6E4B
    L6E64:
    lda $12
    ora $16
    asl a
    asl a
    asl a
    tay
    bcc L6E7C
        lda $6F
        eor #$01
        sta $6F
        lda $0200
        eor #$28
        sta $0200
    L6E7C:
    tya
    bpl RTS_6E92
    inc CurSamusStat.GameOverCount
    bne L6E87
        inc CurSamusStat.GameOverCount+1
    L6E87:
    lsr $6F
    bcs L6E90
    lda #$01
    sta $1E
    rts
L6E90:
    inc $1E
RTS_6E92:
    rts

L6E93:
    .byte $64, $8C, $5C
L6E96:
    .byte $78, $78, $5C



PrepareSwitchDiskSide: ;($6E99)
    lda #$18
    sta PalDataPending
    jsr LB261
    jmp LC3F4



SamusIntro: ;($6EA3)
    jsr MAIN_EraseAllSprites
    ldy ObjAction
    lda $26
    bne L6EBE
        sta $74
        lda #$FF
        sta ObjAction
        jsr L7CAA
        jsr SelectSamusPal
        lda #$03
        sta $1E
    L6EBE:
    cmp #$1F
    bcs RTS_6E92
    cmp $6ECB,y
    bne L6ECC
        inc ObjAction
        sty $1C
    L6ECC:
    lda FrameCount
    lsr a
    bcc RTS_6E92
    lda #$04
    jsr SetSamusAnim
    lda #$00
    sta $55
    sta $45
    jmp L81C3

L6EDF:
    .byte $1E, $14, $0B, $04, $FF



ClearScreenData: ;($6EE4)
    jsr METHEX_ScreenOff
    lda #$FF
    sta $00
    jsr ClearNameTable
    jmp MAIN_EraseAllSprites



UpdateWorld: ;($6EF1)
    ldx #$00
    stx SpritePagePos
    jsr LA232
    jsr L7840
    jsr L6FC1
    jsr $B5BB
    jsr L7B30
    jsr L7D52
    jsr LA98A
    jsr LAB52
    jsr LA828
    jsr LAACA
    jsr L9B65
    jsr L9BCB
    jsr L9D8E
    jsr L9F21
    jsr L8438
    jsr LA9DF
    jsr L7E8D
    jsr L7EAD
    jsr LACD0
    ldx SpritePagePos
L6F30:
    lda #$F4
    @loop:
        sta SpriteRAM,x
        jsr L84FE
        bne @loop
    rts



MAIN_EraseAllSprites: ;($6F3B)
    ldx #$00
    beq L6F30 ; branch always



SelectSamusPal: ;($6F3F)
    lda CurSamusStat.SamusGear
    asl a
    asl a
    asl a
    lda MissileToggle
    rol a
    adc #$02
    sta PalDataPending
    rts



L6F4E:
    lda #$01
    bne L6F60

PauseMusic: ;($6F52)
    lda #$02
    bne L6F60

SFX_SamusWalk: ;($6F56)
    lda #$08
    bne L6F60

L6F5A:
    lda #$10
    bne L6F60
L6F5E:
    lda #$20
L6F60:
    ldx #$00
    beq L6FA6
L6F64:
    lda #$08
    bne L6F82
L6F68:
    lda #$01
    bne L6F82
L6F6C:
    lda #$02
    bne L6F82
L6F70:
    lda #$04
    bne L6F82
L6F74:
    lda #$10
    bne L6F82
L6F78:
    lda #$20
    bne L6F82
L6F7C:
    lda #$40
    bne L6F82
L6F80:
    lda #$80
L6F82:
    ldx #$01
    bne L6FA6
L6F86:
    lda #$01
    bne L6FA4
L6F8A:
    lda #$02
    bne L6FA4
L6F8E:
    lda #$04
    bne L6FA4
L6F92:
    lda #$08
    bne L6FA4
L6F96:
    lda #$10
    bne L6FA4
L6F9A:
    lda #$20
    bne L6FA4
L6F9E:
    lda #$40
    bne L6FA4
L6FA2:
    lda #$80
L6FA4:
    ldx #$02
L6FA6:
    ora $0680,x
    sta $0680,x
    rts
L6FAD:
    lda #$40
    bne L6FB3
L6FB1:
    lda #$80
L6FB3:
    ldx #$04
    bne L6FA6
L6FB7:
    lda #$02
    bne L6FBD
L6FBB:
    lda #$40
L6FBD:
    ldx #$05
    bne L6FA6
L6FC1:
    ldx #$00
    stx $45
    inx
    stx $4F
    jsr L6FCE
        dec $4F
        rts
    L6FCE:
    lda ObjAction
    bmi L6FEA
    jsr MAIN_ChooseRoutine
        .word L6FEA
        .word L7076
        .word L73B8
        .word L7497
        .word SamusPntUp
        .word L772D
        .word L73B8
        .word L779F
        .word RTS_D07F
        .word L77A4

L6FEA:
    lda $15
    and #$CF
    beq L6FF5
    jsr SetSamusStand@NoFootstep
    lda $15
L6FF5:
    and #$07
    bne L6FFF
    lda $13
    and #$08
    beq L700F
L6FFF:
    jsr BitScan
    cmp #$02
    bcs L7008
    sta $47
L7008:
    tax
    lda $703B,x
    sta ObjAction
L700F:
    lda $13
    ora $17
    asl a
    bpl L7019
    jsr L75A4
L7019:
    bit $13
    bpl L7022
    lda #$02
    sta ObjAction
L7022:
    lda #$04
    jsr L7121
    lda ObjAction
    cmp #$05
    bcs RTS_704B
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word L704C
        .word L7377
        .word L746B
        .word SetSamusPntUp
    
    .byte $01, $01, $03, $04
    
L703F:
    lda #$50
    sta SamusJumpDsplcmnt
    lda #$32
    jsr SetSamusAnim
    sta $5F
RTS_704B:
    rts



L704C:
    lda #$09
    sta $4D
    ldx #$00
    lda ObjAnimResetIndex
    cmp #$07
    beq L7063
    inx
    cmp #$27
    beq L7063
    lda #$04
    jsr SetSamusNextAnim
L7063:
    lda L7072,x
    sta ObjAnimResetIndex
    ldx $47
L706B:
    lda L7074,x
    sta SamusAccelX
    rts

L7072:
    .byte $00, $37
L7074:
    .byte $30, $D0



L7076:
    ldx $47
    lda SamusAccelY
    beq L70D7
    ldy SamusJumpDsplcmnt
L7080:
    bit ObjSpeedY
    bmi L7090
    cpy #$18
    bcs L70B6
    lda #$0C
    sta ObjAnimResetIndex
    bcc L70B6
L7090:
    cpy #$18
    bcc L70B6
    lda ObjAnimResetIndex
    cmp #$20
    beq L70A0
        lda #$0E
        sta ObjAnimResetIndex
    L70A0:
    cpy #$20
    bcc L70B6
    lda $15
    and #$08
    beq L70AF
    lda #$35
    sta ObjAnimResetIndex
L70AF:
    bit $15
    bmi L70B6
    jsr L74FD
L70B6:
    lda #$00
    cmp ObjAnimResetIndex
    bne L70C2
    lda #$0C
    sta ObjAnimResetIndex
L70C2:
    lda $5E
    beq L70CA
    lda $13
    bmi L70F4
L70CA:
    jsr SamusRun_CheckHorzMovementMidair
    jsr L7452
    jsr L72E2
    lda #$02
    bne L7121
L70D7:
    lda SamusOnElevator
    bne L70DF
    jsr L706B
L70DF:
    jsr L7173
    dec $4D
    bne L70ED
    lda #$09
    sta $4D
    jsr SFX_SamusWalk
L70ED:
    jsr L72E2
    lda $13
    bpl L70FF
L70F4:
    jsr L7377
    lda #$12
    sta SamusHorzSpeedMax
    jmp L711F
L70FF:
    ora $17
    asl a
    bpl L7107
    jsr L718B
L7107:
    lda $15
    and #$03
    bne L7113
    jsr SetSamusStand
    jmp L711F
L7113:
    jsr BitScan
    cmp $47
    beq L711F
    sta $47
    jsr L704C
L711F:
    lda #$03
L7121:
    jsr L800B
    jsr L7150
    bcs L7132
        lda FrameCount
        lsr a
        and #$03
        ora #$A0
        sta $65
    L7132:
    jsr L71AE
    jsr LavaAndMoveCheck
    lda $8D
    beq L7140
        lda #$A1
        sta $65
    L7140:
    jsr L7146
    jmp L81C6



L7146:
    lda $47
    jsr MAIN_Amul16
    ora $65
    sta $65
    rts



L7150:
    sec
    ldy ObjAction
    dey
    bne RTS_7172
    lda CurSamusStat.SamusGear
    and #$08
    beq RTS_7172
    lda ObjAnimResetIndex
    cmp #$0E
    beq L716F
    cmp #$0C
    sec
    bne RTS_7172
    bit ObjSpeedY
    bpl RTS_7172
L716F:
    cmp ObjAnimIndex
RTS_7172:
    rts



L7173:
    lda $15
    and #$08
    lsr a
    lsr a
    lsr a
    tax
    lda $7072,x
    cmp ObjAnimResetIndex
    beq RTS_7172
    jsr SetSamusAnim
    pla
    pla
    jmp L711F
L718B:
    jsr L75A4
    lda $15
    and #$08
    bne L719A
    lda #$22
    sta ObjAnimIndex
    rts
L719A:
    lda ObjAnimIndex
    sec
    sbc ObjAnimResetIndex
    and #$03
    tax
    lda L71AA,x
    jmp SetSamusNextAnim

L71AA:
    .byte $3F
    .byte $3B
    .byte $3D
    .byte $3F

L71AE:
    lda SamusIsHit
    and #$20
    beq L71E4
    lda #$32
    sta $6A
    lda #$FF
    sta $6C
    lda $6D
    sta $71
    beq L71D2
    bpl L71C8
    jsr L6F9E
L71C8:
    lda SamusIsHit
    and #$08
    lsr a
    lsr a
    lsr a
    sta $6C
L71D2:
    lda #$FD
    sta ObjSpeedY
    lda #$38
    sta SamusAccelY
    jsr IsSamusDead
    bne L71E4
    jmp L721A
L71E4:
    lda $6A
    beq L721A
    dec $6A
    ldx $6C
    inx
    beq L7207
    jsr MAIN_Adiv16
    cmp #$03
    bcs L71FE
    ldy SamusAccelX
    bne L7207
    jsr L7302
L71FE:
    dex
    bne L7204
    jsr MAIN_TwosComplement
L7204:
    sta ObjSpeedX
L7207:
    lda $71
    bpl L721A
    lda FrameCount
    and #$01
    bne L721A
    tay
    sty ObjAnimDelay
    ldy #$F7
    sty ObjAnimFrame
L721A:
    ldy Health+1
    dey
    bmi L7229
    bne L7232
    lda Health
    cmp #$70
    bcs L7232
L7229:
    lda FrameCount
    and #$0F
    bne L7232
    jsr L6F6C
L7232:
    lda #$00
    sta SamusIsHit
    rts



IsSamusDead:
    ;Samus is dead. Zero flag is set.
    lda ObjAction
    cmp #$07
    beq RTS_7245
    cmp #$08
    beq RTS_7245
    ;Samus not dead. Clear zero flag.
    cmp #$FF
RTS_7245:
    rts



SubtractHealth:
    ;Check to see if health needs to be changed. If not, branch to exit.
    lda HealthChange
    ora HealthChange+1.b
    beq RTS_7245
    ;Samus cannot be hurt while she is dead
    jsr IsSamusDead
    beq GotoClearHealthChange
    ;If end escape timer is running, Samus cannot be hurt.
    ldy EndTimer+1
    iny
    beq L725A ;Branch if end escape timer no
    GotoClearHealthChange:
        jmp ClearHealthChange
    L725A:
    ;If mother brain is in the process of dying, receive no damage.
    lda MotherBrainStatus
    cmp #$03
    bcs GotoClearHealthChange
    
    ;Branch if Samus doesn't have Varia.
    lda CurSamusStat.SamusGear
    and #$20
    beq L7273
    ;Samus has Varia, divide damage by 2.
    lsr HealthChange
    lsr HealthChange+1.b
    bcc L7273
    ;If Health+1 moved a bit into the carry flag while--> 
    ;dividing, add #$4F to Health for proper division results.
    lda #$4F
    adc HealthChange
    sta HealthChange

L7273:
    ;Prepare to subtract from Health.
    lda Health
    sta $03
    ;Amount to subtract from Health.
    lda $68
    sec
    jsr MAIN_Base10Subtract
    sta Health
    lda Health+1
    sta $03
    lda $69
    jsr MAIN_Base10Subtract
    sta Health+1
    lda Health
    and #$F0
    ora Health+1
    beq L729A
        bcs L72DF
    L729A:
    lda #$00
    sta Health
    sta Health+1
    lda #$07
    sta ObjAction
    jsr L6FA2
    jmp L703F



L72AD:
    lda Health
    sta $03
    lda $68
    clc
    jsr MAIN_Base10Add
    sta Health
    lda Health+1
    sta $03
    lda $69
    jsr MAIN_Base10Add
    sta Health+1
    lda CurSamusStat.TankCount
    jsr MAIN_Amul16
    ora #$0F
    cmp Health+1
    bcs L72DF
    and #$F9
    sta Health+1
    lda #$99
    sta Health
L72DF:
    jmp ClearHealthChange



L72E2:
    lda SamusIsHit
    lsr a
    and #$02
    beq RTS_7308
    bcs L72F3
    lda SamusAccelX
    bmi RTS_7308
    bpl L72FA
L72F3:
    lda SamusAccelX
    bmi L72FA
        bne RTS_7308
    L72FA:
    jsr MAIN_TwosComplement
    sta SamusAccelX
L7300:
    ldy #$00
L7302:
    sty ObjSpeedX
    sty SamusSpeedSubPixelX
RTS_7308:
    rts



SetSamusStand: ;($7309)
    ;Is Samus moving horizontally? If so, don't play the walk sfx
    lda SamusAccelX
    bne @NoFootstep
        jsr SFX_SamusWalk
    @NoFootstep: ;($7311)
    ;Clear horizontal movement and animation delay data.
    jsr NoHorzMoveNoDelay
    ;Samus is standing.
    sty ObjAction
    ;Is The up button being pressed? If so, branch.
    lda Joy2Status
    and #BUTTON_UP
    bne SetSamusPntUp
    ;Set Samus animation for standing.
    lda #$07

SetSamusAnim: ;($731F)
    ;Set new animation reset index.
    sta ObjAnimResetIndex

SetSamusNextAnim: ;($7322)
    ;Set new animation data index.
    sta ObjAnimIndex
    ;New animation to take effect immediately.
    lda #$00
    sta ObjAnimDelay
    rts



SetSamusPntUp: ;($732B)
    lda #$04
    sta ObjAction
    lda #$27
    jsr SetSamusAnim

NoHorzMoveNoDelay: ;($7335)
    jsr L736B
    sty ObjAnimDelay
    rts



SamusRun_CheckHorzMovementMidair: ;($733C)
    lda Joy2Status
    and #BUTTON_RIGHT | BUTTON_LEFT.b
    beq L735D
        jsr BitScan
        tax
        jsr L706B
        lda SamusAccelY
        bmi RTS_7371
        lda ObjAnimResetIndex
        cmp #$0E
        beq RTS_7371
        stx $47
        lda $744D,x
        jmp SetSamusAnim
    L735D:
    lda SamusAccelY
    bmi RTS_7371
    beq RTS_7371
    lda ObjAnimResetIndex
    cmp #$0C
    bne RTS_7371
L736B:
    jsr L7300
    sty SamusAccelX
RTS_7371:
    rts



L7372:
    ldy #$35
    jmp L7379
L7377:
    ldy #$0C
L7379:
    sty ObjAnimResetIndex
    dey
    sty ObjAnimIndex
    lda #$04
    sta ObjAnimDelay
    lda #$00
    sta SamusJumpDsplcmnt
    lda #$FC
    sta ObjSpeedY
    ldx ObjAction
    dex
    bne L73A6
    lda CurSamusStat.SamusGear
    and #$08
    beq L73A6
    lda #$00
    sta $0686
    jsr L6F8A
    bne L73A9
L73A6:
    jsr L6F6C
L73A9:
    ldy #$18
    lda CurSamusStat.SamusGear
    and #$02
    beq L73B4
    ldy #$12
L73B4:
    sty SamusAccelY
    rts



L73B8:
    lda SamusJumpDsplcmnt
    bit ObjSpeedY
    bpl L73CB
    cmp #$20
    bcc L73CB
    bit $15
    bmi L73CB
    jsr L74FD
L73CB:
    jsr L740B
    jsr L72E2
    lda $15
    and #$08
    beq L73E1
    lda #$35
    sta ObjAnimResetIndex
    lda #$06
    sta ObjAction
L73E1:
    jsr L7452
    lda $5E
    beq L73F2
    lda $13
    bpl L73F2
    jsr L7377
    jmp L711F
L73F2:
    lda SamusAccelY
    bne L7406
    lda ObjAction
    cmp #$06
    bne L7403
    jsr SetSamusPntUp
    bne L7406
L7403:
    jsr SetSamusStand
L7406:
    lda #$03
    jmp L7121
L740B:
    ldx #$01
    ldy #$00
    lda $15
    lsr a
    bcs L741A
    dex
    lsr a
    bcc L7448
    dex
    iny
L741A:
    cpy $47
    beq L7448
    lda ObjAction
    cmp #$06
    bne L7433
    lda ObjAnimResetIndex
    cmp $744F,y
    bne L743E
    lda $7450,y
    jmp L743E
L7433:
    lda ObjAnimResetIndex
    cmp $744C,y
    bne L743E
    lda $744D,y
L743E:
    jsr SetSamusAnim
    lda #$08
    sta ObjAnimDelay
    sty $47
L7448:
    stx ObjSpeedX
RTS_744B:
    rts

L744C:
    .byte $0C
    .byte $0C
    .byte $0C
    .byte $35
    .byte $35
    .byte $35

L7452:
    lda $13
    ora $17
    asl a
    bpl RTS_744B
    lda ObjAnimResetIndex
    cmp #$35
    bne L7463
    jmp L761C
L7463:
    jsr L75C6
    lda #$20
    jmp SetSamusAnim



L746B:
    lda CurSamusStat.SamusGear
    and #$10
    beq L7491
    lda SamusAccelY
    bne L7491
    ldx $47
    lda #$16
    sta ObjAnimResetIndex
    lda #$13
    sta ObjAnimIndex
    lda $7074,x
    sta SamusAccelX
    lda #$01
    sta $0686
    jmp L6F8A
L7491:
    lda #$00
    sta ObjAction
    rts



L7497:
    lda $13
    and #$08
    bne L74A1
    bit $13
    bpl L74D4
L74A1:
    lda $15
    and #$04
    bne L74D4
    lda ObjRadY
    clc
    adc #$08
    sta ObjRadY
    jsr L8B0D
    bcc L74D4
    ldx #$00
    jsr L8C13
    stx $05
    lda #$F5
    sta $04
    jsr LAC7C
    jsr L79B5
    jsr SetSamusStand
    dec ObjAnimIndex
    jsr L74FD
    lda #$04
    jmp L74FA
L74D4:
    lda $13
    jsr BitScan
    cmp #$02
    bcs L74E4
    sta $47
    lda #$16
    jsr SetSamusAnim
L74E4:
    ldx $47
    jsr L706B
    jsr L72E2
    jsr L7506
    lda $15
    and #$03
    bne L74F8
    jsr L736B
L74F8:
    lda #$02
L74FA:
    jmp L7121
L74FD:
    ldy #$00
    sty ObjSpeedY
    sty SamusSpeedSubPixelY
    rts
L7506:
    lda CurSamusStat.SamusGear
    lsr a
    bcc RTS_754D
    lda $13
    ora $17
    asl a
    bpl RTS_754D
    lda ObjSpeedY
    ora SamusOnElevator
    bne RTS_754D
    ldx #$D0
    lda ObjAction,x
    beq L7530
    ldx #$E0
    lda ObjAction,x
    beq L7530
    ldx #$F0
    lda ObjAction,x
    bne RTS_754D
L7530:
    lda ObjHi
    sta ObjHi,x
    lda ObjX
    sta ObjX,x
    lda ObjY
    clc
    adc #$04
    sta ObjY,x
    lda #$08
    sta ObjAction,x
    jsr L6F68
RTS_754D:
    rts



SamusPntUp: ;($754E)
    lda Joy2Status
    and #BUTTON_UP
    bne L7559
        lda #$00
        sta ObjAction
    L7559:
    lda Joy2Status
    and #BUTTON_DOWN | BUTTON_LEFT | BUTTON_RIGHT.b
    beq L756F
        jsr BitScan
        cmp #BUTTONBIT_DOWN
        bcs L7568
            sta $47
        L7568:
        tax
        lda Table07,x
        sta ObjAction
    L756F:
    lda Joy2Change
    ora Joy2Retrig
    asl a
    bpl L7579
        jsr L75A4
    L7579:
    bit Joy2Change
    bpl L7582
        lda #$06
        sta ObjAction
    L7582:
    lda #$04
    jsr L7121
    lda ObjAction
    jsr MAIN_ChooseRoutine
        .word SetSamusStand
        .word L704C
        .word RTS_D07F
        .word L746B
        .word RTS_D07F
        .word RTS_D07F
        .word L7372
        .word RTS_D07F
        .word RTS_D07F
        .word RTS_D07F

Table07: ;($75A1)
    .byte $01
    .byte $01
    .byte $03


L75A4:
    lda $15
    and #$08
    beq L75C6
    jmp L761C
L75AD:
    ldy #$D0
L75AF:
    lda ObjAction,y
    beq L75BB
    jsr LA0DB
    bne L75AF
    iny
    rts
L75BB:
    sta SamusIsHit,y
    lda $010E
    beq RTS_75C5
    cpy #$D0
RTS_75C5:
    rts
L75C6:
    lda $8D
    bne L7610
    jsr L75AD
    bne L7610
    jsr L7683
    jsr L76F1
    jsr L7720
    lda #$0C
    sta SamusJumpDsplcmnt,y
    ldx $47
    lda $761A,x
    sta ObjSpeedX,y
    lda #$00
    sta ObjSpeedY,y
    lda #$01
    sta ObjOnScreen,y
    jsr L76AD
    lda ObjAction,y
    asl a
    ora $47
    and #$03
    tax
    lda $7616,x
    sta $05
    lda #$FA
    sta $04
    jsr L769E
    ldx ObjAction,y
    dex
    bne L7610
    jsr L6F74
L7610:
    ldy #$09
L7612:
    tya
    jmp SetSamusNextAnim
    .byte $0C
L7617:
    .byte $F4
    php
    sed
    .byte $04
    .byte $FC
L761C:
    lda $8D
    bne L7664
    jsr L75AD
    bne L7664
    jsr L7683
    jsr L771C
    jsr L7720
    lda #$0C
    sta SamusJumpDsplcmnt,y
    lda #$FC
    sta ObjSpeedY,y
    lda #$00
    sta ObjSpeedX,y
    lda #$01
    sta ObjOnScreen,y
    jsr L76D8
    ldx $47
    lda L767F,x
    sta $05
    lda ObjAction,y
    and #$01
    tax
    lda L7681,x
    sta $04
    jsr L769E
    lda ObjAction,y
    cmp #$01
    bne L7664
    jsr L6F74
L7664:
    ldx $47
    ldy L767B,x
    lda SamusAccelY
    beq L7671
    ldy L767D,x
L7671:
    lda ObjAction
    cmp #$01
    beq RTS_769D
    jmp L7612

L767B:
    .byte $26
    .byte $26
L767D:
    .byte $34
    .byte $34
L767F:
    .byte $01
    .byte $FF
L7681:
    .byte $EC
    .byte $F0

L7683:
    tya
    tax
    inc ObjAction,x
    lda #$02
    sta ObjRadY,y
    sta ObjRadX,y
    lda #$1B
L7692:
    sta ObjAnimResetIndex,x
L7695:
    sta ObjAnimIndex,x
    lda #$00
    sta ObjAnimDelay,x
RTS_769D:
    rts



L769E:
    ldx #$00
    jsr L8C13
    tya
    tax
    jsr LAC7C
    txa
    tay
    jmp L79B5
L76AD:
    lda $010E
    beq RTS_76F0
    cpy #$D0
    bne RTS_76F0
    ldx $47
    lda $76D6,x
    
L76BB:
    jsr L76E5
    jsr L6F5E
    lda #$0B
    sta ObjAction,y
    lda #$FF
    sta SamusJumpDsplcmnt,y
    dec CurSamusStat.MissileCount
    bne RTS_76F0
    dec $010E
    jmp SelectSamusPal

L76D6:
    .byte $8D, $8B

L76D8:
    lda $010E
    beq RTS_76F0
    cpy #$D0
    bne RTS_76F0
    lda #$8F
    bne L76BB
L76E5:
    sta ObjAnimIndex,y
    sta ObjAnimResetIndex,y
    lda #$00
    sta ObjAnimDelay,y
RTS_76F0:
    rts
L76F1:
    lda $47
L76F3:
    sta $0502,y
    bit CurSamusStat.SamusGear
    bvc RTS_76F0
    lda #$00
    sta $0501,y
    sta ObjAnimDelay,y
    tya
    jsr MAIN_Adiv32
    lda #$00
    bcs L770D
    lda #$0C
L770D:
    sta $0500,y
    lda #$02
    sta ObjAction,y
    lda #$7D
    jsr L76E5
    beq L772A
L771C:
    lda #$02
    bne L76F3
L7720:
    lda CurSamusStat.SamusGear
    bpl RTS_76F0
    lda #$03
    sta ObjAction,y
L772A:
    jmp L6F86



L772D:
    lda $50
    cmp #$05
    bcc L7796
    dec $53
    bne L777C
    asl a
    bcc L773F
    lsr a
    sta $50
    bne L7796
L773F:
    jsr L780D
    jsr Doors_RemoveIfOffScreen
    jsr $B5A3
    lda $74
    beq L775D
    pha
    jsr L7CAA
    pla
    bpl L775D
    lda #$00
    sta $74
    beq L775D
L7759:
    lda #$80
    sta $74
L775D:
    lda $8EA2
    beq L776C
    jsr L6FBB
    lda #$00
    sta $8EA2
    beq L7759
L776C:
    lda $52
    and #$0F
    sta ObjAction
    lda #$00
    sta $52
    sta $50
    jsr L74FD
L777C:
    lda $48
    beq L778E
    ldy ObjX
    bne L7788
    jsr ToggleSamusHi
L7788:
    dec ObjX
    jmp L7796
L778E:
    inc ObjX
    bne L7796
    jsr ToggleSamusHi
L7796:
    jsr L71AE
    jsr L7146
    jmp L81C6



L779F:
    lda #$01
    jmp L7121



L77A4:
    lda ElevatorStatus
    cmp #$03
    beq L77AF
    cmp #$08
    bne L77F2
L77AF:
    lda ElevatorType
    bmi L77D4
    lda ObjY
    sec
    sbc $FC
    cmp #$84
    bcc L77C1
    jsr ScrollDown
L77C1:
    ldy ObjY
    cpy #$EF
    bne L77CD
    jsr ToggleSamusHi
    ldy #$FF
L77CD:
    iny
    sty ObjY
    jmp L77FF
L77D4:
    lda ObjY
    sec
    sbc $FC
    cmp #$64
    bcs L77E1
    jsr ScrollUp
L77E1:
    ldy ObjY
    bne @L77EB
    jsr ToggleSamusHi
    ldy #$F0
@L77EB:
    dey
    sty ObjY
    jmp L77FF
L77F2:
    ldy #$00
    sty ObjSpeedY
    cmp #$05
    beq L7804
    cmp #$07
    beq L7804
L77FF:
    lda FrameCount
    lsr a
    bcc RTS_780C
L7804:
    jsr L7146
    lda #$01
    jmp L81C3
RTS_780C:
    rts

L780D:
    ldx #$60
    sec
    @loop:
        jsr L7835
        txa
        sbc #$20
        tax
        bpl @loop
    jsr GetNameTableAtScrollDir
    tay
    ldx #$18
L781F:
    jsr L7829
    txa
    sec
    sbc #$08
    tax
    bne L781F
L7829:
    tya
    cmp $072C,x
    bne RTS_7834
    lda #$FF
    sta $0728,x
RTS_7834:
    rts



L7835:
    lda $0405,x
    and #$02
    bne RTS_783F
    sta $B460,x
RTS_783F:
    rts



L7840:
    ldx #$D0
    jsr L784C
    ldx #$E0
    jsr L784C
    ldx #$F0
L784C:
    stx $45
    lda ObjAction,x
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word L786C
        .word L78AD
        .word L7942
        .word L7949
        .word L79DB
        .word L79ED
        .word L7A0E
        .word L79DB
        .word L79ED
        .word L7A0E
        .word L786C



L786C:
    lda #$01
    sta $6B
    jsr L7979
    jsr L795B
    jsr L7986
L7879:
    ldx $45
    bcc L7890
    lda CurSamusStat.SamusGear
    and #$04
    bne L7898
    dec SamusJumpDsplcmnt,x
    bne L7898
    lda #$00
    sta ObjAction,x
    beq L7898
L7890:
    lda ObjAction,x
    beq L789D
    jsr L7965
L7898:
    lda #$01
    jsr L81C3
L789D:
    dec $6B
    rts



L78A0:
    inc $0500,x
L78A3:
    inc $0500,x
    lda #$00
    sta $0501,x
    beq L78C7



L78AD:
    lda #$01
    sta $6B
    jsr L7979
    jsr L795B
    lda $0502,x
    and #$FE
    tay
    lda WaveBulletTrajectoryPointers,y
    sta $0A
    lda WaveBulletTrajectoryPointers+1,y
    sta $0B
L78C7:
    ldy $0500,x
    lda ($0A),y
    cmp #$FF
    bne L78D6
    sta $0500,x
    jmp L78A3
L78D6:
    cmp $0501,x
    beq L78A0
    inc $0501,x
    iny
    lda ($0A),y
    jsr LAF46
    ldx $45
    sta ObjSpeedY,x
    lda ($0A),y
    jsr LAFDF
    ldx $45
    sta ObjSpeedX,x
    tay
    lda $0502,x
    lsr a
    bcc L7901
    tya
    jsr MAIN_TwosComplement
    sta ObjSpeedX,x
L7901:
    jsr L7986
    bcs L7909
    jsr L79A1
L7909:
    jmp L7879



WaveBulletTrajectoryPointers: ;($790C)
    .word WaveBulletTrajectoryHorizontal
    .word WaveBulletTrajectoryVertical
    
WaveBulletTrajectoryHorizontal:
    SignMagSpeed $01,  3, -7
    SignMagSpeed $01,  3, -5
    SignMagSpeed $01,  3, -1
    SignMagSpeed $01,  3,  1
    SignMagSpeed $01,  3,  5
    SignMagSpeed $01,  3,  7
    SignMagSpeed $01,  3,  7
    SignMagSpeed $01,  3,  5
    SignMagSpeed $01,  3,  1
    SignMagSpeed $01,  3, -1
    SignMagSpeed $01,  3, -5
    SignMagSpeed $01,  3, -7
    .byte $FF
    
WaveBulletTrajectoryVertical:
    SignMagSpeed $01,  7, -3
    SignMagSpeed $01,  5, -3
    SignMagSpeed $01,  1, -3
    SignMagSpeed $01, -1, -3
    SignMagSpeed $01, -5, -3
    SignMagSpeed $01, -7, -3
    SignMagSpeed $01, -7, -3
    SignMagSpeed $01, -5, -3
    SignMagSpeed $01, -1, -3
    SignMagSpeed $01,  1, -3
    SignMagSpeed $01,  5, -3
    SignMagSpeed $01,  7, -3
    .byte $FF



L7942:
    lda #$81
    sta $65
    jmp L786C



L7949:
    lda #$01
    sta $6B
    lda ObjAnimFrame,x
    sec
    sbc #$F7
    bne L7958
        sta ObjAction,x
    L7958:
    jmp L7898

L795B:
    lda SamusIsHit,x
    beq RTS_7978
    lda #$00
    sta SamusIsHit,x
L7965:
    lda #$1D
    ldy ObjAction,x
    cpy #$0B
    bne L7970
    lda #$91
L7970:
    jsr L7692
    lda #$04
L7975:
    sta ObjAction,x
RTS_7978:
    rts

L7979:
    lda ObjOnScreen,x
    lsr a
    bcs RTS_7978
L797F:
    lda #$00
    beq L7975
L7983:
    jmp L8B89

L7986:
    jsr L7B1C
    ldy #$00
    lda ($04),y
    cmp #$A0
    bcs L79A1
    jsr $B5B8
    cmp #$4E
    beq L7983
    jsr L79CE
    bcc RTS_79CD
    clc
    jmp L8D13
L79A1:
    ldx $45
    lda ObjSpeedX,x
    sta $05
    lda ObjSpeedY,x
    sta $04
    jsr L8C13
    jsr LAC7C
    bcc L797F
L79B5:
    lda $08
    sta ObjY,x
    lda $09
    sta ObjX,x
    lda $0B
    and #$01
    bpl L79CA
L79C5:
    lda ObjHi,x
    eor #$01
L79CA:
    sta ObjHi,x
RTS_79CD:
    rts
L79CE:
    ldy $6E
    cpy #$10
    beq L79D8
    cmp #$70
    bcs RTS_79DA
L79D8:
    cmp #$80
RTS_79DA:
    rts



L79DB:
    lda #$7F
    jsr L7692
    lda #$18
    sta SamusJumpDsplcmnt,x
    inc ObjAction,x
L79E8:
    lda #$03
    jmp L81C3



L79ED:
    lda FrameCount
    lsr a
    bcc L7A0B
    dec SamusJumpDsplcmnt,x
    bne L7A0B
    lda #$37
    ldy ObjAction,x
    cpy #$09
    bne L7A02
    lda #$82
L7A02:
    jsr L7692
    inc ObjAction,x
    jsr L6F5A
L7A0B:
    jmp L79E8



L7A0E:
    inc SamusJumpDsplcmnt,x
    jsr L7A24
    ldx $45
    lda ObjAnimFrame,x
    sec
    sbc #$F7
    bne L7A21
    sta ObjAction,x
L7A21:
    jmp L79E8
L7A24:
    jsr L7B1C
    lda $04
    sta $0A
    lda $05
    sta $0B
    ldx $45
    ldy SamusJumpDsplcmnt,x
    dey
    beq L7A61
    dey
    bne L7A65
    lda #$40
    jsr L7B08
    txa
    bne L7A48
    lda $04
    and #$20
    beq RTS_7A64
L7A48:
    lda $05
    and #$03
    cmp #$03
    bne L7A61
    lda $04
    cmp #$C0
    bcc L7A61
    lda $43
    and #$02
    bne RTS_7A64
    lda #$80
    jsr L7B08
L7A61:
    jsr L7AE7
RTS_7A64:
    rts
L7A65:
    dey
    bne L7A92
    lda #$40
    jsr L7AFC
    txa
    bne L7A76
    lda $04
    and #$20
    bne RTS_7A64
L7A76:
    lda $05
    and #$03
    cmp #$03
    bne L7A8F
    lda $04
    cmp #$C0
    bcc L7A8F
    lda $43
    and #$02
    bne RTS_7A64
    lda #$80
    jsr L7AFC
L7A8F:
    jmp L7AE7
L7A92:
    dey
    bne L7ABE
    lda #$02
    jsr L7B08
    txa
    bne L7AA2
    lda $04
    lsr a
    bcc RTS_7AFB
L7AA2:
    lda $04
    and #$1F
    cmp #$1E
    bcc L7ABB
    lda $43
    and #$02
    beq RTS_7AFB
    lda #$1E
    jsr L7AFC
    lda $05
    eor #$04
    sta $05
L7ABB:
    jmp L7AE7
L7ABE:
    dey
    bne RTS_7AFB
    lda #$02
    jsr L7AFC
    txa
    bne L7ACE
    lda $04
    lsr a
    bcs RTS_7AFB
L7ACE:
    lda $04
    and #$1F
    cmp #$02
    bcs L7AE7
    lda $43
    and #$02
    beq RTS_7AFB
    lda #$1E
    jsr L7B08
    lda $05
    eor #$04
    sta $05
L7AE7:
    txa
    pha
    ldy #$00
    lda ($04),y
    jsr L79CE
    bcc L7AF9
    cmp #$A0
    bcs L7AF9
    jsr L8D17
L7AF9:
    pla
    tax
RTS_7AFB:
    rts
L7AFC:
    clc
    adc $0A
    sta $04
    lda $0B
    adc #$00
    jmp L7B15
L7B08:
    sta $00
    lda $0A
    sec
    sbc $00
    sta $04
    lda $0B
    sbc #$00
L7B15:
    and #$07
    ora #$60
    sta $05
RTS_7B1B:
    rts
L7B1C:
    ldx $45
    lda ObjY,x
    sta $02
    lda ObjX,x
    sta $03
    lda ObjHi,x
    sta $0B
    jmp L8CBF
L7B30:
    ldx #$20
    stx $45
    lda ObjAction,x
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word L7B4E
        .word L7B8B
        .word L7BBA
        .word L7BED
        .word L7C20
        .word L7C49
        .word L7C20
        .word L7BBA
        .word L7CCC

L7B4E:
    lda SamusOnElevator
    beq L7B83
    lda #$04
    bit ElevatorType
    bpl L7B5B
        asl a
    L7B5B:
    and $15
    beq L7B83
    jsr L74FD
    sty ObjAnimDelay
    sty SamusAccelY
    tya
    sta ObjSpeedY,x
    inc ObjAction,x
    lda #$09
    sta ObjAction
    lda #$04
    jsr SetSamusAnim
    lda #$80
    sta ObjX
    lda #$70
    sta ObjY
L7B83:
    lda FrameCount
    lsr a
    bcc RTS_7B1B
    jmp L81C6



L7B8B:
    lda $FD
    bne L7BA1
    lda $73
    ora #$08
    sta $73
    lda $43
    and #$01
    sta $43
    inc ObjAction,x
    jmp L7B83
L7BA1:
    lda #$80
    sta ObjX
    lda ObjX,x
    sec
    sbc $FD
    bmi L7BB4
    jsr L8A12
    jmp L7B83
L7BB4:
    jsr L8A3D
    jmp L7B83



L7BBA:
    lda SamusJumpDsplcmnt,x
    bpl L7BD1
    ldy ObjY,x
    bne L7BC9
    jsr L79C5
    ldy #$F0
L7BC9:
    dey
    tya
    sta ObjY,x
    jmp L7BE3
L7BD1:
    inc ObjY,x
    lda ObjY,x
    cmp #$F0
    bne L7BE3
    jsr L79C5
    lda #$00
    sta ObjY,x
L7BE3:
    cmp #$83
    bne L7BEA
    inc ObjAction,x
L7BEA:
    jmp L7B83



L7BED:
    lda $FC
    bne L7C0F
    lda #$4E
    sta ObjAnimResetIndex
    lda #$41
    sta ObjAnimIndex
    lda #$5D
    sta ObjAnimResetIndex,x
    lda #$50
    sta ObjAnimIndex,x
    inc ObjAction,x
    lda #$40
    sta $24
    jmp L7B83
L7C0F:
    lda SamusJumpDsplcmnt,x
    bpl L7C1A
    jsr ScrollUp
    jmp L7B83
L7C1A:
    jsr ScrollDown
    jmp L7B83



L7C20:
    lda $24
    cmp #$3F
    pha
    bcc L7C2A
        jsr SelectSamusPal
    L7C2A:
    pla
    bne L7C44
    inc ObjAction,x
    lda ObjAction,x
    cmp #$08
    bne L7C44
    lda #$23
    sta ObjAnimFrame,x
    lda #$04
    jsr SetSamusAnim
    jmp L7B83
L7C44:
    lda #$01
    jmp L81C3



L7C49:
    lda SamusJumpDsplcmnt,x
    tay
    cmp #$8F
    bne L7C5E
        lda #$07
        sta $1E
        inc CurSamusStat.byteC
        jsr L6E00
        jmp PrepareSwitchDiskSide
    L7C5E:
    tya
    bpl L7C69
        ldy #$00
        cmp #$84
        bne L7C68
            iny
        L7C68:
        tya
    L7C69:
    ora #$10
    jsr LB261
    lda $70
    eor #$07
    sta $70
    ldy $6E
    cpy #$12
    bcc L7C7C
    lda #$01
L7C7C:
    sta $1C
    jsr L7CAA
    jsr METHEX_ScreenOn
    jsr CopyAreaPointers
    jsr DestroyEnemies
    ldx #$20
    stx $45
    lda #$6B
    sta ObjAnimResetIndex
    lda #$5F
    sta ObjAnimIndex
    lda #$7A
    sta ObjAnimResetIndex,x
    lda #$6E
    sta ObjAnimIndex,x
    inc ObjAction,x
    lda #$40
    sta $24
    rts
L7CAA:
    lda ElevatorStatus
    cmp #$06
    bne L7CB6
    lda ElevatorType
    bmi L7CBF
L7CB6:
    lda $B5C5
    ldy $74
    bmi L7CC5
    beq L7CC5
L7CBF:
    lda #$81
    sta $74
    lda #$20
L7CC5:
    ora $0685
    sta $0685
    rts



L7CCC:
    lda $FC
    bne L7CF1
    lda #$00
    sta ObjAction
    jsr SetSamusStand
    ldx $45
    lda #$01
    sta ObjAction,x
    lda SamusJumpDsplcmnt,x
    eor #$80
    sta SamusJumpDsplcmnt,x
    bmi L7CEE
        jsr ToggleScroll
        sta $73
    L7CEE:
    jmp L7B83
L7CF1:
    jmp L7C0F



L7CF4:
    lda #$00
    sta SamusOnElevator
    sta $78
    tay
    ldx #$50
    jsr LA073
L7D01:
    lda $B460,x
    cmp #$04
    bne L7D1C
    jsr LA03F
    jsr LA0AC
    jsr LA0E7
    bcs L7D1C
    jsr L7D38
    bne L7D1C
    inc $78
    bne L7D21
L7D1C:
    jsr LA0E1
    bpl L7D01
L7D21:
    lda ElevatorStatus
    beq RTS_7D37
    ldy #$00
    ldx #$20
    jsr L7FF8
    bcs RTS_7D37
    jsr L7D38
    bne RTS_7D37
    inc SamusOnElevator
RTS_7D37:
    rts
L7D38:
    lda $10
    and #$02
    bne L7D45
    ldy $11
    iny
    cpy $04
    beq RTS_7D51
L7D45:
    lda SamusIsHit
    and #$38
    ora $10
    ora #$40
    sta SamusIsHit
RTS_7D51:
    rts
L7D52:
    lda #$60
    sta $45
    ldy StatueStatus
    beq RTS_7D51
    dey
    bne L7D6B
    jsr L7E26
    ldy #$01
    jsr L7E26
    bcs L7D6B
    inc StatueStatus
L7D6B:
    ldy StatueStatus
    cpy #$02
    bne L7D8B
    lda CurSamusStat.byte4
    bpl L7D7C
    ldy #$02
    jsr L7E26
L7D7C:
    lda CurSamusStat.byte5
    bpl L7D86
    ldy #$03
    jsr L7E26
L7D86:
    bcs L7D8B
    inc StatueStatus
L7D8B:
    ldx #$60
    jsr L7D98
    ldx #$61
    jsr L7D98
    jmp L7E50
L7D98:
    jsr L7DBB
    jsr L7DFA
    txa
    and #$01
    tay
    lda $7DB9,y
    sta StatueAnimFrame
    lda $B3B4,x
    beq L7DB4
    bmi L7DB4
    lda FrameCount
    lsr a
    bcc RTS_7DF9
L7DB4:
    jmp L81C6
    dey
    pla
    adc $66
L7DBB:
    lda ObjAnimDelay,x
    bmi RTS_7DF9
    lda #$01
    sta ObjAnimDelay,x
    lda SamusJumpDsplcmnt,x
    and #$0F
    beq RTS_7DF9
    inc ObjAnimDelay,x
    dec SamusJumpDsplcmnt,x
    lda SamusJumpDsplcmnt,x
    and #$0F
    bne RTS_7DF9
    lda ObjAnimDelay,x
    ora #$80
    sta ObjAnimDelay,x
    sta $B3B4,x
    inc ObjAnimDelay,x
    txa
    pha
    and #$01
    pha
    tay
    jsr L7E26
    pla
    tay
    iny
    iny
    jsr L7E26
    pla
    tax
RTS_7DF9:
    rts
L7DFA:
    lda SamusJumpDsplcmnt,x
    sta StatueY
    txa
    and #$01
    tay
    lda $7DB7,y
    sta StatueX
    lda $B3B4,x
    beq L7E20
    bmi L7E20
    lda ObjAnimDelay,x
    cmp #$01
    bne L7E20
    lda ObjAnimIndex,x
    beq L7E20
    dec SamusJumpDsplcmnt,x
L7E20:
    lda #$00
    sta ObjAnimIndex,x
    rts
L7E26:
    lda StatueTileBlastWRAMPtrLoTable,y
    sta $05C8
    lda StatueHi
    asl a
    asl a
    ora StatueTileBlastWRAMPtrHiTable,y
    sta $05C9
    lda #$09
    sta $05C3
    lda #$C0
    sta $45
    jsr L9E4F
    lda #$60
    sta $45
    rts

StatueTileBlastWRAMPtrLoTable: ;($7E48)
    .byte <$6130 ; non-raised kraid top left corner
    .byte <$60AC ; non-raised ridley top left corner
    .byte <$60F0 ; raised kraid top left corner
    .byte <$606C ; raised ridley top left corner
StatueTileBlastWRAMPtrHiTable:
    .byte >$6130
    .byte >$60AC
    .byte >$60F0
    .byte >$606C

L7E50:
    lda $4E
    bmi RTS_7E8C
    lda $50
    bne RTS_7E8C
    lda CurSamusStat.byte4
    and CurSamusStat.byte5
    bpl RTS_7E8C
    sta $4E
    ldx #$70
    ldy #$08
L7E66:
    lda #$03
    sta $0500,x
    tya
    asl a
    sta $0507,x
    lda #$04
    sta $050A,x
    lda StatueHi
    asl a
    asl a
    ora #$62
    sta $0509,x
    tya
    asl a
    adc #$08
    sta $0508,x
    jsr LA0E1
    dey
    bne L7E66
RTS_7E8C:
    rts
L7E8D:
    lda CurSamusStat.MissileCount
    beq RTS_7E8C
    lda $13
    ora $17
    and #$20
    beq RTS_7E8C
    lda $010E
    eor #$01
    sta $010E
    jmp SelectSamusPal
L7EA5:
    sec
    lda #$00
L7EA8:
    rol a
    dey
    bpl L7EA8
RTS_7EAC:
    rts
L7EAD:
    lda #$40
    sta $45
    ldx #$00
    jsr L7EB8
    ldx #$08
L7EB8:
    stx $46
    ldy $0748,x
    iny
    beq RTS_7EAC
    lda $0749,x
    sta PowerUpDrawY
    lda $074A,x
    sta PowerUpDrawX
    lda $074B,x
    sta PowerUpDrawHi
    jsr L7B1C
    ldx $46
    ldy #$00
    lda ($04),y
    cmp #$A0
    bcc RTS_7EAC
    lda $0748,x
    and #$0F
    ora #$50
    sta PowerUpDrawAnimFrame
    lda FrameCount
    lsr a
    and #$03
    ora #$80
    sta $65
    lda $55
    pha
    lda $074F,x
    jsr L81C6
    pla
    cmp $55
    beq RTS_7F6C
    tax
    ldy $46
    lda $0748,y
    ldy #$01
    cmp #$07
    beq L7F15
    dey
    cmp #$06
    beq L7F15
    cmp #$02
    bne L7F1B
L7F15:
    tya
    sta $0206,x
    lda #$FF
L7F1B:
    pha
    ldx #$00
    ldy #$40
    jsr L7FF5
    pla
    bcs RTS_7F6C
    tay
    jsr L6FAD
    ldx $46
    iny
    beq L7F3C
    lda $074B,x
    sta $08
    lda $0748,x
    sta $09
    jsr L7F92
L7F3C:
    lda $0748,x
    tay
    cpy #$08
    bcs L7F6D
    cpy #$06
    bcc L7F50
    lda CurSamusStat.SamusGear
    and #$3F
    sta CurSamusStat.SamusGear
L7F50:
    jsr L7EA5
    ora CurSamusStat.SamusGear
    sta CurSamusStat.SamusGear
L7F59:
    lda #$FF
    sta $0109
    sta $0748,x
    ldy $74
    beq L7F67
    ldy #$01
L7F67:
    sty $74
    jmp SelectSamusPal
RTS_7F6C:
    rts



L7F6D:
    beq L7F76
    .byte $A9
L7F70:
    .byte $05
    jsr L8113
    bne L7F59
L7F76:
    lda CurSamusStat.TankCount
    cmp #$06
    beq L7F80
    inc CurSamusStat.TankCount
L7F80:
    lda CurSamusStat.TankCount
    jsr MAIN_Amul16
    ora #$09
    sta Health+1
    lda #$99
    sta Health
    bne L7F59
L7F92:
    lda $4A
L7F94:
    sta $07
    lda $49
    sta $06
    lda $43
    lsr a
    php
    beq L7FAA
    bcc L7FB2
    lda $FD
    beq L7FB2
    dec $07
    bcs L7FB2
L7FAA:
    bcc L7FB2
    lda $FC
    beq L7FB2
    dec $06
L7FB2:
    lda $FF
    eor $08
    and #$01
    plp
    clc
    beq L7FC3
    adc $07
    sta $07
    jmp L7FC7
L7FC3:
    adc $06
    sta $06
L7FC7:
    jsr L7FDD
L7FCA:
    ldy $B420
    lda $06
    sta $B421,y
    lda $07
    sta $B422,y
    iny
    iny
    sty $B420
    rts
L7FDD:
    lda $07
    jsr MAIN_Amul32
    ora $06
    sta $06
    lsr $07
    lsr $07
    lsr $07
    lda $09
    asl a
    asl a
    ora $07
    sta $07
    rts
L7FF5:
    jsr LA073
L7FF8:
    jsr LA05F
    jsr LA094
    jmp LA0E7



MAIN_TwosComplement: ;($8001)
    eor #$FF
    clc
    adc #$01
    rts



    .byte $00
    .byte $80
    cpy #$40
L800B:
    ldx $45
    ldy ObjAnimDelay,x
    beq L8017
    dec ObjAnimDelay,x
    bne RTS_802C
L8017:
    sta ObjAnimDelay,x
    ldy ObjAnimIndex,x
L801D:
    lda $95C4,y
    cmp #$FF
    beq L802D
    sta ObjAnimFrame,x
    iny
    tya
    sta ObjAnimIndex,x
RTS_802C:
    rts

L802D:
    ldy ObjAnimResetIndex,x
    jmp L801D
    pha
    lda #$00
    sta $06
    pla
    bpl L803D
    dec $06
L803D:
    clc
    rts
L803F:
    ldy #$00
    sty $0F
    lda ($00),y
    sta $04
    tax
    jsr MAIN_Adiv16
    and #$03
    sta $05
    txa
    and #$C0
    ora #$20
    ora $05
    sta $05
    lda $65
    and #$10
    asl a
    asl a
    eor $04
    sta $04
    lda $65
    bpl L806B
    asl $65
    jsr L83AF
L806B:
    txa
    and #$0F
    asl a
    tax
    rts
L8071:
    jsr L82A4
    plp
    plp
    ldx $45
L8078:
    lda $6E
    cmp #$13
    bne L8089
    lda $B46E,x
    cmp #$04
    beq L80DF
    cmp #$02
    beq L80DF
L8089:
    lda $040C,x
    asl a
    bmi L80F1
    jsr LA638
    sta $00
    jsr LAD60
    and #$20
    sta $B46E,x
    lda #$05
    sta $B460,x
    lda #$60
    sta $040D,x
    lda RandomNumber1
    cmp #$10
    bcc L80D7
L80AC:
    and #$07
    tay
    lda $81B1,y
    sta $B463,x
    cmp #$80
    bne L80C7
    ldy $8E
    cpy $90
    beq L80D7
    lda CurSamusStat.MaxMissiles
    beq L80D7
    inc $90
RTS_80C6:
    rts
L80C7:
    ldy $8F
    cpy $91
    beq L80D7
    inc $91
    cmp #$89
    bne RTS_80C6
    lsr $00
    bcs RTS_80C6
L80D7:
    ldx $45
    lda $6E
    cmp #$13
    beq L80E2
L80DF:
    jmp LA905
L80E2:
    lda RandomNumber1
    ldy #$00
    sty $91
    sty $90
    iny
    sty $8E
    sty $8F
    bne L80AC
L80F1:
    jsr L6FAD
    lda $6E
    and #$0F
    sta $0108
    lsr a
    tay
    sta CurSamusStat.MaxMissiles,y
    lda #$4B
    jsr L8113
    bne L80D7
L8107:
    ldx $45
    lda $B463,x
    cmp #$F7
    bne L812C
    jmp L82A4
L8113:
    pha
    clc
    adc CurSamusStat.MissileCount
    bcc L811C
    lda #$FF
L811C:
    sta CurSamusStat.MissileCount
    pla
    clc
    adc CurSamusStat.MaxMissiles
    bcc L8128
    lda #$FF
L8128:
    sta CurSamusStat.MaxMissiles
    rts
L812C:
    lda $0400,x
    sta $0A
    lda $0401,x
    sta $0B
    lda $B467,x
    sta $06
    lda $B463,x
    asl a
    tay
    lda ($3B),y
    bcc L8146
    lda ($3D),y
L8146:
    sta $00
    iny
    lda ($3B),y
    bcc L814F
    lda ($3D),y
L814F:
    sta $01
    jsr L803F
    tay
    lda ($3F),y
    sta $02
    iny
    lda ($3F),y
    sta $03
    ldy #$00
    cpx #$02
    bne L8181
    ldx $45
    inc $0406,x
    lda $0406,x
    pha
    and #$03
    tax
    lda $05
    and #$3F
    ora $8007,x
    sta $05
    pla
    cmp #$19
    bne L8181
    jmp L8071
L8181:
    ldx $45
    iny
    lda ($00),y
    sta $B461,x
    jsr L81B9
    iny
    lda ($00),y
    sta $B462,x
    sta $09
    iny
    sty $11
    jsr L8356
    txa
    asl a
    sta $08
    ldx $45
    lda $0405,x
    and #$FD
    ora $08
    sta $0405,x
    lda $08
    beq L81CF
    jmp L8255
    .byte $80
    sta ($89,x)
    .byte $80
    sta ($89,x)
    sta ($89,x)
L81B9:
    sec
    sbc #$10
    bcs L81C0
    lda #$00
L81C0:
    sta $08
    rts
L81C3:
    jsr L800B
L81C6:
    ldx $45
    lda ObjAnimFrame,x
    cmp #$F7
    bne L81D2
L81CF:
    jmp L82A4
L81D2:
    cmp #$07
    bne L81DC
    lda $65
    and #$EF
    sta $65
L81DC:
    lda ObjY,x
    sta $0A
    lda ObjX,x
    sta $0B
    lda ObjHi,x
    sta $06
    lda ObjAnimFrame,x
    asl a
    tax
    lda $965D,x
    sta $00
    lda $965E,x
    sta $01
    jsr L803F
    lda $9731,x
    sta $02
    lda $9732,x
    sta $03
    lda $4F
    beq L8233
    cpx #$0E
    bne L8233
    ldx $45
    inc $5F
    lda $5F
    pha
    and #$03
    tax
    lda $05
    and #$3F
    ora $8007,x
    sta $05
    pla
    cmp #$19
    bne L8233
    ldx $45
    lda #$08
    sta ObjAction,x
    pla
    pla
    jmp L82A4
L8233:
    ldx $45
    iny
    lda ($00),y
    sta ObjRadY,x
    jsr L81B9
    iny
    lda ($00),y
    sta ObjRadX,x
    sta $09
    iny
    sty $11
    jsr L8356
    txa
    ldx $45
    sta ObjOnScreen,x
    tax
    beq L825A
L8255:
    ldx $55
    jmp L8290
L825A:
    jmp L82A4
L825D:
    ldy $0F
    jsr L82E2
    adc $10
    sta $0200,x
    dec $0200,x
    inc $0F
    ldy $11
    lda ($00),y
    sta $0201,x
    lda $65
    asl a
    asl a
    and #$40
    eor $05
    sta $0202,x
    inc $11
    ldy $0F
    jsr L831A
    adc $0E
    sta $0203,x
    inc $0F
    inx
    inx
    inx
    inx
L8290:
    ldy $11
L8292:
    lda ($00),y
    cmp #$FC
    bcc L825D
    beq L82C8
    cmp #$FD
    beq L82B2
    cmp #$FE
    beq L82A9
    stx $55
L82A4:
    lda #$00
    sta $65
    rts
L82A9:
    inc $0F
    inc $0F
    inc $11
    jmp L8290
L82B2:
    iny
    asl $65
    bcc L82BC
    jsr L83AF
    bne L82C2
L82BC:
    lsr $65
    lda ($00),y
    sta $05
L82C2:
    iny
    sty $11
    jmp L8292
L82C8:
    iny
    lda ($00),y
    clc
    adc $10
    sta $10
    inc $11
    inc $11
    ldy $11
    lda ($00),y
    clc
    adc $0E
    sta $0E
    inc $11
    jmp L8290
L82E2:
    lda ($02),y
    tay
    and #$F0
    cmp #$80
    beq L82F2
    tya
L82EC:
    bit $04
    bmi L8328
    clc
    rts
L82F2:
    tya
    and #$0E
    lsr a
    tay
    lda L83C0,y
    ldy $4F
    bne L8306
    ldy $45
    adc $0406,y
    jmp L8308
L8306:
    adc $5F
L8308:
    tay
    lda $83C2,y
    pha
    lda $0F
    clc
    adc #$0C
    tay
    pla
    clc
    adc ($02),y
    jmp L82EC
L831A:
    lda ($02),y
    tay
    and #$F0
    cmp #$80
    beq L832F
    tya
L8324:
    bit $04
    bvc L832D
L8328:
    eor #$FF
    sec
    adc #$F8
L832D:
    clc
    rts
L832F:
    ldy $45
    lda $0406,y
    ldy $4F
    beq L833A
    lda $5F
L833A:
    asl a
    pha
    ldy $0F
    lda ($02),y
    lsr a
    bcs L8349
    pla
    eor #$FF
    adc #$01
    pha
L8349:
    lda $0F
    clc
    adc #$0C
    tay
    pla
    clc
    adc ($02),y
    jmp L8324
L8356:
    ldx #$01
    lda $0A
    tay
    sec
    sbc $FC
    sta $10
    lda $0B
    sec
    sbc $FD
    sta $0E
    lda $43
    and #$02
    bne L8393
    cpy $FC
    lda $06
    eor $FF
    and #$01
    beq L8389
    bcs L8391
    lda $10
    sbc #$0F
    sta $10
    lda $09
    clc
    adc $10
    cmp #$F0
    bcc RTS_8392
    clc
L8389:
    bcc L8391
    lda $09
    cmp $10
    bcc RTS_8392
L8391:
    dex
RTS_8392:
    rts
L8393:
    lda $06
    eor $FF
    and #$01
    beq L83A5
    bcs L83AD
    lda $09
    clc
    adc $0E
    bcc RTS_83AE
    clc
L83A5:
    bcc L83AD
    lda $09
    cmp $0E
    bcc RTS_83AE
L83AD:
    dex
RTS_83AE:
    rts
L83AF:
    lsr $65
    lda ($00),y
    and #$C0
    ora $65
    sta $05
    lda $65
    ora #$80
    sta $65
    rts

L83C0:
    .byte $00, $18, $30, $FC, $F8, $F4, $F0, $EE, $EC, $EA, $E8, $E7, $E6, $E6, $E5, $E5
    .byte $E4, $E4, $E3, $E5, $E7, $E9, $EB, $EF, $F3, $F7, $FB, $FE, $FC, $FA, $F8, $F6
    .byte $F4, $F2, $F0, $EE, $ED, $EB, $EA, $E9, $E8, $E7, $E6, $E6, $E6, $E6, $E6, $E8
    .byte $EA, $EC, $EE, $FE, $FC, $FA, $F8, $F7, $F6, $F5, $F4, $F3, $F2, $F1, $F1, $F0
    .byte $F0, $EF, $EF, $EF, $EF, $EF, $EF, $F0, $F0, $F1, $F2

L840B:
    ldx $45
    ldy $B460,x
    cpy #$05
    beq RTS_8432
    ldy $B464,x
    beq L841E
    dec $B464,x
    bne RTS_8432
L841E:
    sta $B464,x
    ldy $B466,x
L8424:
    lda ($41),y
    cmp #$FF
    beq L8433
    sta $B463,x
    iny
    tya
    sta $B466,x
RTS_8432:
    rts
L8433:
    ldy $B465,x
    bcs L8424
L8438:
    ldy #$00
    lda $55
    pha
    tax
L843E:
    lda $8524,y
    sta $0200,x
    inx
    iny
    cpy #$28
    bne L843E
    stx $55
    pla
    tax
    lda Health+1
    and #$0F
    jsr L84DE
    lda Health
    jsr MAIN_Adiv16
    jsr L84DE
    ldy EndTimer+1
    iny
    bne L848B
    ldy CurSamusStat.MaxMissiles
    beq L8481
    lda CurSamusStat.MissileCount
    jsr L8503
    lda $02
    jsr L84DE
    lda $01
    jsr L84DE
    lda $00
    jsr L84DE
    bne L84B5
L8481:
    lda #$FF
    sta $020D,x
    sta $0211,x
    bne L84B5
L848B:
    lda EndTimer+1
    jsr MAIN_Adiv16
    jsr L84DE
    lda EndTimer+1
    and #$0F
    jsr L84DE
    lda EndTimer
    jsr MAIN_Adiv16
    jsr L84DE
    lda #$BD
    sta $0201,x
    lda #$BE
    sta $0205,x
    inc $0202,x
    inc $0206,x
L84B5:
    ldx $55
    lda CurSamusStat.TankCount
    beq RTS_84DD
    sta $03
    lda #$40
    sta $00
    ldy #$6F
    lda Health+1
    jsr MAIN_Adiv16
    sta $01
    bne L84CF
    dey
L84CF:
    jsr L84E6
    dec $01
    bne L84D7
    dey
L84D7:
    dec $03
    bne L84CF
    stx $55
RTS_84DD:
    rts
L84DE:
    ora #$80
    sta $0201,x
    jmp L84FE
L84E6:
    lda #$17
    sta $0200,x
    tya
    sta $0201,x
    lda #$01
    sta $0202,x
    lda $00
    sta $0203,x
    sec
    sbc #$0A
    sta $00
L84FE:
    inx
    inx
    inx
    inx
    rts
L8503:
    ldy #$64
    sty $0A
    jsr L8518
    sty $02
    ldy #$0A
    sty $0A
    jsr L8518
    sty $01
    sta $00
    rts
L8518:
    ldy #$00
    sec
L851B:
    iny
    sbc $0A
    bcs L851B
    dey
    adc $0A
    rts

DataDisplayTbl: ;($8524)
    .byte $21, $80, $01, $30           ;Upper health digit.
    .byte $21, $80, $01, $38           ;Lower health digit.
    .byte $2B, $FF, $01, $28           ;Upper missile digit.
    .byte $2B, $FF, $01, $30           ;Middle missile digit.
    .byte $2B, $FF, $01, $38           ;Lower missile digit.
    .byte $2B, $5E, $00, $18           ;Left half of missile.
    .byte $2B, $5F, $00, $20           ;Right half of missile.
    .byte $21, $76, $01, $18           ;E
    .byte $21, $7F, $01, $20           ;N
    .byte $21, $3A, $00, $28           ;..

BitScan: ;($854C)
    stx $0E
    ldx #$00
    @loop:
        lsr a
        bcs @exitLoop
        inx
        cpx #$08
        bne @loop
@exitLoop:
    txa
    ldx $0E
RTS_855B:
    rts



ScrollDoor: ;($855C)
    ldx $50
    beq RTS_855B
    dex
    bne L8569
        jsr L8A3D
        jmp L856F
    L8569:
        dex
        bne L8577
        jsr L8A12
    L856F:
    ldx $FD
    bne RTS_85B3
    ldx #$05
    bne DoOneDoorScroll
L8577:
    dex
    bne L8580
        jsr ScrollDown
        jmp VerticalRoomCentered
    L8580:
    dex
    bne RTS_85B3
    jsr ScrollUp

VerticalRoomCentered: ;($8586)
    ldx $FC
    bne RTS_85B3
    stx $66
    stx $67
    inx
    lda ObjX
    bmi L85AC
    inx
    bne L85AC

DoOneDoorScroll: ;($8597)
    lda #$20
    sta $53
    lda $52
    jsr MAIN_Amul8
    bcs L85A8
        ldy $51
        cpy #$03
        bcc L85AC
    L85A8:
    lda #$47
    bne L85AF

L85AC:
    jsr ToggleScroll
L85AF:
    sta $73
    stx $50
RTS_85B3:
    rts



ToggleSamusHi: ;($85B4)
    lda ObjHi
    eor #$01
    sta ObjHi
    rts



ToggleScroll: ;($85BD)
    lda $43
    eor #$03
    sta $43
    lda $73
    eor #$08
    rts



IsSamusInLava: ;($85C8)
    lda #$01
    cmp $43
    bcs RTS_85D3
    lda #$D8
    cmp ObjY
RTS_85D3:
    rts



LavaAndMoveCheck: ;($85D4)
    lda ObjAction
    cmp #$09
    beq L85DF
        cmp #$07
        bcs RTS_85D3
    L85DF:
    jsr IsSamusInLava
    ldy #$FF
    bcs L8611
    sty $6C
    jsr ClearHealthChange
    lda #$32
    sta $6A
    lda FrameCount
    and #$03
    bne L85F8
    jsr L6F6C
L85F8:
    lda FrameCount
    lsr a
    and #$03
    bne L860F
    lda CurSamusStat.SamusGear
    and #$20
    beq L8608
    bcc L860F
L8608:
    lda #$07
    sta $68
    jsr SubtractHealth
L860F:
    ldy #$00
L8611:
    iny
    sty $5E
    jsr VertAccelerate
    lda ObjY
    sec
    sbc $FC
    sta $4C
    lda $00
    bpl L8642
    jsr MAIN_TwosComplement
    ldy $5E
    beq L862D
    lsr a
    beq L8685
L862D:
    sta $5F
L862F:
    jsr MoveSamusUp
    bcs L863E
    sec
    ror ObjSpeedY
    ror SamusSpeedSubPixelY
    jmp L8685
L863E:
    dec $5F
    bne L862F
L8642:
    beq L8685
    ldy $5E
    beq L864C
    lsr a
    lsr a
    beq L8685
L864C:
    sta $5F
L864E:
    jsr MoveSamusDown
    bcs L8681
    lda ObjAction
    cmp #$03
    bne L8676
    lsr ObjSpeedY
    beq L8679
    ror SamusSpeedSubPixelY
    lda #$00
    sec
    sbc SamusSpeedSubPixelY
    sta SamusSpeedSubPixelY
    lda #$00
    sbc ObjSpeedY
    sta ObjSpeedY
    jmp L8685
L8676:
    jsr SFX_SamusWalk
L8679:
    jsr L74FD
    sty SamusAccelY
    beq L8685
L8681:
    dec $5F
    bne L864E
L8685:
    jsr HorzAccelerate
    lda ObjX
    sec
    sbc $FD
    sta $4B
    lda $00
    bpl L86B2
    jsr MAIN_TwosComplement
    ldy $5E
    beq L869E
    lsr a
    beq RTS_86CF
L869E:
    sta $5F
L86A0:
    jsr L8991
    jsr CheckStopHorzMvmt
    dec $5F
    bne L86A0
    lda $52
    beq RTS_86CF
    lda #$01
    bne L86CD
L86B2:
    beq RTS_86CF
    ldy $5E
    beq L86BB
    lsr a
    beq RTS_86CF
L86BB:
    sta $5F
L86BD:
    jsr L89D3
    jsr CheckStopHorzMvmt
    dec $5F
    bne L86BD
    lda $52
    beq RTS_86CF
    lda #$00
L86CD:
    sta $48
RTS_86CF:
    rts



CheckStopHorzMvmt: ;($86D0)
    bcs RTS_86CF
    lda #$01
    sta $5F
    lda SamusAccelY
    bne RTS_86CF
    lda ObjAction
    cmp #$03
    beq RTS_86CF
    jmp SetSamusStand



VertAccelerate: ;($86E5)
    lda SamusAccelY
    bne @dontStartFalling
    lda #$18
    sta SamusHorzSpeedMax
    lda ObjY
    clc
    adc ObjRadY
    and #$07
    bne @endIf_A
        jsr L8B18
        bcc @dontStartFalling
    @endIf_A:
    jsr L7CF4
    lda SamusOnElevator
    bne @dontStartFalling
    lda $78
    bne @dontStartFalling
    lda #$1A
    sta SamusAccelY
@dontStartFalling:
    ldx #$05
    lda SamusSpeedSubPixelY
    clc
    adc SamusAccelY
    sta SamusSpeedSubPixelY
    lda ObjSpeedY
    adc #$00
    sta ObjSpeedY
    bpl @else_B
        lda #$00
        cmp SamusSpeedSubPixelY
        sbc ObjSpeedY
        cmp #$06
        ldx #$FA
        bne @endIf_B
    @else_B:
        cmp #$05
    @endIf_B:
    bcc @endIf_C
        jsr L74FD
        stx ObjSpeedY
    @endIf_C:
    lda SamusSubPixelY
    clc
    adc SamusSpeedSubPixelY
    sta SamusSubPixelY
    lda #$00
    adc ObjSpeedY
    sta $00
    rts



HorzAccelerate: ;($8750)
    lda SamusHorzSpeedMax
    jsr MAIN_Amul16
    sta $00
    sta $02
    lda SamusHorzSpeedMax
    jsr MAIN_Adiv16
    sta $01
    sta $03
    lda SamusSpeedSubPixelX
    clc
    adc SamusAccelX
    sta SamusSpeedSubPixelX
    tax
    lda #$00
    bit SamusAccelX
    bpl L8778
        lda #$FF
    L8778:
    adc ObjSpeedX
    sta ObjSpeedX
    tay
    bpl L8791
        lda #$00
        sec
        sbc SamusSpeedSubPixelX
        tax
        lda #$00
        sbc ObjSpeedX
        tay
        jsr NegateTemp00Temp01
    L8791:
    cpx $02
    tya
    sbc $03
    bcc L87A2
        lda $00
        sta SamusSpeedSubPixelX
        lda $01
        sta ObjSpeedX
    L87A2:
    lda SamusSubPixelX
    clc
    adc SamusSpeedSubPixelX
    sta SamusSubPixelX
    lda #$00
    adc ObjSpeedX
    sta $00
    rts



NegateTemp00Temp01: ;($87B4)
    lda #$00
    sec
    sbc $00
    sta $00
    lda #$00
    sbc $01
    sta $01
    rts



MoveSamusUp: ;($87C2)
    lda ObjY
    sec
    sbc ObjRadY
    and #$07
    bne L87D2
        jsr L8B0D
        bcc RTS_880D
    L87D2:
    lda ObjAction
    cmp #$09
    beq L87E6
        jsr L7CF4
        lda SamusIsHit
        and #$42
        cmp #$42
        clc
        beq RTS_880D
    L87E6:
    lda $4C
    cmp #$66
    bcs L87F1
        jsr ScrollUp
        bcc L87F3
    L87F1:
        dec $4C
    L87F3:
    lda ObjY
    bne L8806
        lda $43
        and #$02
        bne L8801
            jsr ToggleSamusHi
        L8801:
        lda #$F0
        sta ObjY
    L8806:
    dec ObjY
    inc SamusJumpDsplcmnt
    sec
RTS_880D:
    rts



MoveSamusDown: ;($880E)
    lda ObjY
    clc
    adc ObjRadY
    and #$07
    bne L881E
        jsr L8B18
        bcc RTS_885B
    L881E:
    lda ObjAction
    cmp #$09
    beq L8832
        jsr L7CF4
        lda SamusOnElevator
        clc
        bne RTS_885B
        lda $78
        bne RTS_885B
    L8832:
    lda $4C
    cmp #$84
    bcc L883D
        jsr ScrollDown
        bcc L883F
    L883D:
        inc $4C
    L883F:
    lda ObjY
    cmp #$EF
    bne L8854
        lda $43
        and #$02
        bne L884F
            jsr ToggleSamusHi
        L884F:
        lda #$FF
        sta ObjY
    L8854:
    inc ObjY
    dec SamusJumpDsplcmnt
    sec
RTS_885B:
    rts



ScrollUp: ;($885C)
    lda $43
    beq L886C
        cmp #$01
        bne L8882
        dec $43
        lda $FC
        beq L886C
        dec $49
    L886C:
    ldx $FC
    bne L887C
        dec $49
        jsr L8A8B
        bcs L8880
        jsr L8D0C
        ldx #$F0
    L887C:
    dex
    jmp L88AA
L8880:
    inc $49
L8882:
    sec
    rts



ScrollDown: ;($8884)
    ldx $43
    dex
    beq L8893
    bpl L88B3
    inc $43
    lda $FC
    beq L8893
    inc $49
L8893:
    lda $FC
    bne L889E
    inc $49
    jsr L8A8B
    bcs L88B1
L889E:
    ldx $FC
    cpx #$EF
    bne L88A9
    jsr L8D0C
    ldx #$FF
L88A9:
    inx
L88AA:
    stx $FC
    jsr CheckUpdateNameTable
    clc
    rts
L88B1:
    dec $49
L88B3:
    sec
RTS_88B4:
    rts



CheckUpdateNameTable: ;($88B5)
    jsr L8D80
    ldx $54
    inx
    bne RTS_88B4
    lda $43
    and #$02
    bne L88C6
    jmp L88DC
L88C6:
    jmp L8A6C

Table11: ;($88C9)
    .byte $07
    .byte $00

;---------------------------------[ Get PPU and RoomRAM addresses ]----------------------------------

PPUAddrs: ;($88CB)
    .byte $20                       ;High byte of nametable #0(PPU).
    .byte $2C                       ;High byte of nametable #3(PPU)

WRAMAddrs: ;($88CD)
    .byte >RoomRAMA         ;High byte of RoomRAMA(cart RAM).
    .byte >RoomRAMB         ;High byte of RoomRAMB(cart RAM).

GetNameAddrs: ;($88CF)
    jsr GetNameTableAtScrollDir
    and #$01                        ;Update name table 0 or 3.
    tay                             ;
    lda PPUAddrs,y                  ;Get high PPU addr of nametable(dest).
    ldx WRAMAddrs,y                 ;Get high cart RAM addr of nametable(src).
    rts



L88DC:
    ldx $43
    lda $FC
    and #$07
    cmp $88C9,x
    bne RTS_88B4
L88E7:
    ldx $43
    cpx $44
    bne RTS_88B4
    lda $FC
    and #$F8
    sta $00
    lda #$00
    asl $00
    rol a
    asl $00
    rol a
L88FB:
    sta $01
    jsr GetNameAddrs
    ora $01
    sta $03
    txa
    ora $01
    sta $01
    lda $00
    sta $02
    lda $43
    lsr a
    tax
    lda $894B,x
    sta $04
    ldy #$01
    sty $1B
    dey
    ldx $07A0
    lda $03
    jsr L9526
    lda $02
    jsr L9526
    lda $04
    jsr L9539
    @L892D:
        lda ($00),y
        jsr L9526
        sty $06
        ldy #$01
        bit $04
        bpl @L893C
            ldy #$20
        @L893C:
        jsr MAIN_AddYToPtr00
        ldy $06
        dec $05
        bne @L892D
    stx $07A0
    jsr L9531
    jsr LA29E
    cpy #$A5
    .byte $54
    cmp #$F2
    beq L8957
    ldx #$E0
L8957:
    stx $00
    stx $02
    jsr GetNameAddrs
    ora #$03
    sta $03
    txa
    ora #$03
    sta $01
    lda #$01
    sta $1B
    ldx $07A0
    lda $03
    jsr L9526
    lda $02
    jsr L9526
    lda #$20
    sta $04
    jsr L9526
    ldy #$00
L8981:
    lda ($00),y
    jsr L9526
    iny
    dec $04
    bne L8981
    stx $07A0
    jsr L9531
L8991:
    lda ObjX
    sec
    sbc ObjRadX
    and #$07
    bne L89A1
    jsr L8BD5
    bcc L89CE
L89A1:
    jsr L7CF4
    lda SamusIsHit
    and #$41
    cmp #$41
    clc
    beq L89CE
    lda $4B
    cmp #$71
    bcs L89B9
    jsr L8A12
    bcc L89BB
L89B9:
    dec $4B
L89BB:
    lda ObjX
    bne L89C9
    lda $43
    and #$02
    beq L89C9
    jsr ToggleSamusHi
L89C9:
    dec ObjX
    sec
    rts
L89CE:
    lda #$00
    sta $52
    rts
L89D3:
    lda ObjX
    clc
    adc ObjRadX
    and #$07
    bne L89E3
    jsr L8BE0
    bcc L8A0D
L89E3:
    jsr L7CF4
    lda SamusIsHit
    and #$41
    cmp #$40
    clc
    beq L8A0D
    lda $4B
    cmp #$8F
    bcc L89FB
    jsr L8A3D
    bcc L89FD
L89FB:
    inc $4B
L89FD:
    inc ObjX
    bne L8A0B
    lda $43
    and #$02
    beq L8A0B
    jsr ToggleSamusHi
L8A0B:
    sec
    rts
L8A0D:
    lda #$00
    sta $52
    rts
L8A12:
    lda $43
    cmp #$02
    beq L8A24
    cmp #$03
    bne L8A3B
    dec $43
    lda $FD
    beq L8A24
    dec $4A
L8A24:
    lda $FD
    bne L8A32
    dec $4A
    jsr L8A8B
    bcs L8A39
    jsr L8D0C
L8A32:
    dec $FD
    jsr CheckUpdateNameTable
    clc
    rts


L8A39:
    inc $4A
L8A3B:
    sec
    rts


L8A3D:
    lda $43
    cmp #$03
    beq L8A4F
    cmp #$02
    bne L8A68
    inc $43
    lda $FD
    beq L8A4F
    inc $4A
L8A4F:
    lda $FD
    bne L8A5A
    inc $4A
    jsr L8A8B
    bcs L8A66
L8A5A:
    inc $FD
    bne L8A61
    jsr L8D0C
L8A61:
    jsr CheckUpdateNameTable
    clc
    rts
L8A66:
    dec $4A
L8A68:
    sec
RTS_8A69:
    rts
    .byte $07
    .byte $00
L8A6C:
    ldx $43
    lda $FD
    and #$07
    cmp L8A68,x
    bne RTS_8A69
L8A77:
    ldx $43
    cpx $44
    bne RTS_8A69
    lda $FD
    and #$F8
    jsr MAIN_Adiv8
    sta $00
    lda #$00
    jmp L88FB
L8A8B:
    lda $43
    lsr a
    beq L8A9E
    rol a
    adc #$FF
    pha
    jsr OnNameTable0
    pla
    and $0066,y
    sec
    bne RTS_8ADA
L8A9E:
    lda $49
    jsr MAIN_Amul16
    sta $00
    lda #$00
    rol a
    rol $00
    rol a
    sta $01
    lda $00
    adc $4A
    sta $00
    lda $01
    adc #$68
    sta $01
    ldy #$00
    lda ($00),y
    cmp #$FF
    beq RTS_8ADA
    sta $54
L8AC3:
    cmp $B5C8,y
    beq @L8AD5
    iny
    cpy #$07
    bne L8AC3
    lda $74
    beq L8AD7
    lda #$80
    bne L8AD7
@L8AD5:
    lda #$01
L8AD7:
    sta $74
    clc
RTS_8ADA:
    rts



L8ADB:
    ldx $45
    lda $B461,x
    clc
    adc #$08
    jmp L8AEE



L8AE6:
    ldx $45
    lda #$00
    sec
    sbc $B461,x
L8AEE:
    sta $02
    lda #$08
    sta $04
    jsr L8AFD
    lda $B462,x
    jmp L8B28
L8AFD:
    lda $0401,x
    sta $09
    lda $0400,x
    sta $08
    lda $B467,x
    sta $0B
    rts
L8B0D:
    ldx $45
    lda ObjRadY,x
    clc
    adc #$08
    jmp L8B20
L8B18:
    ldx $45
    lda #$00
    sec
    sbc ObjRadY,x
L8B20:
    sta $02
    jsr L8C13
    lda ObjRadX,x
L8B28:
    bne L8B2C
    sec
    rts
L8B2C:
    sta $03
    tay
    ldx #$00
    lda $09
    sec
    sbc $03
    and #$07
    beq L8B3B
    inx
L8B3B:
    jsr L8C23
    sta $04
    jsr L8C64
    ldx #$00
    ldy #$08
    lda $00
L8B49:
    bne L8B87
    stx $06
    sty $07
    ldx $04
L8B51:
    jsr L8CBF
    ldy #$00
    lda ($04),y
    cmp #$4E
    beq L8B89
    jsr $B5B8
    jsr L79CE
    bcc RTS_8B88
    cmp #$A0
    bcs L8B6B
    jmp L8D13
L8B6B:
    ldy $4F
    beq L8B7E
    dey
    sty $52
    cmp #$A0
    beq L8B7C
    cmp #$A1
    bne L8B7E
    inc $52
L8B7C:
    inc $52
L8B7E:
    dex
    beq L8B87
    jsr L8CE3
    jmp L8B51
L8B87:
    sec
RTS_8B88:
    rts
L8B89:
    ldx $6B
    beq L8BD0
    ldx #$06
L8B8F:
    lda $05
    eor $57,x
    and #$04
    bne L8BC1
    lda $04
    eor $56,x
    and #$1F
    bne L8BC1
    txa
    jsr MAIN_Amul8
    ora #$80
    tay
    lda ObjAction,y
    beq L8BC1
    lda SamusOnElevator,y
    lsr a
    bcs L8BBA
    ldx $45
    lda ObjAction,x
    eor #$0B
    bne L8BD2
L8BBA:
    lda #$04
    sta SamusIsHit,y
    bne L8BD0
L8BC1:
    dex
    dex
    bpl L8B8F
    lda $04
    jsr MAIN_Adiv8
    and #$01
    tax
    inc KraidStatueIsHit,x
L8BD0:
    clc
    rts
L8BD2:
    jmp L6F78
L8BD5:
    ldx $45
    lda ObjRadX,x
    clc
    adc #$08
    jmp L8BE8
L8BE0:
    ldx $45
    lda #$00
    sec
    sbc ObjRadX,x
L8BE8:
    sta $03
    jsr L8C13
    ldy ObjRadY,x
L8BF0:
    bne L8BF4
    sec
    rts
L8BF4:
    sty $02
    ldx #$00
    lda $08
    sec
    sbc $02
    and #$07
    beq L8C02
    inx
L8C02:
    jsr L8C23
    sta $04
    jsr L8C64
    ldx #$08
    ldy #$00
    lda $01
    jmp L8B49
L8C13:
    lda ObjHi,x
    sta $0B
    lda ObjY,x
    sta $08
    lda ObjX,x
    sta $09
    rts
L8C23:
    eor #$FF
    clc
    adc #$01
    and #$07
    sta $04
    tya
    asl a
    sec
    sbc $04
    bcs L8C35
    adc #$08
L8C35:
    tay
    lsr a
    lsr a
    lsr a
    sta $04
    tya
    and #$07
    beq @L8C41
        inx
    @L8C41:
    txa
    clc
    adc $04
    rts
L8C46:
    ldx $45
    lda $B462,x
    clc
    adc #$08
    jmp L8C59
L8C51:
    ldx $45
    lda #$00
    sec
    sbc $B462,x
L8C59:
    sta $03
    jsr L8AFD
    ldy $B461,x
    jmp L8BF0
L8C64:
    lda $02
    bpl L8C77
    jsr L8CB4
    bcs L8C71
    cpx #$F0
    bcc L8C92
L8C71:
    txa
    adc #$0F
    jmp L8C89



L8C77:
    jsr L8CB4
    lda $08
    sec
    sbc $02
    tax
    and #$07
    sta $00
    bcs L8C92
    txa
    sbc #$0F
L8C89:
    tax
    lda $43
    and #$02
    bne L8C92
    inc $0B
L8C92:
    stx $02
    ldx #$00
    lda $03
    bmi L8C9B
    dex
L8C9B:
    lda $09
    sec
    sbc $03
    sta $03
    and #$07
    sta $01
    txa
    adc #$00
    beq RTS_8CB3
    lda $43
    and #$02
    beq RTS_8CB3
    inc $0B
RTS_8CB3:
    rts
L8CB4:
    lda $08
    sec
    sbc $02
    tax
    and #$07
    sta $00
    rts
L8CBF:
    lda #$18
    sta $05
    lda $02
    and #$F8
    asl a
    rol $05
    asl a
    rol $05
    sta $04
    lda $03
    lsr a
    lsr a
    lsr a
    ora $04
    sta $04
    lda $0B
    asl a
    asl a
    and #$04
    ora $05
    sta $05
    rts
L8CE3:
    lda $02
    clc
    adc $06
    sta $02
    cmp #$F0
    bcc L8CFA
    adc #$0F
    sta $02
    lda $43
    and #$02
    bne L8CFA
    inc $0B
L8CFA:
    lda $03
    clc
    adc $07
    sta $03
    bcc RTS_8D0B
    lda $43
    and #$02
    beq RTS_8D0B
    inc $0B
RTS_8D0B:
    rts
L8D0C:
    lda $FF
    eor #$03
    sta $FF
    rts
L8D13:
    ldy $6B
    beq RTS_8D59
L8D17:
    tay
    jsr $B5B5
    cpy #$98
    bcs L8D58
    ldx #$C0
L8D21:
    lda $0500,x
    beq L8D30
    jsr LA0E1
    bne L8D21
    lda $0500,x
    bne L8D58
L8D30:
    inc $0500,x
    lda $04
    and #$DE
    sta $0508,x
    lda $05
    sta $0509,x
    lda $6E
    cmp #$11
    bne L8D4D
    cpy #$76
    bne L8D4D
    lda #$04
    bne L8D54
L8D4D:
    tya
    clc
    adc #$10
    and #$3C
    lsr a
L8D54:
    lsr a
    sta $050A,x
L8D58:
    clc
RTS_8D59:
    rts
L8D5A:
    jsr GetNameTableAtScrollDir
    asl a
    asl a
    ora #$60
    sta $34
    lda #$00
    sta $33
    rts
L8D68:
    lda $54
    and #$0F
    inc $54
    jsr MAIN_ChooseRoutine
    .byte $7F
    bne L8DC1
    .byte $89
    .byte $7F
    bne L8DC5
    .byte $89
    .byte $7B
    sta $FFA9
    sta $54
RTS_8D7F:
    rts
L8D80:
    lda $54
    cmp #$FF
    beq RTS_8D7F
    cmp #$FE
    beq L8DB2
    cmp #$F0
    bcs L8D68
    jsr DeleteOffscreenRoomSprites
    jsr ScanForItems
    lda $54
    asl a
    tay
    lda ($35),y
    sta $2D
    iny
    lda ($35),y
    sta $2E
    ldy #$00
    lda ($2D),y
    sta $62
    lda #$01
    jsr L8E15
    jsr L8D5A
    jsr InitTables
L8DB2:
    jmp L8DFF
L8DB5:
    sta $0E
    lda $33
    sta $31
    lda $34
    sta $32
    lda $0E
L8DC1:
    jsr MAIN_Adiv16
    tax
L8DC5:
    beq L8DD5
L8DC7:
    lda $31
    clc
    adc #$40
    sta $31
    bcc L8DD2
    inc $32
L8DD2:
    dex
    bne L8DC7
L8DD5:
    lda $0E
    and #$0F
    asl a
    adc $31
    sta $31
    bcc L8DE2
    inc $32
L8DE2:
    iny
    lda ($2D),y
    tax
    iny
    lda ($2D),y
    sta $61
    txa
    asl a
    tay
    lda ($37),y
    sta $2F
    iny
    lda ($37),y
    sta $30
    jsr L92E2
    lda #$03
    jsr L8E15
L8DFF:
    ldy #$00
    lda ($2D),y
    cmp #$FF
    beq EndOfRoom
    cmp #$FE
    beq L8E11
    cmp #$FD
    bne L8DB5
    beq L8E1F
L8E11:
    sta $54
    lda #$01
L8E15:
    clc
    adc $2D
    sta $2D
    bcc RTS_8E1E
    inc $2E
RTS_8E1E:
    rts
L8E1F:
    lda $2D
    sta $00
    lda $2E
    sta $01
    lda #$01
EnemyLoop: ;($8E29)
    jsr AddToPtr00
    ldy #$00
    lda ($00),y
    cmp #$FF
    beq EndOfRoom
    and #$0F
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word LoadEnemy
        .word LoadDoor
        .word RTS_D07F
        .word LoadElevator
        .word RTS_D07F
        .word LoadStatues
        .word LoadPipeBugHole

EndOfRoom: ;($8E49)
    ldx #$F0
    stx $54
    lda $43
    sta $44
    and #$02
    bne L8E58
        jmp L88E7
    L8E58:
        jmp L8A77



LoadEnemy: ;($8E5B)
    jsr GetEnemyData
    jmp EnemyLoop
GetEnemyData: ;($8E61)
    lda ($00),y
    and #$F0
    tax
    jsr L8ED0
    bne L8E7A
    iny
    lda ($00),y
    jsr L8E7D
    ldy #$02
    lda ($00),y
    jsr L8EA3
    pha
L8E79:
    pla
L8E7A:
    lda #$03
    rts
L8E7D:
    pha
    and #$C0
    sta $040F,x
    asl a
    bpl L8E9B
    lda $6E
    and #$06
    lsr a
    tay
    lda CurSamusStat.MaxMissiles,y
    beq L8E96
    pla
    pla
    jmp L8E79
L8E96:
    lda #$01
    sta $8EA2
L8E9B:
    pla
L8E9C:
    and #$3F
    sta $B46E,x
    rts
    .byte $00
L8EA3:
    tay
    and #$F0
    ora #$08
    sta $0400,x
    tya
    jsr MAIN_Amul16
    ora #$0C
    sta $0401,x
    lda #$01
    sta $B460,x
    lda #$00
    sta $0404,x
    jsr GetNameTableAtScrollDir
    sta $B467,x
L8EC4:
    ldy $B46E,x
    asl $0405,x
    jsr LAA68
    jmp LA747
L8ED0:
    lda $B460,x
    beq RTS_8EDA
    lda $0405,x
    and #$02
RTS_8EDA:
    rts



GetNameTableAtScrollDir: ;($8ED8)
    lda PPUCTRL_ZP
    eor ScrollDir
    and #$01
    rts



LoadDoor: ;($8EE2)
    jsr SpawnDoorRoutine
L8EE5:
    jmp EnemyLoop
SpawnDoorRoutine: ;($8EE8)
    iny
    lda ($00),y
    pha
    jsr MAIN_Amul16
    php
    lda $4A
    clc
    adc $49
    plp
    rol a
    and #$03
L8EF9:
    tay
    ldx DoorSlots,y
    pla
    and #$03
    sta SamusOnElevator,x
    tya
    pha
    lda SamusOnElevator,x
    cmp #$01
    beq L8F26
    cmp #$03
    beq L8F26
    lda #$0A
    sta $09
    ldy $4A
    txa
    jsr MAIN_Amul16
    bcc L8F1D
    dey
L8F1D:
    tya
    jsr L9197
    jsr CheckForItem
    bcs L8F2B
L8F26:
    lda #$01
    sta ObjAction,x
L8F2B:
    pla
    and #$01
    tay
    jsr GetNameTableAtScrollDir
    sta ObjHi,x
    lda DoorXs,y
    sta ObjX,x
    lda #$68
    sta ObjY,x
    lda DoorScrollBlocks,y
    tay
    jsr GetNameTableAtScrollDir
    eor #$01
    tax
    tya
    ora $66,x
    sta $66,x
    lda #$02
    rts

DoorXs: ;($8F52)
    .byte $F0        ; X coord of RIGHT door
    .byte $10        ; X coord of LEFT door
DoorScrollBlocks: ;($8F54)
    .byte $02        ; right
    .byte $01        ; left
DoorSlots: ;($8F56)
    .byte $80        ; right on white square
    .byte $B0        ; left on white square
    .byte $A0        ; right on black square
    .byte $90        ; left on black square



LoadElevator: ;($8F5A)
    jsr SpawnElevatorRoutine
    bne L8EE5
SpawnElevatorRoutine: ;($8F5F)
    lda ElevatorStatus
    bne @exit
    iny
    lda ($00),y
    sta ElevatorType
    ldy #$83
    sty ElevatorY
    lda #$80
    sta ElevatorX
    jsr GetNameTableAtScrollDir
    sta ElevatorHi
    lda #$23
    sta ElevatorAnimFrame
    inc ElevatorStatus
@exit:
    lda #$02
    rts



LoadStatues: ;($8F85)
    jsr GetNameTableAtScrollDir
    sta StatueHi
    lda #$40
    ldx CurSamusStat.byte5
    bpl L8F94
        lda #$30
    L8F94:
    sta RidleyStatueY
    lda #$60
    ldx CurSamusStat.byte4
    bpl L8FA0
        lda #$50
    L8FA0:
    sta KraidStatueY
    sty $4E
    lda #$01
    sta StatueStatus
L8FAA:
    jmp EnemyLoop



LoadPipeBugHole: ;($8FAD)
    ldx #$20
    @loop:
        txa
        sec
        sbc #$08
        bmi @exit
        tax
        ldy $0728,x
        iny
        bne @loop
    ldy #$00
    lda ($00),y
    and #$F0
    sta $0729,x
    iny
    lda ($00),y
    sta $0728,x
    iny
    lda ($00),y
    tay
    and #$F0
    ora #$08
    sta $072A,x
    tya
    jsr MAIN_Amul16
    ora #$00
    sta $072B,x
    jsr GetNameTableAtScrollDir
    sta $072C,x
@exit:
    lda #$03
    bne L8FAA ; branch always



OnNameTable0: ;($8FE9)
    lda $FF
    eor #$01
    and #$01
    tay
    rts



DeleteOffscreenRoomSprites: ;($8FF1)
    ldx $43
    dex
    ldy #$00
    jsr UpdateDoorData
    iny
    jsr UpdateDoorData
    ldx #$50
    jsr GetNameTableAtScrollDir
    tay
    L9003:
        tya
        eor $B467,x
        lsr a
        bcs L9014
        lda $0405,x
        and #$02
        bne L9014
            sta $B460,x
        L9014:
        jsr LA0E1
        bpl L9003
    ldx #$18
    L901B:
        tya
        eor $B3,x
        lsr a
        bcs L9025
            lda #$00
            sta $B0,x
        L9025:
        txa
        sec
        sbc #$08
        tax
        bpl L901B
    jsr Doors_RemoveIfOffScreen
    jsr EraseScrollBlockOnNameTableAtScrollDir
    jsr GetNameTableAtScrollDir
    asl a
    asl a
    tay
    ldx #$C0
    L903A:
        tya
        eor $0509,x
        and #$04
        bne L9045
            sta $0500,x
        L9045:
        jsr LA0E1
        cmp #$F0
        bne L903A
    tya
    lsr a
    lsr a
    tay
    ldx #$D0
    jsr Projectile_RemoveIfOffScreen
    ldx #$E0
    jsr Projectile_RemoveIfOffScreen
    ldx #$F0
    jsr Projectile_RemoveIfOffScreen
    tya
    sec
    sbc ElevatorHi
    bne L9069
        sta ElevatorStatus
    L9069:
    ldx #$1E
    L906B:
        lda $0704,x
        bne L9075
            lda #$FF
            sta $0700,x
        L9075:
        txa
        sec
        sbc #$06
        tax
        bpl L906B
    cpy StatueHi
    bne L9086
        lda #$00
        sta StatueStatus
    L9086:
    ldx #$18
    L9088:
        tya
        cmp $072C,x
        bne L9093
            lda #$FF
            sta $0728,x
        L9093:
        txa
        sec
        sbc #$08
        tax
        bpl L9088
    ldx #$00
    jsr PowerUp_RemoveIfOffScreen
    ldx #$08
    jsr PowerUp_RemoveIfOffScreen
    jmp $B5A6



UpdateDoorData: ;($90A7)
    txa
    eor #$03
    and $0066,y
L90AD:
    sta $0066,y
    rts



EraseScrollBlockOnNameTableAtScrollDir: ;($90B1)
    jsr GetNameTableAtScrollDir
    eor #$01
    tay
    lda #$00
    beq L90AD



Doors_RemoveIfOffScreen: ;($90BB)
    ldx #$B0
    L90BD:
        lda ObjAction,x
        beq L90CA
        lda ObjOnScreen,x
        bne L90CA
            sta ObjAction,x
        L90CA:
        jsr LA0E1
        bmi L90BD
    rts



Projectile_RemoveIfOffScreen: ;($90D0)
    lda ObjAction,x
    cmp #$05
    bcc RTS_90E1
    tya
    eor ObjHi,x
    lsr a
    bcs RTS_90E1
    sta ObjAction,x
RTS_90E1:
    rts



PowerUp_RemoveIfOffScreen: ;($90E2)
    tya
    cmp $074B,x
    bne RTS_90ED
    lda #$FF
    sta $0748,x
RTS_90ED:
    rts



ScanForItems: ;($90EE)
    lda $B590
    sta $00
    lda $B591
ScanOneItem: ;($90F6)
    sta $01
    ldy #$00
    lda ($00),y
    cmp $49
    beq L9114
    bcs RTS_90ED
    iny
    lda ($00),y
    tax
    iny
    and ($00),y
    cmp #$FF
    beq RTS_90ED
    lda ($00),y
    stx $00
    jmp ScanOneItem

L9114:
    lda #$03
    jsr AddToPtr00
L9119:
    ldy #$00
    lda ($00),y
    cmp $4A
    beq L912A
    bcs RTS_90ED
    iny
    jsr AnotherItem
    jmp L9119
L912A:
    lda #$02
ChooseSpawningRoutine: ;($912C)
    jsr AddToPtr00
    ldy #$00
    lda ($00),y
    and #$0F
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word SpawnMapEnemy
        .word SpawnPowerUp
        .word SpawnMellows
        .word SpawnElevator
        .word SpawnCannon
        .word SpawnMotherBrain
        .word SpawnZebetite
        .word SpawnRinkaSpawner
        .word SpawnDoor
        .word SpawnPalette



SpawnMapEnemy: ;($914E)
    jsr GetEnemyData
@exit: ;($9151)
    jmp ChooseSpawningRoutine



SpawnPowerUp: ;($9154)
    iny
    ldx #$00
    lda #$FF
    cmp $0748
    beq L9165
    ldx #$08
    cmp $0750
    bne L918F
L9165:
    lda ($00),y
    jsr PrepareItemID
    jsr CheckForItem
    bcs L918F
    ldy #$02
    lda $09
    sta $0748,x
    lda ($00),y
    tay
    and #$F0
    ora #$08
    sta $0749,x
    tya
    jsr MAIN_Amul16
    ora #$08
    sta $074A,x
L9189:
    jsr GetNameTableAtScrollDir
    sta $074B,x
L918F:
    lda #$03
    bne SpawnMapEnemy@exit ; branch always



PrepareItemID: ;($9193)
    sta $09
    lda $4A
L9197:
    sta $07
    lda $49
    sta $06
    jmp L7FDD



CheckForItem: ;($91A0)
    ldy $B420
    beq L91B7
L91A5:
    lda $07
    cmp $B420,y
    bne L91B3
    lda $06
    cmp CurSamusStat.byteF,y
    beq RTS_91B8
L91B3:
    dey
    dey
    bne L91A5
L91B7:
    clc
RTS_91B8:
    rts



SpawnMellows: ;($91B9)
    ldx #$18
    lda RandomNumber1
    adc FrameCount
    sta $85
    L91C1:
        jsr SpawnMellow
        txa
        sec
        sbc #$08
        tax
        bpl L91C1
    lda $B5DC
    sta $B555
    sta $B556
    lda #$01
    sta $B550
L91D9:
    jmp ChooseSpawningRoutine



SpawnMellow: ;($91DC)
    lda $B0,x
    bne RTS_91F6
    txa
    adc $85
    and #$7F
    sta $B1,x
    adc RandomNumber2
    sta $B2,x
    jsr GetNameTableAtScrollDir
    sta $B3,x
    lda #$01
    sta $B0,x
    rol $85
RTS_91F6:
    rts



SpawnElevator: ;($91F7)
    jsr SpawnElevatorRoutine
    bne L91D9



SpawnCannon: ;($91FC)
    jsr $B5A9
    lda #$02
L9201:
    jmp ChooseSpawningRoutine



SpawnMotherBrain: ;($9204)
    jsr $B5AC
    lda #$38
    sta $07
    lda #$00
    sta $06
    jsr CheckForItem
    bcc L921C
        lda #$08
        sta $98
        lda #$00
        sta $99
    L921C:
    lda #$01
    bne L9201



SpawnZebetite: ;($9220)
    jsr $B5AF
    txa
    lsr a
    adc #$3C
    sta $07
    lda #$00
    sta $06
    jsr CheckForItem
    bcc L9241
    lda #$81
    sta $0758,x
    lda #$01
    sta $075D,x
    lda #$07
    sta $075B,x
L9241:
    jmp L921C



SpawnRinkaSpawner: ;($9244)
    jsr $B5B2
    jmp L921C



SpawnDoor: ;($924A)
    jsr SpawnDoorRoutine
    jmp ChooseSpawningRoutine



SpawnPalette: ;($9250)
    lda $43
    sta $8C
    bne L921C



AnotherItem: ;($9256)
    lda ($00),y
    cmp #$FF
    bne AddToPtr00
    pla
    pla
    rts



AddToPtr00: ;($925F)
    clc
    adc $00
    sta $00
    bcc RTS_9268
        inc $01
    RTS_9268:
    rts



DrawStructRow: ;($9269)
    and #$0F
    bne L926F
        lda #$10
    L926F:
    sta $0E
    lda ($2F),y
    jsr MAIN_Adiv16
    asl a
    adc $31
    sta $00
    lda #$00
    adc $32
    sta $01
L9281:
    lda $01
    cmp #$63
    beq L928E
    cmp #$67
    bcc L9295
    beq L928E
        rts
    L928E:
    lda $00
    cmp #$A0
    bcc L9295
        rts
    L9295:
    inc $10
    ldy $10
    lda ($2F),y
    asl a
    asl a
    sta $11
    ldx #$03
    L92A1:
        ldy $11
        lda ($39),y
        inc $11
        ldy L92F0,x
        sta ($00),y
        dex
        bpl L92A1
    jsr UpdateAttrib
    ldy #$02
    jsr MAIN_AddYToPtr00
    lda $00
    and #$1F
    bne L92C8
    lda $10
    clc
    adc $0E
    sec
    sbc #$01
    jmp L92CE
L92C8:
    dec $0E
    bne L9281
    lda $10
L92CE:
    sec
    adc $2F
    sta $2F
    bcc L92D7
        inc $30
    L92D7:
    lda #$40
    clc
    adc $31
    sta $31
    bcc L92E2
        inc $32
    L92E2:
    ldy #$00
    sty $10
    lda ($2F),y
    cmp #$FF
    beq RTS_92EF
        jmp DrawStructRow
    RTS_92EF:
        rts

L92F0:
    .byte $21, $20, $01, $00

UpdateAttrib: ;($92F4)
    lda $61
    cmp $62
    beq RTS_9349
    lda $00
    sta $02
    lda $01
    lsr a
    ror $02
    lsr a
    ror $02
    lda $02
    and #$07
    sta $03
    lda $02
    lsr a
    lsr a
    and #$38
    ora $03
    ora #$C0
    sta $02
    lda #$63
    sta $03
    ldx #$00
    bit $00
    bvc L9324
        ldx #$02
    L9324:
    lda $00
    and #$02
    beq L932B
        inx
    L932B:
    lda $01
    and #$04
    ora $03
    sta $03
    lda AttribMaskTable,x
    ldy #$00
    and ($02),y
    sta ($02),y
    lda $61
    L933E:
        dex
        bmi L9345
        asl a
        asl a
        bcc L933E
L9345:
    ora ($02),y
    sta ($02),y
RTS_9349:
    rts

AttribMaskTable: ;($934A)
    .byte %11111100                 ;Upper left macro.
    .byte %11110011                 ;Upper right macro.
    .byte %11001111                 ;Lower left macro.
    .byte %00111111                 ;Lower right macro.



InitTables: ;($934E)
    lda $34
    tay
    tax
    iny
    iny
    iny
    lda #$FF
    jsr FDSBIOS_MemFill
    ldx $01
    jsr L84FE
    stx $01
    ldx $62
    lda ATDataTable,x
    ldy #$C0
    L9368:
        sta ($00),y
        iny
        bne L9368
    rts

ATDataTable: ;($936E)
    .byte %00000000
    .byte %01010101
    .byte %10101010
    .byte %11111111



MAIN_RandomNumbers: ;($9372)
    ldx #$28
    ldy #$02
    jsr FDSBIOS_Random
    lda RandomNumber1
    rts



MainLoop: ;($937C)
    jsr MAIN_UpdateTimer
    jsr L93C8
    inc FrameCount
    lda #$00
    sta $1A
WaitNMIEnd: ;($9388)
        tay
        lda $1A
        bne L9390
        jmp WaitNMIEnd
L9390:
    jsr MAIN_RandomNumbers
    jmp MainLoop


MAIN_NMI: ;($9396)
    cli
    php
    pha
    txa
    pha
    tya
    pha
    lda #$00
    sta OAMADDR
    lda #$02
    sta OAMDMA
    lda NMIStatus
    bne L93BA
        jsr CheckPalWrite
        jsr MAIN_CheckPPUWrite
        jsr METHEX_WritePPUCtrl
        jsr MAIN_WriteScroll
        jsr METHEX_ReadJoyPads
    L93BA:
    jsr GotoLD18C
    ldy #$01
    sty NMIStatus
    pla
    tay
    pla
    tax
    pla
    plp
    rti



L93C8:
    lda Joy1Change
    and #BUTTON_START
    beq L93E9
    
    lda MainRoutine
    cmp #$03
    beq L93DC
        cmp #$05
        bne L93E9
        lda #$03
        bne L93DE
    L93DC:
        lda #$05
    L93DE:
    sta MainRoutine
    lda GamePaused
    eor #$01
    sta GamePaused
    jsr PauseMusic
L93E9:
    lda MainRoutine
    jsr MAIN_ChooseRoutine
        .word LC082
        .word MoreInit
        .word SamusInit
        .word GameEngine
        .word PrepareGameOver
        .word PauseMode
        .word PrepareContinueScreen
        .word PrepareSwitchDiskSide
        .word SamusIntro
        .word WaitTimer



CheckPalWrite: ;($9402)
    ldy PalDataPending
    bne L9407
        rts
    L9407:
    dey
    tya
    asl a
    tay
    ldx $B560,y
    lda $B561,y
    tay
    lda #$00
    sta $1C
MAIN_PreparePPUProcess:
    stx $00
    sty $01
    jmp MAIN_ProcessPPUString



MAIN_ClearNameTables: ;($941D)
    lda #>$2400
    ldx #$FC
    ldy #$00
    jsr FDSBIOS_VRAMFill
    ldx #$FC
    bne L942C
ClearNameTable: ;($942A)
    ldx $00
L942C:
    lda #>$2000
    ldy #$00
    jmp FDSBIOS_VRAMFill



MAIN_UpdateTimer: ;($9433)
    ; Default to only decrementing Timer2 and Timer1.
    ldx #$01
    ; branch if timer delay is not zero
    dec TimerDelay
    bpl @endIf_A
        ;TimerDelay hits #$00 every 10th frame.
        ;Reset TimerDelay after it hits #$00.
        lda #$09
        sta TimerDelay
        ;Decrement Timer3 every 10 frames.
        ldx #$02
    @endIf_A:
    
    ; decrement the chosen timers
    @loop_decTimer:
        ;Don't decrease if timer is already zero.
        lda Timer1,x
        beq @endIf_B
            dec Timer1,x
        @endIf_B:
        dex
        bpl @loop_decTimer
    rts



MAIN_ChooseRoutine: ;($9449)
    asl a
    sty $64
    stx $63
    tay
    iny
    pla
    sta CodePtr
    pla
    sta CodePtr+1.b
    lda (CodePtr),y
    tax
    iny
    lda (CodePtr),y
    sta CodePtr+1.b
    stx CodePtr
    ldx $63
    ldy $64
    jmp ($000C)



MAIN_AddYToPtr00: ;($9467)
    tya
    clc
    adc $00
    sta $00
    bcc RTS_9471
        inc $01
    RTS_9471:
    rts



MAIN_Adiv32: ;($9472)
    lsr a
MAIN_Adiv16: ;($9473)
    lsr a
MAIN_Adiv8: ;($9474)
    lsr a
    lsr a
    lsr a
    rts



MAIN_Amul32: ;($9478)
    asl a
MAIN_Amul16: ;($9479)
    asl a
MAIN_Amul8: ;($947A)
    asl a
    asl a
    asl a
    rts



MAIN_CheckPPUWrite: ;($947E)
    lda PPUDataPending
    beq RTS_9493
    ldx #<PPUDataString.b
    ldy #>PPUDataString.b
    jsr MAIN_PreparePPUProcess
    lda #$00
    sta PPUStrIndex
    sta PPUDataString
    sta PPUDataPending
RTS_9493:
    rts



MAIN_PPUWrite: ;($9494)
    sta PPUADDR
    iny
    lda ($00),y
    sta PPUADDR
    iny
    lda ($00),y
    asl a
    jsr L94D3
    asl a
    lda ($00),y
    and #$3F
    tax
    bcc L94AD
    iny
L94AD:
    bcs L94B0
    iny
L94B0:
    lda ($00),y
    sta PPUDATA
    dex
    bne L94AD
    iny
    jsr MAIN_AddYToPtr00



MAIN_ProcessPPUString: ;($94BC)
    ldx PPUSTATUS
    ldy #$00
    lda ($00),y
    bne MAIN_PPUWrite



MAIN_WriteScroll: ;($94C5)
    lda PPUSTATUS
    lda ScrollX
    sta PPUSCROLL
    lda ScrollY
    sta PPUSCROLL
    rts



L94D3:
    pha
    lda $FF
    ora #$04
    bcs L94DC
    and #$FB
L94DC:
    sta PPUCTRL
    sta $FF
    pla
    rts
L94E3:
    ldy #$01
    sty $1B
    dey
    lda ($02),y
    and #$0F
    sta $05
    lda ($02),y
    jsr MAIN_Adiv16
    sta $04
    ldx $07A0
L94F8:
    lda $01
    jsr L9526
    lda $00
    jsr L9526
    lda $05
    sta $06
    jsr L9526
L9509:
    iny
    lda ($02),y
    jsr L9526
    dec $06
    bne L9509
    stx $07A0
    sty $06
    ldy #$20
    jsr MAIN_AddYToPtr00
    ldy $06
    dec $04
    bne L94F8
    jsr L9531
L9526:
    sta $07A1,x
L9529:
    inx
    cpx #$4F
    bcc RTS_9538
    ldx $07A0
L9531:
    lda #$00
    sta $07A1,x
    pla
    pla
RTS_9538:
    rts
L9539:
    sta $04
    and #$BF
    sta $07A1,x
    and #$3F
    sta $05
    jmp L9529



MAIN_Base10Add: ;($9547)
    jsr MAIN_ExtractNibbles
    adc $01
    cmp #$0A
    bcc L9552
        adc #$05
    L9552:
    clc
    adc $02
    sta $02
    lda $03
    and #$F0
    adc $02
    bcc L9563
L955F:
    adc #$5F
    sec
    rts
L9563:
    cmp #$A0
    bcs L955F
    rts



MAIN_Base10Subtract: ;($9568)
    jsr MAIN_ExtractNibbles
    sbc $01
    sta $01
    bcs L957B
        adc #$0A
        sta $01
        lda $02
        adc #$0F
        sta $02
    L957B:
    lda $03
    and #$F0
    sec
    sbc $02
    bcs L9587
        adc #$A0
        clc
    L9587:
    ora $01
    rts



MAIN_ExtractNibbles: ;($958A)
    pha
    and #$0F
    sta $01
    pla
    and #$F0
    sta $02
    lda $03
    and #$0F
    rts



MAIN_WaitNMIPass: ;($9599)
    jsr MAIN_ClearNMIStat
    @loop:
        lda NMIStatus
        beq @loop
    rts



MAIN_ClearNMIStat: ;($95A1)
    lda #$00
    sta NMIStatus
    rts



WaitTimer: ;($95A6)
    lda Timer3
    bne RTS_95BB
    lda NextRoutine
    cmp #$04
    beq SetMainRoutine
    cmp #$06
    beq SetMainRoutine
    jsr L7CAA
    lda NextRoutine
SetMainRoutine: ;($95B9)
    sta MainRoutine
RTS_95BB:
    rts



SetTimer: ;($95BC)
    sta Timer3
    stx NextRoutine
    lda #$09
    bne SetMainRoutine ; branch always



L95C4:
    .byte $03, $04, $05, $FF, $07, $FF, $17, $08, $FF, $22, $FF, $04, $10, $FF, $17, $18
    .byte $19, $1A, $FF, $03, $17, $FF, $1E, $1D, $1C, $1B, $FF, $28, $FF, $2A, $F7, $FF
    .byte $12, $FF, $0C, $0D, $0E, $FF, $30, $2B, $FF, $31, $31, $33, $F7, $FF, $33, $33
    .byte $31, $FF, $35, $FF, $39, $38, $FF, $40, $41, $42, $FF, $46, $FF, $47, $FF, $48
    .byte $FF, $07, $F7, $F7, $07, $F7, $F7, $F7, $07, $F7, $F7, $F7, $F7, $07, $F7, $FF
    .byte $23, $F7, $F7, $23, $F7, $F7, $F7, $23, $F7, $F7, $F7, $F7, $23, $F7, $FF, $07
    .byte $F7, $F7, $F7, $F7, $07, $F7, $F7, $F7, $07, $F7, $F7, $07, $F7, $FF, $23, $F7
    .byte $F7, $F7, $F7, $23, $F7, $F7, $F7, $23, $F7, $F7, $23, $F7, $FF, $4B, $FF, $4E
    .byte $4F, $FF, $3C, $4A, $49, $4A, $4D, $4A, $4D, $F7, $FF, $26, $FF, $25, $FF, $27
    .byte $FF, $67, $67, $67, $68, $68, $69, $F7, $FF, $1D, $98, $1D, $98, $1D, $98, $1D
    .byte $98, $2F, $98, $42, $98, $54, $98, $54, $98, $6A, $98, $7E, $98, $7E, $98, $7E
    .byte $98, $7E, $98, $90, $98, $A3, $98, $B5, $98, $B5, $98, $C6, $98, $C6, $98, $D7
    .byte $98, $D7, $98, $D7, $98, $D7, $98, $D7, $98, $E1, $98, $EB, $98, $F5, $98, $FF
    .byte $98, $0A, $99, $15, $99, $20, $99, $2B, $99, $2B, $99, $2B, $99, $2B, $99, $40
    .byte $99, $4A, $99, $4A, $99, $50, $99, $56, $99, $5C, $99, $61, $99, $61, $99, $66
    .byte $99, $7A, $99, $7A, $99, $7A, $99, $7A, $99, $7A, $99, $8E, $99, $9A, $99, $9A
    .byte $99, $A6, $99, $A6, $99, $B3, $99, $B3, $99, $B3, $99, $C6, $99, $D9, $99, $D9
    .byte $99, $D9, $99, $E7, $99, $E7, $99, $E7, $99, $E7, $99, $FB, $99, $10, $9A, $24
    .byte $9A, $24, $9A, $24, $9A, $24, $9A, $38, $9A, $4D, $9A, $61, $9A, $6F, $9A, $73
    .byte $9A, $78, $9A, $78, $9A, $8E, $9A, $93, $9A, $98, $9A, $A0, $9A, $A8, $9A, $B0
    .byte $9A, $B8, $9A, $C0, $9A, $C8, $9A, $D0, $9A, $D8, $9A, $E0, $9A, $EE, $9A, $F3
    .byte $9A, $F8, $9A, $00, $9B, $0C, $9B, $16, $9B, $16, $9B, $16, $9B, $16, $9B, $16
    .byte $9B, $16, $9B, $16, $9B, $2A, $9B, $3B, $9B, $45, $9B, $55, $9B, $53, $97, $71
    .byte $97, $7D, $97, $89, $97, $99, $97, $A3, $97, $4F, $97, $AF, $97, $C7, $97, $DF
    .byte $97, $E3, $97, $EB, $97, $F7, $97, $9B, $97, $03, $98, $E8, $FC, $EA, $FC, $F0
    .byte $F8, $F0, $00, $F8, $F0, $F8, $F8, $F8, $00, $00, $F8, $00, $00, $00, $08, $08
    .byte $F8, $08, $00, $08, $08, $F8, $F4, $F8, $F6, $EC, $F4, $EE, $F4, $F3, $F8, $F3
    .byte $00, $FB, $F8, $FB, $00, $03, $F8, $03, $00, $F8, $F6, $F8, $FE, $F8, $06, $00
    .byte $F6, $00, $FE, $00, $06, $FC, $F0, $FC, $F8, $FC, $00, $FC, $08, $FC, $10, $FC
    .byte $18, $FC, $20, $FC, $28, $FC, $FC, $F8, $F8, $F8, $00, $00, $F8, $00, $00, $E8
    .byte $00, $F0, $00, $F8, $00, $00, $00, $08, $00, $10, $00, $80, $80, $81, $81, $82
    .byte $82, $83, $83, $84, $84, $85, $85, $F4, $F8, $F4, $00, $FC, $F8, $FC, $00, $04
    .byte $F8, $04, $00, $F0, $00, $F0, $08, $F8, $08, $F0, $F0, $F0, $F8, $F8, $F0, $00
    .byte $F0, $08, $F0, $08, $F8, $00, $08, $08, $00, $08, $08, $F8, $FC, $00, $FC, $FC
    .byte $F8, $FC, $00, $FC, $10, $FC, $18, $FC, $F0, $F4, $F8, $F4, $00, $FC, $08, $04
    .byte $F8, $04, $00, $FC, $E8, $EC, $F0, $EC, $08, $FC, $10, $0C, $F0, $0C, $08, $00
    .byte $F8, $00, $00, $08, $F8, $08, $00, $E8, $F0, $E8, $F8, $E8, $00, $F0, $F0, $F0
    .byte $F8, $F0, $00, $F8, $F0, $F8, $F8, $F8, $00, $40, $0F, $04, $00, $01, $FD, $20
    .byte $FE, $41, $40, $FD, $60, $20, $21, $FE, $FE, $31, $FF, $40, $0F, $04, $02, $03
    .byte $FD, $20, $FE, $43, $42, $FD, $60, $22, $23, $FE, $32, $33, $34, $FF, $40, $0F
    .byte $04, $05, $06, $FD, $20, $FE, $45, $44, $FD, $60, $25, $26, $27, $35, $36, $FF
    .byte $00, $0F, $04, $09, $FD, $60, $09, $FD, $20, $FE, $19, $1A, $FD, $20, $29, $2A
    .byte $FE, $39, $FD, $60, $39, $FF, $40, $0F, $04, $FD, $20, $0E, $0D, $FE, $1E, $1D
    .byte $2E, $2D, $FE, $FD, $60, $3B, $3C, $FE, $17, $FF, $40, $0F, $04, $00, $01, $FD
    .byte $20, $4B, $4A, $49, $FD, $60, $20, $21, $FE, $FE, $31, $FF, $40, $0F, $04, $00
    .byte $01, $FD, $20, $4B, $4A, $49, $FD, $60, $22, $23, $FE, $32, $33, $34, $FF, $40
    .byte $0F, $04, $00, $01, $FD, $20, $4B, $4A, $49, $FD, $60, $25, $26, $27, $35, $36
    .byte $FF, $40, $0F, $04, $00, $01, $FD, $20, $FE, $41, $40, $FD, $60, $22, $07, $08
    .byte $32, $FF, $40, $0F, $04, $00, $01, $FD, $20, $4B, $4A, $49, $FD, $60, $22, $07
    .byte $08, $32, $FF, $41, $0F, $04, $52, $53, $62, $63, $72, $73, $FF, $42, $0F, $04
    .byte $54, $55, $56, $64, $65, $66, $FF, $81, $0F, $04, $52, $53, $62, $63, $72, $73
    .byte $FF, $82, $0F, $04, $54, $55, $56, $64, $65, $66, $FF, $01, $08, $04, $FC, $03
    .byte $00, $50, $51, $60, $61, $FF, $81, $08, $04, $FC, $FD, $00, $50, $51, $60, $61
    .byte $FF, $C1, $08, $04, $FC, $FD, $00, $50, $51, $60, $61, $FF, $41, $08, $04, $FC
    .byte $03, $00, $50, $51, $60, $61, $FF, $40, $0F, $04, $FD, $20, $0E, $0D, $FE, $1E
    .byte $1D, $2E, $2D, $FE, $FD, $60, $3B, $3C, $FE, $FE, $17, $FF, $03, $04, $10, $28
    .byte $38, $38, $FD, $60, $28, $FF, $4A, $04, $08, $5E, $5F, $FF, $0A, $04, $08, $5E
    .byte $5F, $FF, $09, $08, $04, $14, $24, $FF, $04, $02, $02, $30, $FF, $04, $00, $00
    .byte $04, $FF, $46, $0F, $04, $69, $FE, $FD, $20, $7A, $79, $FE, $78, $77, $2E, $2D
    .byte $FE, $FD, $60, $3B, $3C, $FF, $46, $0F, $04, $FE, $69, $FD, $20, $7A, $79, $FE
    .byte $78, $77, $2E, $2D, $FE, $FD, $60, $3B, $3C, $FF, $35, $18, $08, $0F, $1F, $2F
    .byte $FD, $A3, $2F, $1F, $0F, $FF, $35, $18, $04, $6A, $6B, $6C, $FD, $A3, $6C, $6B
    .byte $6A, $FF, $07, $00, $00, $FC, $FC, $00, $7B, $7C, $8B, $8C, $7D, $8D, $FF, $46
    .byte $0F, $04, $69, $FD, $20, $FE, $7A, $79, $FE, $78, $77, $FD, $60, $22, $07, $08
    .byte $32, $FF, $46, $0F, $04, $FE, $69, $FD, $20, $7A, $79, $FE, $78, $77, $FD, $60
    .byte $22, $07, $08, $32, $FF, $0D, $0C, $0C, $74, $FD, $60, $74, $FD, $A0, $74, $FD
    .byte $E0, $74, $FF, $46, $0F, $04, $69, $FE, $FD, $20, $7A, $79, $FE, $78, $77, $FD
    .byte $60, $20, $21, $FE, $FE, $31, $FF, $46, $0F, $04, $69, $FE, $FD, $20, $7A, $79
    .byte $FE, $78, $77, $FD, $60, $22, $23, $FE, $32, $33, $34, $FF, $46, $0F, $04, $69
    .byte $FE, $FD, $20, $7A, $79, $FE, $78, $77, $FD, $60, $25, $26, $27, $35, $36, $FF
    .byte $46, $0F, $04, $FE, $69, $FD, $20, $7A, $79, $FE, $78, $77, $FD, $60, $20, $21
    .byte $FE, $FE, $31, $FF, $46, $0F, $04, $FE, $69, $FD, $20, $7A, $79, $FE, $78, $77
    .byte $FD, $60, $22, $23, $FE, $32, $33, $34, $FF, $46, $0F, $04, $FE, $69, $FD, $20
    .byte $7A, $79, $FE, $78, $77, $FD, $60, $25, $26, $27, $35, $36, $FF, $0D, $0C, $0C
    .byte $75, $FD, $60, $75, $FD, $A0, $75, $FD, $E0, $75, $FF, $00, $00, $00, $FF, $04
    .byte $04, $04, $4C, $FF, $08, $10, $10, $3D, $3E, $4E, $FD, $60, $3E, $3D, $4E, $FD
    .byte $E0, $4E, $3E, $3D, $FD, $A0, $4E, $3D, $3E, $FF, $04, $04, $04, $70, $FF, $04
    .byte $04, $04, $71, $FF, $0D, $03, $03, $96, $97, $A6, $A7, $FF, $0D, $03, $03, $9B
    .byte $9C, $AB, $AC, $FF, $0D, $03, $03, $98, $9A, $A8, $A9, $FF, $0D, $03, $03, $90
    .byte $91, $A0, $A1, $FF, $0D, $03, $03, $9D, $9E, $AD, $AE, $FF, $0D, $03, $03, $92
    .byte $93, $A2, $A3, $FF, $0D, $03, $03, $98, $99, $A8, $A9, $FF, $0D, $03, $03, $98
    .byte $AA, $A8, $A9, $FF, $0D, $03, $03, $94, $95, $A4, $A5, $FF, $0D, $03, $03, $9F
    .byte $FD, $40, $9F, $FD, $00, $AF, $FD, $40, $AF, $FF, $34, $04, $04, $F2, $FF, $04
    .byte $00, $00, $BF, $FF, $13, $00, $00, $B0, $B1, $B2, $B3, $FF, $13, $00, $00, $B4
    .byte $B5, $B6, $B7, $B8, $B6, $B9, $B3, $FF, $13, $00, $00, $B3, $BA, $BA, $FE, $80
    .byte $80, $FF, $1E, $00, $08, $FA, $FB, $FA, $FB, $FC, $00, $04, $C5, $C6, $C7, $D5
    .byte $D6, $D7, $E5, $E6, $E7, $FF, $1E, $00, $08, $FA, $FB, $FA, $FB, $FE, $C8, $C9
    .byte $EB, $D8, $D9, $EA, $E8, $E9, $FF, $0A, $04, $08, $FD, $00, $57, $FD, $40, $57
    .byte $FF, $0B, $04, $0C, $FD, $00, $57, $18, $FD, $40, $18, $57, $FD, $C0, $18, $18
    .byte $FF, $0C, $04, $10, $FD, $00, $57, $18, $FD, $40, $18, $57, $FD, $C0, $18, $18
    .byte $FF



L9B65:
    lda $50
    bne RTS_9BBE
    ldy $52
    beq RTS_9BBE
    sta $90
    sta $91
    lda RandomNumber1
    and #$0F
    sta $8E
    asl a
    ora #$40
    sta $8F
    lda $FF
    eor #$01
    and #$01
    tay
    lsr a
    sta $0066,y
    lda $43
    and #$02
    bne L9B9D
    ldx #$04
    lda $FC
    beq L9BBF
    lda $FF
    eor ObjHi
    lsr a
    bcc L9BA5
    bcs L9BA4
L9B9D:
    ldx #$02
    lda ObjX
    bpl L9BA5
L9BA4:
    dex
L9BA5:
    txa
    sta $51
    jsr L9BC6
    lda #$12
    sta $53
    lda $52
    jsr MAIN_Amul16
    ora ObjAction
    sta $52
    lda #$05
    sta ObjAction
RTS_9BBE:
    rts
L9BBF:
    jsr L9BA5
    jsr VerticalRoomCentered
    txa
L9BC6:
    ora #$80
    sta $50
    rts
L9BCB:
    ldx #$B0
L9BCD:
    jsr L9BD9
    lda $45
    sec
L9BD3:
    sbc #$10
    tax
    bmi L9BCD
    rts
L9BD9:
    stx $45
    lda ObjAction,x
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word L9BEF
        .word L9C27
        .word L9C53
        .word L9CD6
        .word L9D18
        .word L9D42



L9BEF:
    inc ObjAction,x
    lda #$30
    jsr L7692
    jsr L9D4D
    ldy SamusOnElevator,x
    lda L9C23,y
    sta SamusJumpDsplcmnt,x
L9C03:
    lda SamusOnElevator,x
    cmp #$03
    bne L9C0C
    lda #$01
L9C0C:
    ora #$A0
    sta $65
    lda #$00
    sta SamusIsHit,x
    txa
    and #$10
    eor #$10
    ora $65
    sta $65
    lda #$06
    jmp L81C3
L9C23:
    .byte $05, $01, $0A, $01



L9C27:
    lda SamusIsHit,x
    and #$04
    beq L9C03
    dec SamusJumpDsplcmnt,x
    bne L9C03
    lda #$03
    cmp SamusOnElevator,x
    bne L9C40
    ldy EndTimer+1
    iny
    bne L9C03
L9C40:
    sta ObjAction,x
    lda #$50
    sta SamusJumpDsplcmnt,x
    lda #$2C
    sta ObjAnimResetIndex,x
    sec
    sbc #$03
    jmp L9CD0



L9C53:
    lda $50
    beq L9C6F
    lda ObjHi
    eor ObjHi,x
    lsr a
    bcs L9C6F
    lda ObjX
    eor ObjX,x
    bmi L9C6F
    lda #$04
    sta ObjAction,x
    bne L9CC5
L9C6F:
    lda ObjAnimIndex,x
    cmp ObjAnimResetIndex,x
    bcc L9CC5
    lda SamusJumpDsplcmnt,x
    cmp #$50
    bne L9CA9
    jsr L9D49
    lda SamusOnElevator,x
    cmp #$01
    beq L9CA9
    cmp #$03
    beq L9CA9
    lda #$0A
    sta $09
    lda ObjHi,x
    sta $08
    ldy $4A
    txa
    jsr MAIN_Amul16
    bcc L9C9E
    dey
L9C9E:
    tya
    jsr L7F94
    lda #$00
    sta ObjAction,x
    beq L9CC5
L9CA9:
    lda FrameCount
    lsr a
    bcs L9CC5
    dec SamusJumpDsplcmnt,x
    bne L9CC5
L9CB3:
    lda #$01
    sta SamusJumpDsplcmnt,x
    jsr L9D4D
    lda #$02
    sta ObjAction,x
    jsr L9CC8
L9CC3:
    ldx $45
L9CC5:
    jmp L9C03
L9CC8:
    lda #$30
    sta ObjAnimResetIndex,x
    sec
    sbc #$02
L9CD0:
    jsr L7695
    jmp L6F9A



L9CD6:
    lda $50
    cmp #$05
    bcs L9D15
    jsr L9D4D
    jsr L9CC8
    ldx $45
    lda $8C
    beq L9CF9
    txa
    jsr MAIN_Adiv16
    eor $8C
    lsr a
    bcc L9CF9
    lda $70
    eor #$07
    sta $70
    sta $1C
L9CF9:
    inc ObjAction,x
    lda #$00
    sta $8C
    lda SamusOnElevator,x
    cmp #$03
    bne L9D15
    txa
    jsr MAIN_Amul16
    bcs L9D12
    jsr L6FBB
    bne L9D15
L9D12:
    jsr L6FB7
L9D15:
    jmp L9CC3



L9D18:
    lda $50
    cmp #$05
    bne L9D3F
    txa
    eor #$10
    tax
    lda #$06
    sta ObjAction,x
    lda #$2C
    sta ObjAnimResetIndex,x
    sec
    sbc #$03
    jsr L7695
    jsr L6F9A
    jsr SelectSamusPal
    ldx $45
    lda #$02
    sta ObjAction,x
L9D3F:
    jmp L9C03



L9D42:
    lda $50
    bne L9D3F
    jmp L9CB3



L9D49:
    lda #$FF
    bne L9D4F
L9D4D:
    lda #$4E
L9D4F:
    pha
    lda #$50
    sta $02
    txa
    jsr MAIN_Adiv16
    and #$01
    tay
    lda L9D8C,y
    sta $03
    lda ObjHi,x
    sta $0B
    jsr L8CBF
    ldy #$00
    pla
L9D6B:
    sta ($04),y
    tax
    tya
    clc
    adc #$20
    tay
    txa
    cpy #$C0
    bne L9D6B
    ldx $45
    txa
    jsr MAIN_Adiv8
    and #$06
    tay
    lda $04
    sta $0056,y
    lda $05
    sta $0057,y
RTS_9D8B:
    rts

L9D8C:
    .byte $E8, $10



L9D8E:
    ldx #$C0
    L9D90:
        jsr L9D9A
        ldx $45
        jsr LA0E1
        bne L9D90

L9D9A:
    stx $45
    lda $0500,x
    beq RTS_9D8B
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word L9DB0
        .word L9DC7
        .word L9DCC
        .word L9DC7
        .word L9DF6


L9DB0:
    inc $0500,x
    lda #$00
    jsr L9DE0
    lda #$50
    sta $0507,x
    lda $0508,x
    sta $00
    lda $0509,x
    sta $01
L9DC7:
    lda #$02
    jmp L9EC7




L9DCC:
    lda FrameCount
    and #$03
    bne RTS_9DEB
    dec $0507,x
    bne RTS_9DEB
    inc $0500,x
    ldy $050A,x
    lda L9DEC,y
L9DE0:
    sta $0506,x
    sta $0505,x
    lda #$00
    sta $0504,x
RTS_9DEB:
    rts

L9DEC:
    .byte $18, $1C, $20, $00, $04, $08, $0C, $10, $24, $14



L9DF6:
    lda #$00
    sta $0500,x
    lda $0508,x
    clc
    adc #$21
    sta $00
    lda $0509,x
    sta $01
    jsr L9EAF
    lda $02
    sta $07
    lda $03
    sta $09
    lda $01
    lsr a
    lsr a
    and #$01
L9E19:
    sta $0B
    ldy #$00
    jsr LA073
    lda #$04
    clc
    adc ObjRadY
    sta $04
    lda #$04
    clc
    adc ObjRadX
    sta $05
    jsr LA0E7
    bcs RTS_9E4E
    jsr LA1FE
    lda #$50
    sta $68
    jmp SubtractHealth



L9E3F:
    lda $0503,x
    asl a
    tay
    lda $B7A7,y
    sta $02
    lda $B7A8,y
    sta $03
RTS_9E4E:
    rts



L9E4F:
    lda $07A0
    cmp #$1F
    bcs RTS_9E4E
    ldx $45
    lda $0508,x
    sta $00
    lda $0509,x
    sta $01
    jsr L9E3F
    ldy #$00
    sty $11
    lda ($02),y
    tax
    jsr MAIN_Adiv16
    sta $04
    txa
    and #$0F
    sta $05
    iny
    sty $10
L9E79:
    ldx $05
L9E7B:
    ldy $10
    lda ($02),y
    inc $10
    ldy $11
    sta ($00),y
    inc $11
    dex
    bne L9E7B
    lda $11
    clc
    adc #$20
    sec
    sbc $05
    sta $11
    dec $04
    bne L9E79
    lda $01
    and #$04
    beq L9EA4
    lda $01
    ora #$0C
    sta $01
L9EA4:
    lda $01
    and #$2F
    sta $01
    jsr L94E3
    clc
    rts



L9EAF:
    lda $00
    tay
    and #$E0
    sta $02
    lda $01
    lsr a
    ror $02
    lsr a
    ror $02
    tya
    and #$1F
    jsr MAIN_Amul8
    sta $03
    rts



L9EC7:
    ldx $45
    ldy $0504,x
    beq L9ED3
    dec $0504,x
    bne RTS_9EF2
L9ED3:
    sta $0504,x
    ldy $0506,x
    lda L9EF9,y
    cmp #$FE
    beq L9EF3
    sta $0503,x
    iny
    tya
    sta $0506,x
    jsr L9E4F
    bcc RTS_9EF2
    ldx $45
    dec $0506,x
RTS_9EF2:
    rts
L9EF3:
    inc $0500,x
    pla
    pla
    rts



L9EF9:
    .byte $06, $07, $00, $FE
    .byte $07, $06, $01, $FE
    .byte $07, $06, $02, $FE
    .byte $07, $06, $03, $FE
    .byte $07, $06, $04, $FE
    .byte $07, $06, $05, $FE
    .byte $07, $06, $09, $FE
    .byte $07, $06, $0A, $FE
    .byte $07, $06, $0B, $FE
    .byte $07, $06, $08, $FE

L9F21:
    lda #$FF
    sta $6D
    sta $010F
    ldx #$18
L9F2A:
    lda $B0,x
    beq L9F68
    cmp #$03
    beq L9F68
    jsr LA087
    jsr IsSamusDead
    beq L9F46
    lda $6A
    bne L9F46
    ldy #$00
    jsr LA036
    jsr LA1A1
L9F46:
    ldy #$D0
L9F48:
    lda ObjAction,y
    beq L9F63
    cmp #$04
    bcc L9F5D
    cmp #$07
    beq L9F5D
    cmp #$0A
    beq L9F5D
    cmp #$0B
    bne L9F63
L9F5D:
    jsr LA036
    jsr LA217
L9F63:
    jsr LA0DB
    bne L9F48
L9F68:
    txa
    sec
    sbc #$08
    tax
    bpl L9F2A
    ldx #$B0
L9F71:
    lda ObjAction,x
    cmp #$02
    bne L9F85
    ldy #$00
    jsr IsSamusDead
    beq L9F8A
    jsr L7FF5
    jsr LA164
L9F85:
    jsr LA0E1
    bmi L9F71
L9F8A:
    ldx #$50
L9F8C:
    lda $B460,x
    beq L9F93
    cmp #$03
L9F93:
    beq L9FD2
    jsr LA03F
    lda $B460,x
    cmp #$05
    beq L9FC1
    ldy #$D0
L9FA1:
    lda ObjAction,y
    beq L9FBC
    cmp #$04
    bcc L9FB6
    cmp #$07
    beq L9FB6
    cmp #$0A
    beq L9FB6
    cmp #$0B
    bne L9FBC
L9FB6:
    jsr LA02D
    jsr LA1B7
L9FBC:
    jsr LA0DB
    bne L9FA1
L9FC1:
    ldy #$00
    lda $6A
    bne L9FD2
    jsr IsSamusDead
    beq L9FD2
    jsr LA02D
    jsr LA16F
L9FD2:
    jsr LA0E1
    bmi L9FDA
    jmp L9F8C
L9FDA:
    ldx #$00
    jsr LA05F
    ldy #$60
L9FE1:
    lda $B460,y
    beq L9FFF
    cmp #$05
    beq L9FFF
    lda $6A
    bne L9FFF
    jsr IsSamusDead
    beq L9FFF
    jsr LA0A0
    jsr LA04F
    jsr LA0E7
    jsr LA1DA
L9FFF:
    jsr LA0DB
    cmp #$C0
    bne L9FE1
    ldy #$00
    jsr IsSamusDead
    beq LA02A
    jsr LA073
    ldx #$F0
LA012:
    lda ObjAction,x
    cmp #$07
    beq LA01D
        cmp #$0A
        bne LA023
    LA01D:
    jsr L7FF8
    jsr LA1FE
LA023:
    jsr LA0E1
    cmp #$C0
    bne LA012
LA02A:
    jmp SubtractHealth



LA02D:
    jsr LA0AC
    jsr LA073
    jmp LA0E7



LA036:
    jsr LA073
    jsr LA0BF
    jmp LA0E7



LA03F:
    lda $0400,x
    sta $07
    lda $0401,x
    sta $09
    lda $B467,x
    jmp LA06C



LA04F:
    lda $0400,y
    sta $06
    lda $0401,y
    sta $08
    lda $B467,y
    jmp LA080



LA05F:
    lda ObjY,x
    sta $07
    lda ObjX,x
    sta $09
    lda ObjHi,x

LA06C:
    eor $FF
    and #$01
    sta $0B
    rts



LA073:
    lda ObjY,y
    sta $06
    lda ObjX,y
    sta $08
    lda ObjHi,y

LA080:
    eor $FF
    and #$01
    sta $0A
    rts



LA087:
    lda $B1,x
    sta $07
    lda $B2,x
    sta $09
    lda $B3,x
    jmp LA06C



LA094:
    lda ObjRadY,x
    jsr LA0CD
    lda ObjRadX,x
    jmp LA0C6



LA0A0:
    lda ObjRadY,x
    jsr LA0D4
    lda ObjRadX,x
    jmp LA0B8



LA0AC:
    lda $B461,x
    jsr LA0CD
    lda $B462,x
    jmp LA0C6



LA0B8:
    clc
    adc $B462,y
    sta $05
    rts



LA0BF:
    lda #$04
    jsr LA0CD
    lda #$08

LA0C6:
    clc
    adc ObjRadX,y
    sta $05
    rts



LA0CD:
    clc
    adc ObjRadY,y
    sta $04
    rts



LA0D4:
    clc
    adc $B461,y
    sta $04
    rts



LA0DB:
    tya
    clc
    adc #$10
    tay
    rts



LA0E1:
    txa
    sec
    sbc #$10
    tax
    rts



LA0E7:
    lda #$02
    sta $10
    and $43
    sta $03
    lda $07
    sec
    sbc $06
    sta $00
    lda $03
    bne LA111
    lda $0B
    eor $0A
    beq LA111
    jsr LA14F
    lda $00
    sec
    sbc #$10
    sta $00
    bcs LA10E
    dec $01
LA10E:
    jmp LA118
LA111:
    lda #$00
    sbc #$00
    jsr LA153
LA118:
    sec
    lda $01
    bne RTS_A14E
    lda $00
    sta $11
    cmp $04
    bcs RTS_A14E
    asl $10
    lda $09
    sec
    sbc $08
    sta $00
    lda $03
    beq LA13E
    lda $0B
    eor $0A
    beq LA13E
    jsr LA14F
    jmp LA143
LA13E:
    sbc #$00
    jsr LA153
LA143:
    sec
    lda $01
    bne RTS_A14E
        lda $00
        sta $0F
        cmp $05
    RTS_A14E:
    rts



LA14F:
    lda $0B
    sbc $0A
LA153:
    sta $01
    bpl RTS_A15C
        jsr NegateTemp00Temp01
        inc $10
    RTS_A15C:
    rts



LA15D:
    ora SamusIsHit,x
    sta SamusIsHit,x
    rts



LA164:
    bcs RTS_A16E
LA166:
    lda $10
LA168:
    ora SamusIsHit,y
    sta SamusIsHit,y
RTS_A16E:
    rts



LA16F:
    bcs RTS_A16E
    jsr LA1D5
    jsr L7150
    ldy #$00
    bcc LA19A
    lda $B460,x
    cmp #$04
    bcs RTS_A16E
    lda $B46E,x
LA185:
    sta $010F
    tay
    bmi LA192
    lda $B683,y
    and #$10
    bne RTS_A16E
LA192:
    ldy #$00
    jsr LA225
    jmp LA1F3
LA19A:
    lda #$81
    sta $040E,x
    bne LA1C2
LA1A1:
    bcs RTS_A1B6
    jsr L7150
    ldy #$00
    lda #$C0
    bcs LA185
LA1AC:
    lda $B6,x
    and #$F8
    ora $10
    eor #$03
    sta $B6,x
RTS_A1B6:
    rts
LA1B7:
    bcs RTS_A1CB
    lda ObjAction,y
    sta $040E,x
    jsr LA166
LA1C2:
    jsr LA21F
LA1C5:
    ora $0404,x
    sta $0404,x
RTS_A1CB:
    rts
LA1CC:
    lda $10
    ora $0404,y
    sta $0404,y
    rts
LA1D5:
    jsr LA22D
    bne LA1C5
LA1DA:
    bcs RTS_A1FD
    jsr LA1CC
    tya
    pha
    jsr L7150
    pla
    tay
    bcc RTS_A1FD
    lda #$80
    sta $010F
    jsr LA21F
    jsr LA15D
LA1F3:
    lda $B5C6
    sta $68
    lda $B5C7
    sta $69
RTS_A1FD:
    rts



LA1FE:
    bcs RTS_A216
    lda #$E0
    sta $010F
    jsr LA225
    lda $0F
LA20A:
    beq LA20E
    lda #$01
LA20E:
    sta $6D
ClearHealthChange:
    lda #$00
    sta $68
    sta $69
RTS_A216:
    rts



LA217:
    bcs RTS_A216
    jsr LA166
    jmp LA1AC
LA21F:
    jsr LA22D
    jmp MAIN_Amul8
LA225:
    lda $10
    asl a
    asl a
    asl a
    jmp LA168
LA22D:
    lda $10
    eor #$03
    rts
LA232:
    ldx #$50
LA234:
    jsr LA23E
    ldx $45
    jsr LA0E1
    bne LA234
LA23E:
    stx $45
    ldy $B460,x
    beq LA24C
    cpy #$03
    bcs LA24C
    jsr LA26C
LA24C:
    jsr LA297
    lda $B460,x
    sta $7C
    cmp #$07
    bcs LA269
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word LA2AB
        .word LA2D3
        .word LA2FA
        .word LA32B
        .word LA370
        .word LA3DB
LA269:
    jmp LA905



LA26C:
    lda $0405,x
    and #$02
    bne LA294
    lda $0400,x
    sta $0A
    lda $0401,x
    sta $0B
    lda $B467,x
    sta $06
    lda $B461,x
    sta $08
    lda $B462,x
    sta $09
    jsr L8356
    txa
    bne LA294
    pla
    pla
LA294:
    ldx $45
    rts
LA297:
    lda $0405,x
    asl a
    rol a
    tay
    txa
LA29E:
    jsr MAIN_Adiv16
    eor FrameCount
    lsr a
    tya
    ror a
    ror a
    sta $0405,x
    rts



LA2AB:
    lda $0405,x
    asl a
    bmi LA2D0
    lda #$00
    sta $B46D,x
    sta $0406,x
    sta $040A,x
    jsr LA5A6
    jsr LA648
    jsr LA56F
    jsr LA563
    lda $0409,x
    beq LA2D0
    jsr LA6A7
LA2D0:
    jmp LA2F7



LA2D3:
    lda $0405,x
    asl a
    bmi LA2F7
    lda $0405,x
    and #$20
    beq LA2EE
    ldy $B46E,x
    lda $B6B3,y
    sta $0409,x
    dec $B460,x
    bne LA2F7
LA2EE:
    jsr LA5A6
    jsr LA648
    jsr LA40B
LA2F7:
    jsr LA423
LA2FA:
    jmp $B5DD
LA2FD:
    jsr L840B
    jsr LAD08
LA303:
    ldx $45
    lda $040F,x
    bpl LA312
    lda $65
    bmi LA312
    lda #$A3
LA310:
    sta $65
LA312:
    lda $B460,x
    beq LA31A
    jsr L8107
LA31A:
    ldx $45
    lda #$00
    sta $0404,x
    sta $040E,x
    rts
LA325:
    jsr L840B
    jmp LA303



LA32B:
    jsr LA423
    lda $B460,x
    cmp #$03
    beq LA2FD
    bit $65
    bmi LA33D
        lda #$A1
        sta $65
    LA33D:
    lda FrameCount
    and #$07
    bne LA35E
    dec $040D,x
    bne LA35E
    lda $B460,x
    cmp #$03
    beq LA35E
    lda $040C,x
    sta $B460,x
    ldy $B46E,x
    lda $B693,y
    sta $040D,x
LA35E:
    lda $040D,x
    cmp #$0B
    bcs LA36D
    lda FrameCount
    and #$02
    beq LA36D
    asl $65
LA36D:
    jmp LA303



LA370:
    lda $0404,x
    and #$24
    beq LA3C1
    jsr LA905
    ldy $B463,x
    cpy #$80
    beq LA3A4
    tya
    pha
    lda $B46E,x
    pha
    ldy #$00
    ldx #$03
    pla
    bne LA399
    dex
    pla
    cmp #$81
    bne LA398
    ldx #$00
    ldy #$50
LA398:
    pha
LA399:
    pla
    sty $68
    stx $69
    jsr L72AD
    jmp L6F7C
LA3A4:
    lda #$02
    ldy $B46E,x
    beq LA3AD
    lda #$1E
LA3AD:
    clc
    adc CurSamusStat.MissileCount
    bcs LA3B8
    cmp CurSamusStat.MaxMissiles
    bcc LA3BB
LA3B8:
    lda CurSamusStat.MaxMissiles
LA3BB:
    sta CurSamusStat.MissileCount
    jmp L6F80
LA3C1:
    lda FrameCount
    and #$03
    bne LA3CF
    dec $040D,x
    bne LA3CF
    jsr LA905
LA3CF:
    lda FrameCount
    and #$02
    lsr a
    ora #$A0
    sta $65
    jmp LA303



LA3DB:
    dec $040F,x
    bne LA3FD
    lda $040C,x
    tay
    and #$C0
    sta $040F,x
    tya
    and #$3F
    sta $B460,x
    pha
    jsr LAD60
    and #$20
    beq LA3FC
    pla
    jsr LA402
    pha
LA3FC:
    pla
LA3FD:
    lda #$A0
    jmp LA310
LA402:
    sta $040C,x
LA405:
    lda #$04
    sta $B460,x
    rts
LA40B:
    lda $43
    ldx $45
    cmp #$02
    bcc RTS_A458
    lda $0400,x
    cmp #$EC
    bcc RTS_A458
    jmp LA905
LA41D:
    jsr L6F92
    jmp LA560
LA423:
    lda $040F,x
    sta $0A
    lda $0404,x
    and #$20
    beq RTS_A458
    lda $040E,x
    cmp #$03
    bne LA466
    bit $0A
    bvs LA466
    lda $B460,x
    cmp #$04
    beq LA466
    jsr LA402
    lda #$40
    sta $040D,x
    jsr LAD60
    and #$20
    beq RTS_A458
    lda #$05
    sta $040B,x
    jmp $B5A0
RTS_A458:
    rts
LA459:
    jsr LAD60
    and #$20
    bne LA41D
    jsr L6F78
    jmp LA31A
LA466:
    lda $040B,x
    cmp #$FF
    beq LA459
    bit $0A
    bvc LA476
    jsr L6F96
    bne LA497
LA476:
    jsr LA638
    and #$0C
    beq LA48A
    cmp #$04
    beq LA48F
    cmp #$08
    beq LA494
    jsr L6F92
    bne LA497
LA48A:
    jsr L6F70
    bne LA497
LA48F:
    jsr L6F70
    bne LA497
LA494:
    jsr L6F8E
LA497:
    ldx $45
    jsr LAD60
    and #$20
    beq LA4A7
    lda $040E,x
    cmp #$0B
    bne LA459
LA4A7:
    lda $B460,x
    cmp #$04
    bne LA4B1
    lda $040C,x
LA4B1:
    ora $0A
    sta $040C,x
    asl a
    bmi LA4CB
    jsr LAD60
    and #$20
    bne LA4CB
    ldy $040E,x
    cpy #$0B
    beq LA4FE
    cpy #$81
    beq LA4FE
LA4CB:
    lda #$06
    sta $B460,x
    lda #$0A
    bit $0A
    bvc LA4D8
    lda #$03
LA4D8:
    sta $040F,x
    cpy #$02
    beq LA4F4
    bit $0A
    bvc LA4F9
    ldy $040E,x
    cpy #$0B
    bne LA4F9
    dec $040B,x
    beq LA4FE
    dec $040B,x
    beq LA4FE
LA4F4:
    dec $040B,x
    beq LA4FE
LA4F9:
    dec $040B,x
    bne LA560
LA4FE:
    lda #$03
    sta $B460,x
    bit $0A
    bvs LA515
    lda $040E,x
    cmp #$02
    bcs LA515
    lda #$00
    jsr L8078
    ldx $45
LA515:
    jsr LA731
    lda $B603,y
    jsr LA57A
    sta $0406,x
    ldx #$C0
LA523:
    lda $B460,x
    beq LA533
    txa
    clc
    adc #$08
    tax
    cmp #$E0
    bne LA523
    beq LA560
LA533:
    lda $B5D5
    jsr LA57A
    lda #$0A
    sta $0406,x
    inc $B460,x
    lda #$00
    bit $0A
    bvc LA549
    lda #$03
LA549:
    sta $0407,x
    ldy $45
    lda $0400,y
    sta $0400,x
    lda $0401,y
    sta $0401,x
    lda $B467,y
    sta $B467,x
LA560:
    ldx $45
    rts
LA563:
    jsr LAD60
    asl a
    asl a
    asl a
    and #$C0
    sta $B46F,x
    rts
LA56F:
    jsr LA731
    lda $B633,y
    cmp $B465,x
    beq RTS_A585
LA57A:
    sta $B465,x
LA57D:
    sta $B466,x
LA580:
    lda #$00
    sta $B464,x
RTS_A585:
    rts
LA586:
    jsr LA731
    lda $B653,y
    cmp $B465,x
    beq RTS_A5A5
    jsr LA57A
    ldy $B46E,x
    lda $B673,y
    and #$7F
    beq RTS_A5A5
    tay
LA59F:
    dec $B466,x
    dey
    bne LA59F
RTS_A5A5:
    rts
LA5A6:
    lda #$00
    sta $7D
    jsr LA638
    tay
    lda $B460,x
    cmp #$02
    bne LA5BA
    tya
    and #$02
    beq RTS_A5A5
LA5BA:
    tya
    dec $040D,x
    bne RTS_A5A5
    pha
    ldy $B46E,x
    lda $B693,y
    sta $040D,x
    pla
    bpl LA5FC
    lda #$FE
    jsr LA6A0
    lda $43
    cmp #$02
    bcc LA5E2
    jsr LA63F
    bcc LA5E2
    tya
    eor $FF
    bcs LA5ED
LA5E2:
    lda $0401,x
    cmp ObjX
    bne LA5EC
    inc $7D
LA5EC:
    rol a
LA5ED:
    and #$01
    jsr LA631
    lsr a
    ror a
    eor $0403,x
    bpl LA5FC
    jsr LAE8A
LA5FC:
    lda #$FB
    jsr LA6A0
    lda $43
    cmp #$02
    bcs LA611
    jsr LA63F
    bcc LA611
    tya
    eor $FF
    bcs LA61E
LA611:
    lda $0400,x
    cmp ObjY
    bne LA61D
    inc $7D
    inc $7D
LA61D:
    rol a
LA61E:
    and #$01
    asl a
    asl a
    jsr LA631
    lsr a
    lsr a
    lsr a
    ror a
    eor $0402,x
    bpl RTS_A637
    jmp LAEBF
LA631:
    ora $0405,x
    sta $0405,x
RTS_A637:
    rts
LA638:
    ldy $B46E,x
    lda $B683,y
    rts
LA63F:
    lda $B467,x
    tay
    eor ObjHi
    lsr a
    rts
LA648:
    lda #$E7
    sta $06
    lda #$18
    jsr LA631
    ldy $B46E,x
    lda $B6A3,y
    beq RTS_A6A6
    tay
    lda $0405,x
    and #$02
    beq LA69E
    tya
    ldy #$F7
    asl a
    bcs LA669
    ldy #$EF
LA669:
    lsr a
    sta $02
    sty $06
    lda ObjY
    sta $00
    ldy $0400,x
    lda $0405,x
    bmi LA683
    ldy ObjX
    sty $00
    ldy $0401,x
LA683:
    lda ObjHi
    lsr a
    ror $00
    lda $B467,x
    lsr a
    tya
    ror a
    sec
    sbc $00
    bpl LA697
    jsr MAIN_TwosComplement
LA697:
    lsr a
    lsr a
    lsr a
    cmp $02
    bcc RTS_A6A6
LA69E:
    lda $06
LA6A0:
    and $0405,x
    sta $0405,x
RTS_A6A6:
    rts
LA6A7:
    dec $0409,x
    bne RTS_A6B6
    lda $0405,x
    and #$08
    bne LA6B7
    inc $0409,x
RTS_A6B6:
    rts
LA6B7:
    lda $B46E,x
    cmp #$07
    bne LA6C3
    jsr L6F64
    ldx $45
LA6C3:
    inc $B460,x
    jsr LA586
    ldy $B46E,x
    lda $B6C3,y
    clc
    adc #$C9
    sta $00
    lda #$00
    adc #$B7
    sta $01
    lda FrameCount
    eor RandomNumber1
    ldy #$00
    and ($00),y
    tay
    iny
    lda ($00),y
    sta $0408,x
    jsr LAD60
    bpl LA726
    lda #$00
    sta $0406,x
    sta $0407,x
    ldy $0408,x
    lda $B723,y
    sta $B46A,x
    lda $B737,y
    sta $B46B,x
    lda $B74B,y
    sta $0402,x
    lda $B75F,y
    sta $0403,x
    lda $0405,x
    bmi LA71F
    lsr a
    bcc LA726
    jsr LAE81
    jmp LA726
LA71F:
    and #$04
    beq LA726
    jsr LAEB6
LA726:
    lda #$DF
    jmp LA6A0
LA72B:
    lda $0405,x
    jmp LA738
LA731:
    lda $0405,x
    bpl LA738
    lsr a
    lsr a
LA738:
    lsr a
    lda $B46E,x
    rol a
    tay
    rts
LA73F:
    txa
    lsr a
    lsr a
    lsr a
    adc FrameCount
    lsr a
    rts
LA747:
    ldy $B46E,x
    lda $B693,y
    sta $040D,x
    lda $B623,y
    ldy $040F,x
    bpl LA759
    asl a
LA759:
    sta $040B,x
RTS_A75C:
    rts
LA75D:
    lda $0405,x
    and #$10
    beq RTS_A75C
    lda $82
    and $B460,x
    beq RTS_A75C
    lda $82
    bpl LA774
    ldy $B46D,x
    bne RTS_A75C
LA774:
    jsr LA7D5
    bcs RTS_A7E4
    sta $0404,y
    jsr LA819
    lda $0405,x
    lsr a
    lda $80
    pha
    rol a
    tax
    lda $B783,x
    pha
    tya
    tax
    pla
    jsr LA57A
    ldx $45
    lda #$01
    sta $B460,y
    and $0405,x
    tax
    lda $A817,x
    sta $0403,y
    lda #$00
    sta $0402,y
    ldx $45
    jsr LA7E5
    lda $0405,x
    lsr a
    pla
    tax
    lda $B79B,x
    sta $04
    txa
    rol a
    tax
    lda $B793,x
    sta $05
    jsr LA80A
    ldx $45
    bit $82
    bvc RTS_A7E4
    lda $0405,x
    and #$01
    tay
    lda $007E,y
    jmp LA57D
LA7D5:
    ldy #$60
    clc
LA7D8:
    lda $B460,y
    beq RTS_A7E4
    jsr LA0DB
    cmp #$C0
    bne LA7D8
RTS_A7E4:
    rts
LA7E5:
    lda $80
    cmp #$02
    bcc RTS_A809
    ldx $45
    lda $0405,x
    lsr a
    lda $83
    rol a
    and #$07
    sta $040A,y
    lda #$02
    sta $B460,y
    lda #$00
    sta $0409,y
    sta $B464,y
    sta $0408,y
RTS_A809:
    rts
LA80A:
    ldx $45
    jsr L8AFD
    tya
    tax
    jsr LAC7C
    jmp LA936
    .byte $02, $FE
    
LA819:
    lda #$02
    sta $B461,y
    sta $B462,y
    ora $0405,y
    sta $0405,y
    rts
LA828:
    ldx #$B0
LA82A:
    jsr LA836
    ldx $45
    jsr LA0E1
    cmp #$60
    bne LA82A
LA836:
    stx $45
    lda $0405,x
    and #$02
    bne LA842
    jsr LA905
LA842:
    lda $B460,x
    beq RTS_A856
    jsr MAIN_ChooseRoutine
    .word RTS_D07F
    .word LA857
    .word LA87E
    .word RTS_D07F
    .word LA958
    .word LA97E
RTS_A856:
    rts



LA857:
    jsr LA948
    jsr LA90B
    ldx $45
    bcs LA869
    lda $B460,x
    beq RTS_A856
    jsr LA94D
LA869:
    lda #$01
LA86B:
    jsr L840B
    jmp L8107
LA871:
    inc $0408,x
LA874:
    inc $0408,x
    lda #$00
    sta $0409,x
    beq LA891
LA87E:
    jsr LA948
    lda $040A,x
    and #$FE
    tay
    lda $B79F,y
    sta $0A
    lda $B7A0,y
    sta $0B
LA891:
    ldy $0408,x
    lda ($0A),y
    cmp #$FF
    bne LA8A0
    sta $0408,x
    jmp LA874
LA8A0:
    cmp $0409,x
    beq LA871
    inc $0409,x
    iny
    lda ($0A),y
LA8AB:
    jsr LAF46
    ldx $45
    sta $0402,x
    lda ($0A),y
    jsr LAFDF
    ldx $45
    sta $0403,x
    tay
    lda $040A,x
    lsr a
    php
    bcc LA8CC
    tya
    jsr MAIN_TwosComplement
    sta $0403,x
LA8CC:
    plp
    bne LA8DF
    lda $0402,x
    beq LA8DF
    bmi LA8DF
    ldy $040A,x
    lda $B5D8,y
    sta $B465,x
LA8DF:
    jsr LA90B
    ldx $45
    bcs LA902
    lda $B460,x
    beq RTS_A957
    ldy #$00
    lda $040A,x
    lsr a
    beq LA8F4
    iny
LA8F4:
    lda $B5DA,y
    jsr LA57A
    jsr LA405
    lda #$0A
    sta $0409,x
LA902:
    jmp LA869



LA905:
    lda #$00
    sta $B460,x
    rts



LA90B:
    lda $6E
    cmp #$11
    bne LA917
    lda $B460,x
    lsr a
    bcc LA924
LA917:
    jsr LA96A
    ldy #$00
    lda ($04),y
    cmp #$A0
    bcc RTS_A947
    ldx $45
LA924:
    lda $0403,x
    sta $05
    lda $0402,x
    sta $04
LA92E:
    jsr L8AFD
    jsr LAC7C
    bcc LA905
LA936:
    lda $08
    sta $0400,x
    lda $09
    sta $0401,x
    lda $0B
    and #$01
    sta $B467,x
RTS_A947:
    rts



LA948:
    lda $0404,x
    beq RTS_A957
LA94D:
    lda #$00
    sta $0404,x
    lda #$05
    sta $B460,x
RTS_A957:
    rts



LA958:
    lda $B463,x
    cmp #$F7
    beq LA964
    dec $0409,x
    bne LA967
LA964:
    jsr LA905
LA967:
    jmp LA869
LA96A:
    ldx $45
    lda $0400,x
    sta $02
    lda $0401,x
    sta $03
    lda $B467,x
    sta $0B
    jmp L8CBF



LA97E:
    jsr LA905
    lda $B5D4
    jsr LA57A
    jmp LA869
LA98A:
    ldx #$C0
LA98C:
    stx $45
    lda $B460,x
    beq LA996
    jsr LA9A1
LA996:
    lda $45
    clc
    adc #$08
    tax
    cmp #$E0
    bne LA98C
RTS_A9A0:
    rts



LA9A1:
    dec $0406,x
    bne LA9B5
    lda #$0C
    sta $0406,x
    dec $0407,x
    bmi LA9B2
    bne LA9B5
LA9B2:
    jsr LA905
LA9B5:
    lda $0406,x
    cmp #$09
    bne LA9CE
    lda $0407,x
    asl a
    tay
    lda LA9D7,y
    sta $04
    lda LA9D7+1,y
    sta $05
    jsr LA92E
LA9CE:
    lda #$80
    sta $65
    lda #$03
    jmp LA86B

LA9D7:
    .byte $00, $00
    .byte $0C, $1C
    .byte $10, $F0
    .byte $F0, $08



LA9DF:
    ldy #$18
    LA9E1:
        jsr LA9EC
        lda $45
        sec
    LA9E7:
        sbc #$08
        tay
        bne LA9E1
LA9EC:
    sty $45
    ldx $0728,y
    inx
    beq RTS_A9A0
    ldx $0729,y
    lda $B460,x
    beq LAA03
    lda $0405,x
    and #$02
    bne RTS_AA74
LAA03:
    sta $0404,x
    lda #$FF
    cmp $B46E,x
    bne LAA5D
    dec $0409,x
    bne RTS_AA74
    lda $0728,y
    jsr L8E7D
    ldy $45
    lda $072A,y
    sta $0400,x
    lda $072B,y
    sta $0401,x
    lda $072C,y
    sta $B467,x
    lda #$18
    sta $B462,x
    lda #$0C
    sta $B461,x
    ldy #$00
    jsr LA073
    jsr LA03F
    jsr LA0AC
    jsr LA0E7
    bcc RTS_AA74
    lda #$01
    sta $0409,x
    sta $B460,x
    and $43
    asl a
    sta $0405,x
    ldy $B46E,x
    jsr LAA68
    jmp LA747
LAA5D:
    sta $B46E,x
    lda #$01
    sta $0409,x
    jmp LA905
LAA68:
    jsr LAD60
    ror $0405,x
    lda $B6B3,y
    sta $0409,x
RTS_AA74:
    rts
LAA75:
    ldx $45
    jsr LA731
    lda $B46D,x
    inc $B46F,x
    dec $B46F,x
    bne LAA87
    pha
    pla
LAA87:
    bpl LAA8C
    jsr MAIN_TwosComplement
LAA8C:
    cmp #$08
    bcc LAAAC
    cmp #$10
    bcs RTS_AA74
    tya
    and #$01
    tay
    lda $0080,y
    cmp $B465,x
    beq RTS_AA74
    sta $B466,x
    dec $B466,x
LAAA6:
    sta $B465,x
    jmp LA580
LAAAC:
    lda $B633,y
    cmp $B465,x
    beq RTS_AA74
    jmp LA57A
LAAB7:
    ldx $45
    jsr LA731
    lda $B653,y
    cmp $B465,x
    beq RTS_AA74
    sta $B465,x
    jmp LA57D
LAACA:
    lda #$40
    sta $45
    ldx #$0C
LAAD0:
    jsr LAAD9
    dex
    dex
    dex
    dex
    bne LAAD0
LAAD9:
    lda $A0,x
    beq RTS_AB44
    dec $A0,x
    txa
    lsr a
    tay
    lda $AB4A,y
    sta $04
    lda $AB4B,y
    sta $05
    lda $A1,x
    sta $08
    lda $A2,x
    sta $09
    lda $A3,x
    sta $0B
    jsr LAC7C
    bcc LAB45
    lda $08
    sta $A1,x
    sta PowerUpDrawY
    lda $09
    sta $A2,x
    sta PowerUpDrawX
    lda $0B
    and #$01
    sta $A3,x
    sta PowerUpDrawHi
    lda $A3,x
    sta PowerUpDrawHi
    lda #$5A
    sta PowerUpDrawAnimFrame
    txa
LAB1F:
    pha
    jsr L81C6
    lda $6A
    bne LAB42
    ldy #$00
    ldx #$40
    jsr L7FF5
    bcs LAB42
    jsr L7150
    ldy #$00
    bcc LAB42
    clc
    jsr LA1FE
    lda #$50
    sta $68
    jsr SubtractHealth
LAB42:
    pla
    tax
RTS_AB44:
    rts
LAB45:
    lda #$00
    sta $A0,x
    rts

LAB4A:
    .byte $00
    .byte $FB
    .byte $FB
    .byte $FE
    .byte $FB
    .byte $02
    .byte $00
    .byte $05

LAB52:
    lda $B550
    beq RTS_AB81
    ldx #$F0
    stx $45
    lda $B555
    cmp $B5DC
    bne LAB82
    lda #$03
    jsr L840B
    lda RandomNumber1
    sta $85
    lda #$18
LAB6E:
    pha
    tax
    jsr LAB85
    pla
    tax
    lda $B6,x
    and #$F8
    sta $B6,x
    txa
    sec
    sbc #$08
    bpl LAB6E
RTS_AB81:
    rts
LAB82:
    jmp LA905



LAB85:
    lda $B0,x
    jsr MAIN_ChooseRoutine
        .word RTS_D07F
        .word LAB92
        .word LAB9E
        .word LABA7



LAB92:
    jsr LAC71
    jsr LABF5
    jsr LAC12
    jmp L8107



LAB9E:
    jsr LAC71
    jsr LABAE
    jmp L8107



LABA7:
    lda #$00
    sta $B0,x
    jmp L6F70



LABAE:
    jsr LAC4C
    lda $B4,x
    cmp #$02
    bcs LABC2
    ldy $08
    cpy ObjY
    bcc LABC2
    ora #$02
    sta $B4,x
LABC2:
    ldy #$01
    lda $B4,x
    lsr a
    bcc LABCB
    ldy #$FF
LABCB:
    sty $05
    ldy #$04
    lsr a
    lda $B5,x
    bcc LABD6
    ldy #$FD
LABD6:
    sty $04
    inc $B5,x
    jsr LAC7C
    bcs LABE5
    lda $B4,x
    ora #$02
    sta $B4,x
LABE5:
    bcc LABEA
    jsr LAC59
LABEA:
    lda $B5,x
    cmp #$50
    bcc RTS_ABF4
    lda #$01
    sta $B0,x
RTS_ABF4:
    rts
LABF5:
    lda #$00
    sta $B5,x
    tay
    lda ObjX
    sec
    sbc $B2,x
    bpl LAC06
    iny
    jsr MAIN_TwosComplement
LAC06:
    cmp #$10
    bcs RTS_AC11
    tya
    sta $B4,x
    lda #$02
    sta $B0,x
RTS_AC11:
    rts
LAC12:
    txa
    lsr a
    lsr a
    lsr a
    adc $85
    sta $85
    lsr $85
    and #$03
    tay
    lda $AC47,y
    sta $04
    lda $AC48,y
    sta $05
    jsr LAC4C
    lda $08
    sec
    sbc $FC
    tay
    lda #$02
    cpy #$20
    bcc LAC3F
    jsr MAIN_TwosComplement
    cpy #$80
    bcc LAC41
LAC3F:
    sta $04
LAC41:
    jsr LAC7C
    jmp LAC59
    .byte $02
    inc $FF01,x
    .byte $02
LAC4C:
    lda $B3,x
    sta $0B
    lda $B1,x
    sta $08
    lda $B2,x
    sta $09
    rts
LAC59:
    lda $08
    sta $B1,x
    sta $04F0
    lda $09
    sta $B2,x
    sta $04F1
    lda $0B
    and #$01
    sta $B3,x
    sta $B557
    rts
LAC71:
    lda $B6,x
    and #$04
    beq RTS_AC7B
    lda #$03
    sta $B0,x
RTS_AC7B:
    rts
LAC7C:
    lda $43
    and #$02
    sta $02
    lda $04
    clc
    bmi LAC9E
    beq LACAC
    adc $08
    bcs LAC91
    cmp #$F0
    bcc LAC99
LAC91:
    adc #$0F
    ldy $02
    bne LACCE
    inc $0B
LAC99:
    sta $08
    jmp LACAC
LAC9E:
    adc $08
    bcs LACAA
    sbc #$0F
    ldy $02
    bne LACCE
    inc $0B
LACAA:
    sta $08
LACAC:
    lda $05
    clc
    bmi LACC0
    beq LACCC
    adc $09
    bcc LACBD
    ldy $02
    beq LACCE
    inc $0B
LACBD:
    jmp LACCA
LACC0:
    adc $09
    bcs LACCA
    ldy $02
    beq LACCE
    inc $0B
LACCA:
    sta $09
LACCC:
    sec
    rts
LACCE:
    clc
RTS_ACCF:
    rts
LACD0:
    lda EndTimer+1
    cmp #$99
    bne LACE6
    clc
    sbc EndTimer
    bne LACE6
    sta $06
    lda #$38
    sta $07
    jsr L7FCA
LACE6:
    ldx #$20
LACE8:
    jsr LACF2
    txa
    sec
    sbc #$08
    tax
    bne LACE8
LACF2:
    lda $0758,x
    sec
    sbc #$02
    bne RTS_ACCF
    sta $06
    inc $0758,x
    txa
    lsr a
    adc #$3C
    sta $07
    jmp L7FCA
LAD08:
    ldx $45
    lda $0405,x
    asl a
    bmi RTS_AD5F
    lda $B460,x
    cmp #$02
    bne RTS_AD5F
    jsr LAEF4
    lda $00
    bpl LAD2D
    jsr MAIN_TwosComplement
    sta $60
LAD23:
    jsr EnemyMoveOnePixelUp
    jsr LAD68
    dec $60
    bne LAD23
LAD2D:
    beq LAD3B
    sta $60
LAD31:
    jsr EnemyMoveOnePixelDown
    jsr LADAB
    dec $60
    bne LAD31
LAD3B:
    jsr LAFC8
    lda $00
    bpl LAD51
    jsr MAIN_TwosComplement
    sta $60
LAD47:
    jsr EnemyMoveOnePixelLeft
    jsr LAE1E
    dec $60
    bne LAD47
LAD51:
    beq RTS_AD5F
    sta $60
LAD55:
    jsr EnemyMoveOnePixelRight
    jsr LADE4
    dec $60
    bne LAD55
RTS_AD5F:
    rts
LAD60:
    ldy $B46E,x
    lda $B773,y
    asl a
    rts
LAD68:
    ldx $45
    bcs RTS_ADAA
    lda $0405,x
    bpl LAD77
LAD71:
    jsr LAEAC
    jmp LADA6
LAD77:
    jsr LAD60
    bpl LAD9A
    lda $B46F,x
    beq LAD71
    bpl LAD88
    jsr LAE61
    beq LAD92
LAD88:
    sec
    ror $0402,x
    ror $0406,x
    jmp LADA6
LAD92:
    sta $0402,x
    sta $0406,x
    beq LADA6
LAD9A:
    lda $B773,y
    lsr a
    lsr a
    bcc LADA6
    lda #$04
    jsr LB21B
LADA6:
    lda #$01
    sta $60
RTS_ADAA:
    rts
LADAB:
    ldx $45
    bcs RTS_ADE3
    lda $0405,x
    bpl LADBA
LADB4:
    jsr LAEAC
    jmp LADDF
LADBA:
    jsr LAD60
    bpl LADD3
    lda $B46F,x
    beq LADB4
    bpl LADD0
    clc
    ror $0402,x
    ror $0406,x
    jmp LADDF
LADD0:
    jsr LAE61
LADD3:
    lda $B773,y
    lsr a
    lsr a
    bcc LADDF
    lda #$04
    jsr LB21B
LADDF:
    lda #$01
    sta $60
RTS_ADE3:
    rts
LADE4:
    ldx $45
    bcs RTS_AE1D
    jsr LAD60
    bpl LAE0E
    lda $0405,x
    bmi LADF8
LADF2:
    jsr LAE77
    jmp LAE19
LADF8:
    lda $B46F,x
    beq LADF2
    bpl LAE09
    clc
    ror $0403,x
    ror $0407,x
    jmp LAE19
LAE09:
    jsr LAE70
    beq LAE19
LAE0E:
    lda $B773,y
    lsr a
    bcc LAE19
    lda #$01
    jsr LB21B
LAE19:
    lda #$01
    sta $60
RTS_AE1D:
    rts
LAE1E:
    ldx $45
    bcs RTS_AE60
    jsr LAD60
    bpl LAE50
    lda $0405,x
    bmi LAE32
LAE2C:
    jsr LAE77
    jmp LAE5C
LAE32:
    lda $B46F,x
    beq LAE2C
    bpl LAE3E
    jsr LAE70
    beq LAE48
LAE3E:
    sec
    ror $0403,x
    ror $0407,x
    jmp LAE5C
LAE48:
    sta $0403,x
    sta $0407,x
    beq LAE5C
LAE50:
    jsr LAD60
    lsr a
    lsr a
    bcc LAE5C
    lda #$01
    jsr LB21B
LAE5C:
    lda #$01
    sta $60
RTS_AE60:
    rts
LAE61:
    jsr LAE68
    sta $B46A,x
    rts
LAE68:
    lda #$20
    jsr LA631
    lda #$00
    rts
LAE70:
    jsr LAE68
    sta $B46B,x
    rts
LAE77:
    jsr LAEA6
    bne RTS_AEA5
    lda #$01
    jsr LB21B
LAE81:
    lda $B46B,x
    jsr MAIN_TwosComplement
    sta $B46B,x
LAE8A:
    jsr LAEA6
    bne RTS_AEA5
    jsr LAD60
    sec
    bpl LAE9D
    lda #$00
    sbc $0407,x
    sta $0407,x
LAE9D:
    lda #$00
    sbc $0403,x
    sta $0403,x
RTS_AEA5:
    rts
LAEA6:
    jsr LA638
    and #$20
    rts
LAEAC:
    jsr LAEA6
    bne RTS_AEA5
    lda #$04
    jsr LB21B
LAEB6:
    lda $B46A,x
    jsr MAIN_TwosComplement
    sta $B46A,x
LAEBF:
    jsr LAEA6
    bne RTS_AEDA
    jsr LAD60
    sec
    bpl LAED2
    lda #$00
    sbc $0406,x
    sta $0406,x
LAED2:
    lda #$00
    sbc $0402,x
    sta $0402,x
RTS_AEDA:
    rts
LAEDB:
    lda $0405,x
    bpl LAEE2
    lsr a
    lsr a
LAEE2:
    lsr a
    lda $0408,x
    rol a
    asl a
    tay
    lda $B6D3,y
    sta $7C
    lda $B6D4,y
    sta $7D
    rts
LAEF4:
    jsr LAD60
    bpl LAEFC
    jmp LAFEF
LAEFC:
    lda $0405,x
    and #$20
    eor #$20
    beq LAF52
    jsr LAEDB
LAF08:
    ldy $0406,x
LAF0B:
    lda ($7C),y
    cmp #$F0
    bcc LAF2F
    cmp #$FA
    beq LAF2C
    cmp #$FB
    beq LAF60
    cmp #$FC
    beq LAF63
    cmp #$FD
    beq LAF55
    cmp #$FE
    beq LAF8E
    lda #$00
    sta $0406,x
    beq LAF08
LAF2C:
    jmp LAFC2
LAF2F:
    sec
    sbc $0409,x
    bne LAF40
    sta $0409,x
    iny
    iny
    tya
    sta $0406,x
    bne LAF0B
LAF40:
    inc $0409,x
    iny
    lda ($7C),y
LAF46:
    asl a
    php
    jsr MAIN_Adiv32
    plp
    bcc LAF52
    eor #$FF
    adc #$00
LAF52:
    sta $00
    rts
LAF55:
    inc $0406,x
    iny
    lda #$00
    sta $B46D,x
    beq LAF0B
LAF60:
    pla
    pla
    rts
LAF63:
    lda $B46F,x
    bpl LAF6E
    jsr L8ADB
    jmp LAF73
LAF6E:
    beq LAF82
    jsr L8AE6
LAF73:
    ldx $45
    bcs LAF82
    ldy $0406,x
    iny
    lda #$00
    sta $B46F,x
    beq LAF87
LAF82:
    ldy $0406,x
    dey
    dey
LAF87:
    tya
    sta $0406,x
    jmp LAF0B
LAF8E:
    dey
    dey
    tya
    sta $0406,x
    lda $B46F,x
    bpl LAF9F
    jsr L8ADB
    jmp LAFA4
LAF9F:
    beq LAFAB
    jsr L8AE6
LAFA4:
    ldx $45
    bcc LAFAB
    jmp LAF08
LAFAB:
    ldy $B46E,x
    lda $B683,y
    and #$20
    beq LAFC2
    lda $0405,x
    eor #$05
    ora $B683,y
    and #$1F
    sta $0405,x
LAFC2:
    jsr LAE61
    jmp LAF52
LAFC8:
    jsr LAD60
    bpl LAFD0
    jmp LB045
LAFD0:
    lda $0405,x
    and #$20
    eor #$20
    beq LAFEC
    ldy $0406,x
    iny
    lda ($7C),y
LAFDF:
    tax
    and #$08
    php
    txa
    and #$07
    plp
    beq LAFEC
    jsr MAIN_TwosComplement
LAFEC:
    sta $00
    rts
LAFEF:
    ldy #$0E
    lda $B46A,x
    bmi LB00E
    clc
    adc $0406,x
    sta $0406,x
    lda $0402,x
    adc #$00
    sta $0402,x
    bpl LB026
LB007:
    jsr MAIN_TwosComplement
    ldy #$F2
    bne LB026
LB00E:
    jsr MAIN_TwosComplement
    sec
    sta $00
    lda $0406,x
    sbc $00
    sta $0406,x
    lda $0402,x
    sbc #$00
    sta $0402,x
    bmi LB007
LB026:
    cmp #$0E
    bcc LB033
    lda #$00
    sta $0406,x
    tya
    sta $0402,x
LB033:
    lda $B468,x
    clc
    adc $0406,x
    sta $B468,x
    lda #$00
    adc $0402,x
    sta $00
    rts
LB045:
    lda #$00
    sta $00
    sta $02
    lda #$0E
    sta $01
    sta $03
    lda $0407,x
    clc
    adc $B46B,x
    sta $0407,x
    sta $04
    lda #$00
    ldy $B46B,x
    bpl LB066
    lda #$FF
LB066:
    adc $0403,x
    sta $0403,x
    tay
    bpl LB080
    lda #$00
    sec
    sbc $0407,x
    sta $04
    lda #$00
    sbc $0403,x
    tay
    jsr NegateTemp00Temp01
LB080:
    lda $04
    cmp $02
    tya
    sbc $03
    bcc LB093
    lda $00
    sta $0407,x
    lda $01
    sta $0403,x
LB093:
    lda $B469,x
    clc
    adc $0407,x
    sta $B469,x
    lda #$00
    adc $0403,x
    sta $00
    rts



EnemyMoveOnePixelUp: ;($B0A5)
    ldx $45
    lda $0400,x
    sec
    sbc $B461,x
    and #$07
    sec
    bne LB0B6
    jsr L8ADB
LB0B6:
    ldy #$00
    sty $00
    ldx $45
    bcc RTS_B0FA
    inc $00
    ldy $0400,x
    bne LB0D9
    ldy #$F0
    lda $43
    cmp #$02
    bcs LB0D9
    lda $FC
    beq RTS_B0FA
    jsr LB213
    beq RTS_B0FA
    jsr LB20A
LB0D9:
    dey
    tya
    sta $0400,x
    cmp $B461,x
    bne LB0F1
    lda $FC
    beq LB0EC
    jsr LB213
    bne LB0F1
LB0EC:
    inc $0400,x
    clc
    rts
LB0F1:
    lda $0405,x
    bmi LB0F9
    inc $B46D,x
LB0F9:
    sec
RTS_B0FA:
    rts



EnemyMoveOnePixelDown: ;($B0FB)
    ldx $45
    lda $0400,x
    clc
    adc $B461,x
    and #$07
    sec
    bne LB10C
    jsr L8AE6
LB10C:
    ldy #$00
    sty $00
    ldx $45
    bcc RTS_B156
    inc $00
    ldy $0400,x
    cpy #$EF
    bne LB131
    ldy #$FF
    lda $43
    cmp #$02
    bcs LB131
    lda $FC
    beq RTS_B156
    jsr LB213
    bne RTS_B156
    jsr LB20A
LB131:
    iny
    tya
    sta $0400,x
    clc
    adc $B461,x
    cmp #$EF
    bne LB14D
    lda $FC
    beq LB147
    jsr LB213
    beq LB14D
LB147:
    dec $0400,x
    clc
    bcc RTS_B156
LB14D:
    lda $0405,x
    bmi LB155
    dec $B46D,x
LB155:
    sec
RTS_B156:
    rts



EnemyMoveOnePixelLeft: ;($B157)
    ldx $45
    lda $0401,x
    sec
    sbc $B462,x
    and #$07
    sec
    bne LB168
    jsr L8C46
LB168:
    ldy #$00
    sty $00
    ldx $45
    bcc RTS_B1AD
    inc $00
    ldy $0401,x
    bne LB18A
    lda $43
    cmp #$02
    bcc LB18A
    lda $FD
    beq LB184
    jsr LB213
LB184:
    clc
    beq RTS_B1AD
    jsr LB20A
LB18A:
    dec $0401,x
    lda $0401,x
    cmp $B462,x
    bne LB1A4
    lda $FD
    beq LB19E
    jsr LB213
    bne LB1A4
LB19E:
    inc $0401,x
    clc
    bcc RTS_B1AD
LB1A4:
    lda $0405,x
    bpl LB1AC
    inc $B46D,x
LB1AC:
    sec
RTS_B1AD:
    rts



EnemyMoveOnePixelRight: ;($B1AE)
    ldx $45
    lda $0401,x
    clc
    adc $B462,x
    and #$07
    sec
    bne LB1BF
    jsr L8C51
LB1BF:
    ldy #$00
    sty $00
    ldx $45
    bcc RTS_B209
    inc $00
    inc $0401,x
    bne LB1E6
    lda $43
    cmp #$02
    bcc LB1E6
    lda $FD
    beq LB1DD
    jsr LB213
    beq LB1E3
LB1DD:
    dec $0401,x
    clc
    bcc RTS_B209
LB1E3:
    jsr LB20A
LB1E6:
    lda $0401,x
    clc
    adc $B462,x
    cmp #$FF
    bne LB200
    lda $FD
    beq LB1FA
    jsr LB213
    beq LB200
LB1FA:
    dec $0401,x
    clc
    bcc RTS_B209
LB200:
    lda $0405,x
    bpl LB208
    dec $B46D,x
LB208:
    sec
RTS_B209:
    rts
LB20A:
    lda $B467,x
    eor #$01
    sta $B467,x
    rts
LB213:
    lda $B467,x
    eor $FF
    and #$01
    rts
LB21B:
    eor $0405,x
    sta $0405,x
    rts
LB222:
    ldx #<LB3FD.b
    ldy #>LB3FD.b
    lda #$1B
    jmp LB235



LB22B:
    pha
    lda #$20
    sta MAIN_DiskID@LB3C2
    lda #$00
    beq LB23D
LB235:
        pha
        lda #$20
        sta MAIN_DiskID@LB3C2
        lda #$01
    LB23D:
    sta MAIN_DiskID@LB3C4
    pla
    sta LB24D+1
    stx LB254
    sty LB254+1
LB24A:
    jsr LB2C3
LB24D:
    lda #$1F
    jsr FDSBIOS_WriteFile
        .word $B3BE
LB254:
        .word $B3EC
    beq LB25E
        jsr LB2CC
        jmp LB24A
    LB25E:
        jmp LB378



LB261:
    pha
    jsr LB32D
    ldx #<LB3E4.b
    ldy #>LB3E4.b
    jsr LB28A
    pla
    jsr $C46B
    pha
    jsr LB222
    pla
    ldy $1E
    cpy #$07
    bne LB27C
    rts
LB27C:
    sta $6E
    and #$0F
    asl a
    tay
    lda LB2AC,y
    tax
    lda LB2AC+1,y
    tay
LB28A:
    lda #$20
    sta MAIN_DiskID@LB3C2
    lda #$01
    
LB291:
    sta MAIN_DiskID@LB3C4
    stx LB2A2
    sty LB2A2+1
LB29A:
    jsr LB2C3
    jsr FDSBIOS_LoadFiles
        .word MAIN_DiskID
LB2A2:
        .word $0000
    beq LB2BF
    jsr LB2CC
    jmp LB29A

LB2AC:
    .word LB2AC_B3C8
    .word LB2AC_B3CD
    .word LB2AC_B3D6
    .word LB2AC_B3D2
    .word LB2AC_B3DD

LB2B6:
    lda #$20
    sta MAIN_DiskID@LB3C2
    lda #$00
    beq LB291
LB2BF:
    jsr LB378
    rts
LB2C3:
    jsr LB36E
    jsr L6F4E
    jmp GotoLD18C
LB2CC:
    pha
    jsr LB378
    pla
    pha
    lsr a
    lsr a
    lsr a
    sec
    ror a
    sta PPUString_B34F+7
    pla
    pha
    and #$0F
    ora #$80
    sta PPUString_B34F+8
    pla
    ldy $1E
    cpy #$03
    bne LB2ED
    jmp LB385
LB2ED:
    lda #$00
    sta $FC
    lda $FF
    and #$FC
    sta $FF
    jsr ClearScreenData
    ldx #<PPUString_B34F.b
    ldy #>PPUString_B34F.b
    jsr MAIN_PreparePPUProcess
    jsr LB346
    jsr $D068
LB307:
    jsr LB310
    jsr MAIN_EraseAllSprites
    jmp LB32D



LB310:
    lda DRIVESTATUS
    lsr a
    bcc LB310
    LB316:
        lda #$20
        pha
        LB319:
            jsr METHEX_WaitNMIPass_
            pla
            beq LB322
                tay
                dey
                tya
            LB322:
            pha
            lda DRIVESTATUS
            lsr a
            bcs LB319
        pla
        bne LB316
RTS_B32C:
    rts



LB32D:
    lda $1E
    cmp #$03
    beq RTS_B32C
    jsr ClearScreenData
    ldx #<PPUString_B359.b
    ldy #>PPUString_B359.b
    jsr MAIN_PreparePPUProcess
    jsr METHEX_WaitNMIPass_
    jsr LB346
    jmp $D068
LB346:
    lda $FF
    and #$EF
    ora #$08
    sta $FF
    rts

PPUString_B34F:
    PPUString $21F3, charmap_gameover, \
        "ERR ", $21, $21
    
    PPUStringEnd

PPUString_B359:
    PPUString $21CC, charmap_gameover, \
        "おまちください"
    
    PPUStringRepeat $23D0, undefined, $00, $20
    
    PPUStringEnd

LB368:
    jsr METHEX_WaitNMIPass_
    jmp FDSBIOS_DisPFObj



LB36E:
    lda $FF
    and #$7B
LB372:
    sta PPUCTRL
    sta $FF
    rts



LB378:
    lda PPUSTATUS
    and #$80
    bne LB378
    lda $FF
    ora #$80
    bne LB372
LB385:
    pha
    pha
    jsr MAIN_EraseAllSprites
    lda #$5E
    sta $03F3
    lda #$80
    sta $03FD
    lda #$C0
    sta $03FE
    lda ObjHi
    sta $03FC
    lda #$F0
    sta $45
    lda #$00
    sta $55
    jsr L81C6
    pla
    lsr a
    lsr a
    lsr a
    sec
    ror a
    sta $020D
    pla
    and #$0F
    ora #$80
    sta $0211
    jmp LB307

MAIN_DiskID: ;($B3BE)
    .byte $01
    .ascstr "MET"
@LB3C2:
    .ascstr " "
    .byte $02
@LB3C4:
    .byte $00
    .byte $00
    .byte $00
    .byte $00



LB2AC_B3C8:
    .byte $10, $81, $90, $91
    .byte $FF
LB2AC_B3CD:
    .byte $11, $90, $84, $91
    .byte $FF
LB2AC_B3D2:
    .byte $13, $92, $85
    .byte $FF
LB2AC_B3D6:
    .byte $12, $1F, $90, $92, $86, $91
    .byte $FF
LB2AC_B3DD:
    .byte $14, $1F, $92, $90, $87, $91
    .byte $FF



LB3E4:
    .byte $EF
    .byte $FF



LB3E6:
    .db $0E, $FF, $FF, $FF, $EE, $FF

LB3EC:
    .db $0E
    .db $01, $01, $01, $01, $01, $01, $01, $01
    .dw $C5A0
    .dw $0075
    .db $00 
    .dw $C5A0
    .db $00 

LB3FD:
    .db $EF
    .db $02, $02, $02, $02, $02, $02, $02, $02
    .dw $C000
    .dw $03F0
    .db $00
    .dw $C000
    .db $00

LB40E:
    .db $A2, $A3


